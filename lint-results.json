[{"filePath":"/home/evans/Projects/NRDC/app/[locale]/about/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/blog/[slug]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/blog/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/contact/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/donate/bank-transfer/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/donate/cancel/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":4,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport Link from 'next/link'\nimport { XCircle, Home, Heart, ArrowLeft } from 'lucide-react'\n\nexport default function DonateCancelPage() {\n    return (\n        <div className=\"min-h-screen bg-gray-50 py-16\">\n            <div className=\"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8\">\n                <div className=\"bg-white rounded-2xl shadow-xl p-8 md:p-12\">\n                    {/* Cancel Icon */}\n                    <div className=\"flex justify-center mb-6\">\n                        <div className=\"bg-orange-100 p-4 rounded-full\">\n                            <XCircle className=\"w-16 h-16 text-orange-600\" />\n                        </div>\n                    </div>\n\n                    {/* Message */}\n                    <h1 className=\"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-4\">\n                        Donation Cancelled\n                    </h1>\n                    <p className=\"text-lg text-gray-600 text-center mb-8\">\n                        Your donation was not completed. No charges have been made to your account.\n                    </p>\n\n                    {/* Info Box */}\n                    <div className=\"bg-[#6E8C82]/10 border border-[#6E8C82]/30 rounded-xl p-6 mb-8\">\n                        <h3 className=\"font-semibold text-gray-900 mb-2\">Why might donations fail?</h3>\n                        <ul className=\"space-y-2 text-sm text-gray-600\">\n                            <li>â€¢ Payment was cancelled by you</li>\n                            <li>â€¢ Technical issues during payment processing</li>\n                            <li>â€¢ Payment method declined</li>\n                        </ul>\n                    </div>\n\n                    {/* Action Buttons */}\n                    <div className=\"flex flex-col sm:flex-row gap-4 mb-8\">\n                        <Link\n                            href=\"/donate\"\n                            className=\"flex-1 bg-[#2E8B57] hover:bg-green-700 text-white px-6 py-3 rounded-lg font-semibold text-center transition-colors flex items-center justify-center gap-2\"\n                        >\n                            <Heart size={20} />\n                            Try Again\n                        </Link>\n                        <Link\n                            href=\"/\"\n                            className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-900 px-6 py-3 rounded-lg font-semibold text-center transition-colors flex items-center justify-center gap-2\"\n                        >\n                            <Home size={20} />\n                            Return Home\n                        </Link>\n                    </div>\n\n                    {/* Help Section */}\n                    <div className=\"text-center pt-8 border-t border-gray-200\">\n                        <p className=\"text-gray-600 mb-4\">Need help or have questions?</p>\n                        <Link\n                            href=\"/contact\"\n                            className=\"text-[#6E8C82] hover:underline font-medium\"\n                        >\n                            Contact our support team\n                        </Link>\n                    </div>\n                </div>\n\n                {/* Alternative Ways to Help */}\n                <div className=\"mt-8 bg-white rounded-2xl shadow-lg p-6\">\n                    <h3 className=\"text-lg font-bold text-gray-900 mb-4 text-center\">Other Ways to Help</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <Link\n                            href=\"/get-involved\"\n                            className=\"p-4 border border-gray-200 rounded-lg hover:border-[#6E8C82] hover:bg-[#6E8C82]/10 transition-all text-center\"\n                        >\n                            <h4 className=\"font-semibold text-gray-900 mb-1\">Volunteer</h4>\n                            <p className=\"text-sm text-gray-600\">Share your time and skills</p>\n                        </Link>\n                        <Link\n                            href=\"/contact\"\n                            className=\"p-4 border border-gray-200 rounded-lg hover:border-[#6E8C82] hover:bg-[#6E8C82]/10 transition-all text-center\"\n                        >\n                            <h4 className=\"font-semibold text-gray-900 mb-1\">Partner With Us</h4>\n                            <p className=\"text-sm text-gray-600\">Corporate partnerships</p>\n                        </Link>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/donate/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Repeat' is defined but never used.","line":3,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isRecurring' is assigned a value but never used.","line":29,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setIsRecurring' is assigned a value but never used.","line":29,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'frequency' is assigned a value but never used.","line":30,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setFrequency' is assigned a value but never used.","line":30,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":35},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1071,1074],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1071,1074],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { Heart, CreditCard, Building, Repeat, Gift, CheckCircle } from 'lucide-react'\nimport Link from 'next/link'\nimport { useParams } from 'next/navigation'\nimport { useEffect, useState } from 'react'\n\ninterface DonationTier {\n    id: string\n    amount: number\n    description: string\n    isPopular: boolean\n    order: number\n}\n\ninterface DonationStat {\n    id: string\n    value: string\n    label: string\n    order: number\n}\n\nexport default function DonatePage() {\n    const [tiers, setTiers] = useState<DonationTier[]>([])\n    const [stats, setStats] = useState<DonationStat[]>([])\n    const [loading, setLoading] = useState(true)\n    const [customAmount, setCustomAmount] = useState('')\n    const [processingAmount, setProcessingAmount] = useState<number | null>(null)\n    const [isRecurring, setIsRecurring] = useState(false)\n    const [frequency, setFrequency] = useState<'monthly' | 'yearly'>('monthly')\n    const [paymentMethod, setPaymentMethod] = useState<'mchanga' | 'bank_transfer'>('mchanga')\n    const [bankDetails, setBankDetails] = useState<any>(null)\n    const [showBankDetails, setShowBankDetails] = useState(false)\n\n    const params = useParams()\n    const locale = params.locale as string\n\n    useEffect(() => {\n        async function fetchData() {\n            try {\n                const localeQuery = locale ? `?locale=${locale}` : ''\n                const [tiersRes, statsRes, bankRes] = await Promise.all([\n                    fetch(`/api/donations/tiers${localeQuery}`),\n                    fetch(`/api/donations/stats${localeQuery}`),\n                    fetch('/api/settings/bank')\n                ])\n\n                if (tiersRes.ok) setTiers(await tiersRes.json())\n                if (statsRes.ok) setStats(await statsRes.json())\n                if (bankRes.ok) {\n                    const data = await bankRes.json()\n                    setBankDetails(data)\n                }\n            } catch (error) {\n                console.error('Error fetching donation data:', error)\n            } finally {\n                setLoading(false)\n            }\n        }\n        fetchData()\n    }, [locale])\n\n    async function handleDonate(amount: number, tierId?: string) {\n        if (processingAmount) return // Prevent double clicks\n\n        setProcessingAmount(amount)\n\n        try {\n            // Check payment method\n            if (paymentMethod === 'bank_transfer') {\n                // Bank transfer donation\n                const donorEmail = prompt('Please enter your email:') || ''\n                const donorName = prompt('Please enter your name (optional):') || null\n                const donorPhone = prompt('Please enter your phone number (optional):') || null\n\n                if (!donorEmail) {\n                    alert('Email is required for bank transfer donations')\n                    setProcessingAmount(null)\n                    return\n                }\n\n                const res = await fetch('/api/payments/bank-transfer', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        amount,\n                        donorEmail,\n                        donorName,\n                        donorPhone\n                    }),\n                })\n\n                if (!res.ok) {\n                    throw new Error('Failed to create bank transfer donation')\n                }\n\n                const { reference } = await res.json()\n\n                // Redirect to bank transfer instructions page\n                window.location.href = `/donate/bank-transfer?reference=${reference}`\n            } else {\n                // M-Changa payment (existing logic)\n                const res = await fetch('/api/payments/mchanga/checkout', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        amount,\n                        donorEmail: prompt('Please enter your email to proceed:') || '',\n                        donorName: prompt('Please enter your name (optional):') || null,\n                        donorPhone: prompt('Please enter your phone number (for payment):') || null,\n                        tierId: tierId || null,\n                    }),\n                })\n\n                if (!res.ok) {\n                    throw new Error('Failed to create payment link')\n                }\n\n                const { link } = await res.json()\n\n                // Redirect to M-Changa payment page\n                window.location.href = link\n            }\n        } catch (error) {\n            console.error('Payment error:', error)\n            alert('Failed to process payment. Please try again.')\n            setProcessingAmount(null)\n        }\n    }\n\n    function handleCustomDonate() {\n        const amount = parseFloat(customAmount)\n        if (isNaN(amount) || amount < 1) {\n            alert('Please enter a valid amount')\n            return\n        }\n        handleDonate(amount)\n    }\n\n    return (\n        <div className=\"pb-16\">\n            {/* Hero Section */}\n            <section className=\"bg-gradient-to-br from-[#6E8C82] to-[#2E8B57] text-white py-20\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center\">\n                    <Heart className=\"mx-auto mb-6 w-16 h-16 text-white/80\" />\n                    <h1 className=\"text-4xl md:text-5xl font-bold mb-6\">Make a Difference Today</h1>\n                    <p className=\"text-xl max-w-3xl mx-auto text-white/90\">\n                        Your donation helps provide nutrition, healthcare, and hope to refugee and displaced communities around the world.\n                    </p>\n                </div>\n            </section>\n\n            {/* Donation Options */}\n            <section className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16\">\n                <h2 className=\"text-3xl font-bold text-gray-900 text-center mb-4\">Choose Your Impact</h2>\n                <p className=\"text-gray-600 text-center mb-8 max-w-2xl mx-auto\">\n                    Every contribution, no matter the size, makes a real difference in someone&apos;s life.\n                </p>\n\n                {/* Payment Method Selector */}\n                <div className=\"max-w-3xl mx-auto mb-12\">\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-4 text-center\">Choose Payment Method</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <button\n                            onClick={() => {\n                                setPaymentMethod('mchanga')\n                                setShowBankDetails(false)\n                            }}\n                            className={`p-6 rounded-xl border-2 transition-all ${paymentMethod === 'mchanga'\n                                ? 'border-[#2E8B57] bg-green-50'\n                                : 'border-gray-200 hover:border-gray-300'\n                                }`}\n                        >\n                            <CreditCard className={`mx-auto mb-3 w-10 h-10 ${paymentMethod === 'mchanga' ? 'text-[#2E8B57]' : 'text-gray-400'}`} />\n                            <h4 className=\"font-bold text-lg mb-2\">M-PESA / Mobile Money</h4>\n                            <p className=\"text-sm text-gray-600\">Pay instantly via M-PESA, Airtel Money, or card</p>\n                        </button>\n\n                        <button\n                            onClick={() => {\n                                setPaymentMethod('bank_transfer')\n                                setShowBankDetails(true)\n                            }}\n                            className={`p-6 rounded-xl border-2 transition-all ${paymentMethod === 'bank_transfer'\n                                ? 'border-[#2E8B57] bg-green-50'\n                                : 'border-gray-200 hover:border-gray-300'\n                                }`}\n                        >\n                            <Building className={`mx-auto mb-3 w-10 h-10 ${paymentMethod === 'bank_transfer' ? 'text-[#2E8B57]' : 'text-gray-400'}`} />\n                            <h4 className=\"font-bold text-lg mb-2\">Bank Transfer</h4>\n                            <p className=\"text-sm text-gray-600\">Direct bank deposit for larger donations</p>\n                        </button>\n                    </div>\n\n                    {/* Bank Details Display */}\n                    {showBankDetails && bankDetails && (\n                        <div className=\"mt-6 bg-blue-50 border border-blue-200 rounded-xl p-6\">\n                            <h4 className=\"font-bold text-lg mb-4 flex items-center gap-2\">\n                                <Building className=\"w-5 h-5 text-blue-600\" />\n                                Bank Account Details\n                            </h4>\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n                                <div>\n                                    <p className=\"text-gray-600\">Account Name:</p>\n                                    <p className=\"font-semibold\">{bankDetails.accountName}</p>\n                                </div>\n                                <div>\n                                    <p className=\"text-gray-600\">Account Number:</p>\n                                    <p className=\"font-semibold\">{bankDetails.accountNumber}</p>\n                                </div>\n                                {bankDetails.bankName && (\n                                    <div>\n                                        <p className=\"text-gray-600\">Bank:</p>\n                                        <p className=\"font-semibold\">{bankDetails.bankName}</p>\n                                    </div>\n                                )}\n                                <div>\n                                    <p className=\"text-gray-600\">Branch:</p>\n                                    <p className=\"font-semibold\">{bankDetails.branch}</p>\n                                </div>\n                                {bankDetails.swiftCode && (\n                                    <div>\n                                        <p className=\"text-gray-600\">Swift Code:</p>\n                                        <p className=\"font-semibold\">{bankDetails.swiftCode}</p>\n                                    </div>\n                                )}\n                            </div>\n                            <p className=\"text-sm text-gray-600 mt-4\">\n                                ðŸ’¡ After donating through bank transfer, you&apos;ll receive instructions to email proof of payment for verification.\n                            </p>\n                        </div>\n                    )}\n                </div>\n\n                {/* Recurring Donation Toggle Removed as it was Paystack-dependent */}\n\n                {loading ? (\n                    <div className=\"text-center py-12\">\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#6E8C82] mx-auto\"></div>\n                    </div>\n                ) : tiers.length > 0 ? (\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12\">\n                        {tiers.map((option) => (\n                            <div\n                                key={option.id}\n                                className={`relative bg-white rounded-2xl shadow-lg border-2 p-6 transition-all hover:shadow-xl hover:scale-105 ${option.isPopular ? 'border-[#2E8B57]' : 'border-gray-100'\n                                    }`}\n                            >\n                                {option.isPopular && (\n                                    <div className=\"absolute -top-3 left-1/2 -translate-x-1/2 bg-[#2E8B57] text-white px-4 py-1 rounded-full text-sm font-semibold\">\n                                        Most Popular\n                                    </div>\n                                )}\n                                <div className=\"text-center\">\n                                    <div className=\"text-4xl font-bold text-[#6E8C82] mb-2\">\n                                        KES {option.amount}\n                                    </div>\n                                    <p className=\"text-gray-600 text-sm mb-4\">\n                                        {option.description}\n                                    </p>\n                                    <button\n                                        onClick={() => handleDonate(option.amount, option.id)}\n                                        disabled={processingAmount !== null}\n                                        className={`w-full bg-[#6E8C82] hover:bg-[#587068] text-white py-3 rounded-lg font-semibold transition-colors ${processingAmount === option.amount ? 'opacity-50 cursor-not-allowed' : ''\n                                            }`}\n                                    >\n                                        {processingAmount === option.amount ? (\n                                            <span className=\"flex items-center justify-center gap-2\">\n                                                <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">\n                                                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\n                                                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                                                </svg>\n                                                Processing...\n                                            </span>\n                                        ) : (\n                                            `Donate KES ${option.amount}`\n                                        )}\n                                    </button>\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                ) : (\n                    <div className=\"text-center py-12 text-gray-500\">\n                        <p>No donation tiers available at the moment.</p>\n                    </div>\n                )}\n\n                {/* Custom Amount */}\n                <div className=\"bg-gray-50 rounded-2xl p-8 max-w-2xl mx-auto\">\n                    <h3 className=\"text-xl font-bold text-gray-900 mb-4 text-center\">Custom Amount</h3>\n                    <div className=\"flex gap-4\">\n                        <div className=\"flex-1\">\n                            <div className=\"relative\">\n                                <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-xl\">KES</span>\n                                <input\n                                    type=\"number\"\n                                    placeholder=\"Enter amount\"\n                                    className=\"w-full pl-16 pr-4 py-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none text-xl\"\n                                    min=\"1\"\n                                    value={customAmount}\n                                    onChange={(e) => setCustomAmount(e.target.value)}\n                                />\n                            </div>\n                        </div>\n                        <button\n                            onClick={handleCustomDonate}\n                            disabled={processingAmount !== null}\n                            className={`bg-[#2E8B57] hover:bg-green-700 text-white px-8 py-4 rounded-lg font-semibold transition-colors whitespace-nowrap ${processingAmount !== null ? 'opacity-50 cursor-not-allowed' : ''\n                                }`}\n                        >\n                            {processingAmount && parseFloat(customAmount) === processingAmount ? (\n                                <span className=\"flex items-center gap-2\">\n                                    <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">\n                                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\n                                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                                    </svg>\n                                    Processing...\n                                </span>\n                            ) : (\n                                'Donate Now'\n                            )}\n                        </button>\n                    </div>\n                </div>\n            </section>\n\n            {/* Payment Methods */}\n            <section className=\"bg-gray-50 py-16\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                    <h2 className=\"text-2xl font-bold text-gray-900 text-center mb-8\">Ways to Give</h2>\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                        <div className=\"bg-white p-6 rounded-xl shadow-sm text-center\">\n                            <CreditCard className=\"mx-auto mb-4 w-12 h-12 text-[#6E8C82]\" />\n                            <h3 className=\"font-bold text-lg mb-2\">Credit/Debit Card</h3>\n                            <p className=\"text-gray-600 text-sm\">Secure online payment via M-PESA and Mobile Money</p>\n                        </div>\n                        <div className=\"bg-white p-6 rounded-xl shadow-sm text-center\">\n                            <Building className=\"mx-auto mb-4 w-12 h-12 text-[#6E8C82]\" />\n                            <h3 className=\"font-bold text-lg mb-2\">Bank Transfer</h3>\n                            <p className=\"text-gray-600 text-sm\">Direct bank transfer for larger donations</p>\n                        </div>\n                        <div className=\"bg-white p-6 rounded-xl shadow-sm text-center\">\n                            <Gift className=\"mx-auto mb-4 w-12 h-12 text-[#6E8C82]\" />\n                            <h3 className=\"font-bold text-lg mb-2\">Support Our Programs</h3>\n                            <p className=\"text-gray-600 text-sm\">Your contribution directly funds our primary initiatives</p>\n                        </div>\n                    </div>\n                </div>\n            </section>\n\n            {/* Impact Stats */}\n            <section className=\"py-16\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                    <h2 className=\"text-2xl font-bold text-gray-900 text-center mb-8\">Your Donation at Work</h2>\n                    {loading ? (\n                        <div className=\"text-center py-8\">\n                            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[#6E8C82] mx-auto\"></div>\n                        </div>\n                    ) : stats.length > 0 ? (\n                        <div className={`grid grid-cols-2 md:grid-cols-${Math.min(stats.length, 4)} gap-8 text-center`}>\n                            {stats.map((stat) => (\n                                <div key={stat.id}>\n                                    <div className=\"text-4xl font-bold text-[#2E8B57] mb-2\">{stat.value}</div>\n                                    <p className=\"text-gray-600\">{stat.label}</p>\n                                </div>\n                            ))}\n                        </div>\n                    ) : (\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8 text-center\">\n                            <div>\n                                <div className=\"text-4xl font-bold text-[#2E8B57] mb-2\">95%</div>\n                                <p className=\"text-gray-600\">Goes directly to programs</p>\n                            </div>\n                            <div>\n                                <div className=\"text-4xl font-bold text-[#2E8B57] mb-2\">50K+</div>\n                                <p className=\"text-gray-600\">People helped annually</p>\n                            </div>\n                            <div>\n                                <div className=\"text-4xl font-bold text-[#2E8B57] mb-2\">12</div>\n                                <p className=\"text-gray-600\">Countries reached</p>\n                            </div>\n                            <div>\n                                <div className=\"text-4xl font-bold text-[#2E8B57] mb-2\">100%</div>\n                                <p className=\"text-gray-600\">Transparency guaranteed</p>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </section>\n\n            {/* Trust Badges */}\n            <section className=\"bg-[#6E8C82] text-white py-12\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                    <div className=\"flex flex-wrap justify-center gap-8 items-center\">\n                        <div className=\"flex items-center gap-2\">\n                            <CheckCircle size={24} />\n                            <span>Tax Deductible</span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                            <CheckCircle size={24} />\n                            <span>Secure Payment</span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                            <CheckCircle size={24} />\n                            <span>Certified Non-Profit</span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                            <CheckCircle size={24} />\n                            <span>Instant Receipt</span>\n                        </div>\n                    </div>\n                </div>\n            </section>\n\n            {/* Other Ways */}\n            <section className=\"py-16\">\n                <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center\">\n                    <Gift className=\"mx-auto mb-4 w-12 h-12 text-[#2E8B57]\" />\n                    <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Other Ways to Help</h2>\n                    <p className=\"text-gray-600 mb-8\">\n                        Can&apos;t donate right now? There are other meaningful ways to support our mission.\n                    </p>\n                    <div className=\"flex flex-wrap justify-center gap-4\">\n                        <Link\n                            href=\"/get-involved\"\n                            className=\"bg-gray-100 hover:bg-gray-200 text-gray-900 px-6 py-3 rounded-lg font-semibold transition-colors\"\n                        >\n                            Volunteer Your Time\n                        </Link>\n                        <Link\n                            href=\"/contact\"\n                            className=\"bg-gray-100 hover:bg-gray-200 text-gray-900 px-6 py-3 rounded-lg font-semibold transition-colors\"\n                        >\n                            Become a Partner\n                        </Link>\n                    </div>\n                </div>\n            </section>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/donate/success/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":6,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'donation' is assigned a value but never used.","line":12,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setDonation' is assigned a value but never used.","line":12,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[443,446],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[443,446],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/home/evans/Projects/NRDC/app/[locale]/donate/success/page.tsx:22:13\n  20 |             }, 1000)\n  21 |         } else {\n> 22 |             setLoading(false)\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  23 |         }\n  24 |     }, [sessionId])\n  25 |","line":22,"column":13,"nodeType":null,"endLine":22,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useSearchParams } from 'next/navigation'\nimport Link from 'next/link'\nimport { CheckCircle, Download, Share2, Heart } from 'lucide-react'\n\nexport default function DonateSuccessPage() {\n    const searchParams = useSearchParams()\n    const sessionId = searchParams?.get('session_id')\n    const [loading, setLoading] = useState(true)\n    const [donation, setDonation] = useState<any>(null)\n\n    useEffect(() => {\n        if (sessionId) {\n            // In a real implementation, you might want to fetch donation details\n            // For now, we'll just simulate it\n            setTimeout(() => {\n                setLoading(false)\n            }, 1000)\n        } else {\n            setLoading(false)\n        }\n    }, [sessionId])\n\n    if (loading) {\n        return (\n            <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#2E8B57]\"></div>\n            </div>\n        )\n    }\n\n    return (\n        <div className=\"min-h-screen bg-gray-50 py-16\">\n            <div className=\"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8\">\n                <div className=\"bg-white rounded-2xl shadow-xl p-8 md:p-12\">\n                    {/* Success Icon */}\n                    <div className=\"flex justify-center mb-6\">\n                        <div className=\"bg-green-100 p-4 rounded-full\">\n                            <CheckCircle className=\"w-16 h-16 text-green-600\" />\n                        </div>\n                    </div>\n\n                    {/* Thank You Message */}\n                    <h1 className=\"text-3xl md:text-4xl font-bold text-gray-900 text-center mb-4\">\n                        Thank You for Your Generosity!\n                    </h1>\n                    <p className=\"text-lg text-gray-600 text-center mb-8\">\n                        Your donation will help provide nutrition, healthcare, and hope to refugee and displaced communities around the world.\n                    </p>\n\n                    {/* Donation Details */}\n                    <div className=\"bg-gray-50 rounded-xl p-6 mb-8\">\n                        <div className=\"flex justify-between items-center mb-4\">\n                            <span className=\"text-gray-600\">Donation Amount:</span>\n                            <span className=\"text-2xl font-bold text-[#2E8B57]\">Processing...</span>\n                        </div>\n                        {sessionId && (\n                            <div className=\"flex justify-between items-center text-sm\">\n                                <span className=\"text-gray-500\">Transaction ID:</span>\n                                <span className=\"text-gray-700 font-mono text-xs\">{sessionId.substring(0, 20)}...</span>\n                            </div>\n                        )}\n                    </div>\n\n                    {/* What Happens Next */}\n                    <div className=\"mb-8\">\n                        <h2 className=\"text-xl font-bold text-gray-900 mb-4\">What Happens Next?</h2>\n                        <ul className=\"space-y-3\">\n                            <li className=\"flex items-start gap-3\">\n                                <CheckCircle className=\"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5\" />\n                                <span className=\"text-gray-600\">You&apos;ll receive an email confirmation with your donation receipt</span>\n                            </li>\n                            <li className=\"flex items-start gap-3\">\n                                <CheckCircle className=\"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5\" />\n                                <span className=\"text-gray-600\">Your contribution will be put to work immediately helping those in need</span>\n                            </li>\n                            <li className=\"flex items-start gap-3\">\n                                <CheckCircle className=\"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5\" />\n                                <span className=\"text-gray-600\">You&apos;ll receive updates on the impact your donation is making</span>\n                            </li>\n                        </ul>\n                    </div>\n\n                    {/* Action Buttons */}\n                    <div className=\"flex flex-col sm:flex-row gap-4\">\n                        <Link\n                            href=\"/\"\n                            className=\"flex-1 bg-[#6E8C82] hover:bg-[#587068] text-white px-6 py-3 rounded-lg font-semibold text-center transition-colors\"\n                        >\n                            Return Home\n                        </Link>\n                        <Link\n                            href=\"/donate\"\n                            className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-900 px-6 py-3 rounded-lg font-semibold text-center transition-colors flex items-center justify-center gap-2\"\n                        >\n                            <Heart size={20} />\n                            Donate Again\n                        </Link>\n                    </div>\n\n                    {/* Social Sharing */}\n                    <div className=\"mt-8 pt-8 border-t border-gray-200 text-center\">\n                        <p className=\"text-gray-600 mb-4\">Help us reach more people</p>\n                        <div className=\"flex justify-center gap-4\">\n                            <button className=\"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors\">\n                                <Share2 size={20} />\n                                Share\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Impact Message */}\n                <div className=\"mt-8 bg-gradient-to-r from-[#6E8C82] to-[#2E8B57] rounded-2xl p-6 text-white text-center\">\n                    <h3 className=\"text-xl font-bold mb-2\">Every Dollar Counts</h3>\n                    <p className=\"text-white/90\">\n                        95% of all donations go directly to our programs helping refugees and displaced communities.\n                    </p>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/donate/verify/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/gallery/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/get-involved/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":6,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":61},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'HeartIcon' is defined but never used.","line":6,"column":72,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":81},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Utensils' is defined but never used.","line":6,"column":83,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":91},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Activity' is defined but never used.","line":6,"column":93,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":101},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BarChart3' is defined but never used.","line":6,"column":116,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":125},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Smile' is defined but never used.","line":6,"column":127,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":132},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":6,"column":134,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":139},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":124,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4028,4031],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4028,4031],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect, useCallback } from 'react'\nimport { useParams } from 'next/navigation'\nimport Link from 'next/link'\nimport { Heart, ChevronLeft, ChevronRight, ArrowRight, Users, Heart as HeartIcon, Utensils, Activity, Quote, Star, BarChart3, Smile, Award } from 'lucide-react'\nimport TestimonialForm from '@/components/TestimonialForm'\nimport AdSlot from '@/components/AdSlot'\nimport { useTranslations } from 'next-intl'\nimport * as Icons from 'lucide-react'\n\ninterface Statistic {\n  id: string\n  label: string\n  value: string\n  icon: string\n}\n\ninterface Testimonial {\n  id: string\n  name: string\n  role: string | null\n  message: string\n  rating: number | null\n}\n\ninterface SiteContent {\n  hero_title?: string\n  hero_subtitle?: string\n  mission_statement?: string\n}\n\nexport default function Home() {\n  const t = useTranslations();\n  const [statistics, setStatistics] = useState<Statistic[]>([])\n  const [testimonials, setTestimonials] = useState<Testimonial[]>([])\n  const [content, setContent] = useState<SiteContent>({})\n  const [currentSlide, setCurrentSlide] = useState(0)\n  const [isPaused, setIsPaused] = useState(false)\n\n  const heroImages = [\n    'https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?q=80&w=2070&auto=format&fit=crop',\n    'https://images.unsplash.com/photo-1593113598332-cd288d649433?q=80&w=2070&auto=format&fit=crop',\n    'https://images.unsplash.com/photo-1469571486292-0ba58a3f068b?q=80&w=2070&auto=format&fit=crop',\n    'https://images.unsplash.com/photo-1532629345422-7515f3d16bb6?q=80&w=2070&auto=format&fit=crop'\n  ]\n\n  const params = useParams()\n  const locale = params.locale as string\n\n  useEffect(() => {\n    const localeQuery = locale ? `?locale=${locale}` : ''\n    // Fetch statistics\n    fetch(`/api/statistics${localeQuery}`)\n      .then(res => {\n        if (!res.ok) throw new Error(`Statistics API error: ${res.status}`)\n        return res.json()\n      })\n      .then(data => {\n        console.log('Statistics loaded:', data)\n        setStatistics(data)\n      })\n      .catch(err => console.error('Error loading statistics:', err))\n\n    // Fetch testimonials\n    fetch(`/api/testimonials?status=APPROVED${locale ? `&locale=${locale}` : ''}`)\n      .then(res => {\n        if (!res.ok) throw new Error(`Testimonials API error: ${res.status}`)\n        return res.json()\n      })\n      .then(data => {\n        console.log('Testimonials loaded:', data)\n        setTestimonials(data)\n      })\n      .catch(err => console.error('Error loading testimonials:', err))\n\n    // Fetch content\n    fetch(`/api/content?keys=hero_title,hero_subtitle,mission_statement${locale ? `&locale=${locale}` : ''}`)\n      .then(res => {\n        if (!res.ok) throw new Error(`Content API error: ${res.status}`)\n        return res.json()\n      })\n      .then(data => {\n        console.log('Content loaded:', data)\n        setContent(data)\n      })\n      .catch(err => console.error('Error loading content:', err))\n  }, [locale])\n\n  // Auto-slide effect\n  useEffect(() => {\n    if (isPaused) return\n\n    const interval = setInterval(() => {\n      setCurrentSlide((prev) => (prev + 1) % heroImages.length)\n    }, 5000) // Change slide every 5 seconds\n\n    return () => clearInterval(interval)\n  }, [heroImages.length, isPaused])\n\n  const nextSlide = useCallback(() => {\n    setCurrentSlide((prev) => (prev + 1) % heroImages.length)\n  }, [heroImages.length])\n\n  const prevSlide = useCallback(() => {\n    setCurrentSlide((prev) => (prev - 1 + heroImages.length) % heroImages.length)\n  }, [heroImages.length])\n\n  // Keyboard navigation\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === 'ArrowLeft') {\n        prevSlide()\n      } else if (e.key === 'ArrowRight') {\n        nextSlide()\n      }\n    }\n\n    window.addEventListener('keydown', handleKeyDown)\n    return () => window.removeEventListener('keydown', handleKeyDown)\n  }, [prevSlide, nextSlide])\n\n  function getIconComponent(iconName: string, size: number) {\n    const Icon = (Icons as any)[iconName] || Icons.BarChart3\n    return <Icon size={size} className=\"mb-4 text-[#2E8B57] drop-shadow-lg\" />\n  }\n\n  return (\n    <div className=\"flex flex-col gap-16 pb-16\">\n      {/* Hero Section with Enhanced Carousel */}\n      <section\n        className=\"relative h-[600px] flex items-center justify-center text-white overflow-hidden group\"\n        onMouseEnter={() => setIsPaused(true)}\n        onMouseLeave={() => setIsPaused(false)}\n        aria-label=\"Hero carousel\"\n      >\n        <div className=\"absolute inset-0 bg-gradient-to-r from-[#6E8C82]/70 to-[#2E8B57]/70 z-10\" />\n\n        {/* Sliding Background Images */}\n        {heroImages.map((image, index) => (\n          <div\n            key={index}\n            className={`absolute inset-0 bg-cover bg-center transition-opacity duration-1000 ${index === currentSlide ? 'opacity-100' : 'opacity-0'\n              }`}\n            style={{ backgroundImage: `url(\"${image}\")` }}\n            aria-hidden={index !== currentSlide}\n          />\n        ))}\n\n        {/* Navigation Arrows */}\n        <button\n          onClick={prevSlide}\n          className=\"absolute left-4 z-30 bg-white/20 hover:bg-white/30 backdrop-blur-sm p-3 rounded-full transition-all duration-300 opacity-0 group-hover:opacity-100 focus:opacity-100 hover:scale-110\"\n          aria-label=\"Previous slide\"\n        >\n          <ChevronLeft size={28} className=\"text-white drop-shadow-lg\" />\n        </button>\n        <button\n          onClick={nextSlide}\n          className=\"absolute right-4 z-30 bg-white/20 hover:bg-white/30 backdrop-blur-sm p-3 rounded-full transition-all duration-300 opacity-0 group-hover:opacity-100 focus:opacity-100 hover:scale-110\"\n          aria-label=\"Next slide\"\n        >\n          <ChevronRight size={28} className=\"text-white drop-shadow-lg\" />\n        </button>\n\n        {/* Slide Indicators */}\n        <div className=\"absolute bottom-8 left-1/2 transform -translate-x-1/2 z-30 flex gap-2\" role=\"tablist\">\n          {heroImages.map((_, index) => (\n            <button\n              key={index}\n              onClick={() => setCurrentSlide(index)}\n              className={`h-3 rounded-full transition-all duration-300 ${index === currentSlide\n                ? 'bg-white w-8 shadow-lg'\n                : 'bg-white/50 hover:bg-white/75 w-3'\n                }`}\n              aria-label={`Go to slide ${index + 1}`}\n              aria-selected={index === currentSlide}\n              role=\"tab\"\n            />\n          ))}\n        </div>\n\n        <div className=\"relative z-20 text-center max-w-4xl px-4\">\n          <h1\n            className=\"text-4xl md:text-6xl font-bold mb-6 font-heading drop-shadow-[0_4px_12px_rgba(0,0,0,0.8)]\"\n          >\n            {content.hero_title || t('hero.title')}\n          </h1>\n          <p\n            className=\"text-xl md:text-2xl mb-8 text-gray-100 drop-shadow-[0_2px_8px_rgba(0,0,0,0.6)]\"\n          >\n            {content.hero_subtitle || t('hero.subtitle')}\n          </p>\n          <div\n            className=\"flex flex-col sm:flex-row gap-4 justify-center\"\n          >\n            <Link\n              href=\"/get-involved\"\n              className=\"bg-[#2E8B57] hover:bg-[#267347] text-white px-8 py-3 rounded-full text-lg font-semibold transition-all duration-300 flex items-center justify-center gap-2 hover:scale-105 shadow-[0_8px_16px_rgba(0,0,0,0.3)] hover:shadow-[0_12px_24px_rgba(0,0,0,0.4)] active:scale-95\"\n            >\n              <Heart size={20} />\n              {t('hero.donateNow')}\n            </Link>\n            <Link\n              href=\"/programs\"\n              className=\"bg-white hover:bg-gray-100 text-[#6E8C82] px-8 py-3 rounded-full text-lg font-semibold transition-all duration-300 hover:scale-105 shadow-[0_8px_16px_rgba(0,0,0,0.3)] hover:shadow-[0_12px_24px_rgba(0,0,0,0.4)] active:scale-95\"\n            >\n              {t('hero.ourPrograms')}\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Advertisement: Home Top */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full\">\n        <AdSlot placement=\"HOME_TOP\" className=\"w-full min-h-[90px] bg-gray-50 rounded-lg flex items-center justify-center\" />\n      </div>\n\n      {/* Mission Summary */}\n      <section className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center\">\n        <div>\n          <h2 className=\"text-3xl font-bold text-[#6E8C82] mb-6\">{t('mission.title')}</h2>\n          <p className=\"text-xl text-gray-700 max-w-3xl mx-auto leading-relaxed\">\n            {content.mission_statement || t('mission.statement')}\n          </p>\n        </div>\n      </section>\n\n      {/* Impact Stats with Hover Animations - Dynamic */}\n      <section className=\"bg-gradient-to-r from-[#6E8C82] to-[#0b5090] text-white py-16\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8 text-center\">\n            {statistics && statistics.length > 0 ? (\n              statistics.map((stat, index) => (\n                <div\n                  key={index}\n                  className=\"flex flex-col items-center\"\n                >\n                  {getIconComponent(stat.icon, 48)}\n                  <div className=\"text-4xl font-bold mb-2\">{stat.value}</div>\n                  <div className=\"text-sm opacity-90\">{stat.label}</div>\n                </div>\n              ))\n            ) : (\n              <div className=\"col-span-4 text-center text-white/70\">{t('common.loading')}</div>\n            )}\n          </div>\n        </div>\n      </section>\n\n      {/* Program Highlights */}\n      <section className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex justify-between items-end mb-8\">\n          <div>\n            <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">{t('programs.title')}</h2>\n            <p className=\"text-gray-600\">{t('programs.subtitle')}</p>\n          </div>\n          <Link href=\"/programs\" className=\"text-[#6E8C82] hover:text-[#0b5090] hover:underline flex items-center gap-1 transition-colors\">\n            {t('programs.viewAll')} <ArrowRight size={16} />\n          </Link>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n          {[\n            {\n              title: t('programs.emergencyNutrition.title'),\n              desc: t('programs.emergencyNutrition.desc'),\n              img: 'https://images.unsplash.com/photo-1531206715517-5c0ba140b2b8?q=80&w=2070&auto=format&fit=crop'\n            },\n            {\n              title: t('programs.communityGardens.title'),\n              desc: t('programs.communityGardens.desc'),\n              img: 'https://images.unsplash.com/photo-1591857177580-dc82b92811d9?q=80&w=2070&auto=format&fit=crop'\n            },\n            {\n              title: t('programs.mobileHealth.title'),\n              desc: t('programs.mobileHealth.desc'),\n              img: 'https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?q=80&w=2070&auto=format&fit=crop'\n            }\n          ].map((program, i) => (\n            <div\n              key={i}\n              className=\"bg-white rounded-xl shadow-[0_4px_20px_rgba(0,0,0,0.08)] hover:shadow-[0_12px_40px_rgba(0,0,0,0.15)] overflow-hidden transition-all duration-500 border border-gray-100 group animate-fade-in-up\"\n              style={{ animationDelay: `${i * 150}ms` }}\n            >\n              <div className=\"h-48 bg-gray-200 relative overflow-hidden\">\n                <div\n                  className=\"absolute inset-0 bg-cover bg-center transition-transform duration-700 group-hover:scale-110\"\n                  style={{ backgroundImage: `url(\"${program.img}\")` }}\n                />\n                <div className=\"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300\" />\n              </div>\n              <div className=\"p-6\">\n                <h3 className=\"text-xl font-bold mb-2 text-gray-900 group-hover:text-[#6E8C82] transition-colors\">{program.title}</h3>\n                <p className=\"text-gray-600 mb-4\">{program.desc}</p>\n                <Link href=\"/programs\" className=\"text-[#2E8B57] font-medium hover:text-[#267347] hover:underline transition-colors inline-flex items-center gap-1 group/link\">\n                  {t('programs.learnMore')}\n                  <ArrowRight size={16} className=\"transition-transform group-hover/link:translate-x-1\" />\n                </Link>\n              </div>\n            </div>\n          ))}\n        </div>\n      </section>\n\n      {/* Testimonials - Dynamic */}\n      {testimonials.length > 0 && (\n        <section className=\"bg-gray-50 py-16\">\n          <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <div>\n              <h2 className=\"text-3xl font-bold text-gray-900 mb-2 text-center\">{t('testimonials.title')}</h2>\n              <p className=\"text-gray-600 text-center mb-12\">{t('testimonials.subtitle')}</p>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n              {testimonials.slice(0, 3).map((testimonial, index) => (\n                <div\n                  key={index}\n                  className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 h-full\"\n                >\n                  <Quote size={32} className=\"text-[#6E8C82] mb-4 opacity-20\" />\n                  <p className=\"text-gray-700 mb-4 italic\">&quot;{testimonial.message}&quot;</p>\n                  <div className=\"flex items-center justify-between mt-auto\">\n                    <div>\n                      <p className=\"font-semibold text-gray-900\">{testimonial.name}</p>\n                      {testimonial.role && (\n                        <p className=\"text-sm text-gray-600\">{testimonial.role}</p>\n                      )}\n                    </div>\n                    {testimonial.rating && (\n                      <div className=\"flex gap-1\">\n                        {Array.from({ length: testimonial.rating }).map((_, i) => (\n                          <Star key={i} size={14} className=\"fill-yellow-400 text-yellow-400\" />\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </section>\n      )}\n\n      {/* Advertisement: Home Bottom */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full\">\n        <AdSlot placement=\"HOME_BOTTOM\" className=\"w-full min-h-[90px] bg-gray-50 rounded-lg flex items-center justify-center\" />\n      </div>\n\n      {/* Share Your Story */}\n      <section className=\"py-16 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-8\">\n          <h2 className=\"text-3xl font-bold text-gray-900 mb-2 text-center\">{t('shareStory.title')}</h2>\n          <p className=\"text-gray-600 text-center mb-8\">\n            {t('shareStory.subtitle')}\n          </p>\n          <TestimonialForm />\n        </div>\n      </section>\n    </div>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/privacy-policy/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslations' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { useTranslations } from 'next-intl';\n\nexport default function PrivacyPolicy() {\n    return (\n        <div className=\"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n            <div className=\"max-w-4xl mx-auto bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden\">\n                <div className=\"bg-[#6E8C82] py-8 px-8\">\n                    <h1 className=\"text-3xl font-bold text-white mb-2\">Privacy Policy</h1>\n                    <p className=\"text-[#6E8C82]/10 text-white/80\">Last Updated: December 2025</p>\n                </div>\n\n                <div className=\"p-8 space-y-8 text-gray-700 leading-relaxed\">\n                    <section>\n                        <h2 className=\"text-2xl font-bold text-[#6E8C82] mb-4\">1. Introduction</h2>\n                        <p>\n                            Welcome to the Nutrition Relief & Development Centre (NRDC). We are committed to protecting\n                            your privacy and ensuring the security of your personal information. This Privacy Policy\n                            outlines how we collect, use, and safeguard your data when you visit our website or\n                            engage with our programs.\n                        </p>\n                    </section>\n\n                    <section>\n                        <h2 className=\"text-2xl font-bold text-[#6E8C82] mb-4\">2. Information We Collect</h2>\n                        <p className=\"mb-4\">We collect information that helps us provide better support and communicate effectively with our donors and community members:</p>\n                        <ul className=\"list-disc pl-6 space-y-2\">\n                            <li><strong>Personal Information:</strong> Name, email address, phone number, and location when you donate or subscribe.</li>\n                            <li><strong>Usage Data:</strong> Information about how you use our website, including IP address, browser type, and pages visited.</li>\n                            <li><strong>Cookies:</strong> Small data files stored on your device to enhance site functionality.</li>\n                        </ul>\n                    </section>\n\n                    <section>\n                        <h2 className=\"text-2xl font-bold text-[#6E8C82] mb-4\">3. How We Use Your Information</h2>\n                        <ul className=\"list-disc pl-6 space-y-2\">\n                            <li>To process donations and issue receipts.</li>\n                            <li>To send updates about our programs, impact stories, and newsletters (with your consent).</li>\n                            <li>To improve our website functionality and user experience.</li>\n                            <li>To comply with legal obligations and ensure security.</li>\n                        </ul>\n                    </section>\n\n                    <section>\n                        <h2 className=\"text-2xl font-bold text-[#6E8C82] mb-4\">4. Cookies and Tracking</h2>\n                        <p>\n                            We use cookies to analyze site traffic and personalize content. You can choose to accept or\n                            decline cookies through our Cookie Consent banner. Essential cookies may remain active\n                            to ensure the website functions correctly.\n                        </p>\n                    </section>\n\n                    <section>\n                        <h2 className=\"text-2xl font-bold text-[#6E8C82] mb-4\">5. Data Security</h2>\n                        <p>\n                            We implement industry-standard security measures to protect your personal information\n                            from unauthorized access, alteration, disclosure, or destruction. However, no internet\n                            transmission is completely secure, and we cannot guarantee absolute security.\n                        </p>\n                    </section>\n\n                    <section>\n                        <h2 className=\"text-2xl font-bold text-[#6E8C82] mb-4\">6. Your Rights</h2>\n                        <p className=\"mb-4\">You have the right to:</p>\n                        <ul className=\"list-disc pl-6 space-y-2\">\n                            <li>Access usage data we hold about you.</li>\n                            <li>Request correction of inaccurate information.</li>\n                            <li>Request deletion of your data (subject to legal retention requirements).</li>\n                            <li>Opt-out of marketing communications at any time.</li>\n                        </ul>\n                    </section>\n\n                    <section>\n                        <h2 className=\"text-2xl font-bold text-[#6E8C82] mb-4\">7. Contact Us</h2>\n                        <p>\n                            If you have any questions about this Privacy Policy, please contact us at:\n                        </p>\n                        <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-100\">\n                            <p className=\"font-semibold text-[#6E8C82]\">Nutrition Relief & Development Centre</p>\n                            <p>Email: nrdcofficial12@gmail.com</p>\n                            <p>Phone: +254 727 001 702 / +254 702 121 310</p>\n                            <p>Address: Nairobi, Kenya</p>\n                        </div>\n                    </section>\n                </div>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/programs/[slug]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'photos' is assigned a value but never used.","line":29,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { prisma } from '@/lib/prisma'\nimport { notFound } from 'next/navigation'\nimport Link from 'next/link'\nimport { ArrowLeft, CheckCircle, BarChart } from 'lucide-react'\n\nexport const dynamic = 'force-dynamic'\n\nexport default async function ProgramDetailPage({ params }: { params: Promise<{ slug: string; locale: string }> }) {\n    const { slug, locale } = await params\n    const program = await prisma.program.findUnique({\n        where: { slug },\n        include: {\n            translations: {\n                where: { locale }\n            }\n        }\n    })\n\n    if (!program) {\n        notFound()\n    }\n\n    const translation = program.translations[0]\n    const title = translation?.title || program.title\n    const description = translation?.description || program.description\n\n    const objectives = JSON.parse(program.objectives || '[]')\n    const metrics = JSON.parse(program.metrics || '{}')\n    const photos = JSON.parse(program.photos || '[]')\n\n    return (\n        <div className=\"pb-16\">\n            <section className=\"bg-gray-50 py-12\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                    <Link href=\"/programs\" className=\"inline-flex items-center text-gray-600 hover:text-[#6E8C82] mb-8\">\n                        <ArrowLeft size={16} className=\"mr-2\" /> {locale === 'fr' ? 'Retour aux Programmes' : 'Back to Programs'}\n                    </Link>\n                    <h1 className=\"text-4xl md:text-5xl font-bold text-gray-900 mb-6\">{title}</h1>\n                </div>\n            </section>\n\n            <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-12\">\n                    <div className=\"lg:col-span-2\">\n                        <div className=\"prose max-w-none mb-12\">\n                            <h2 className=\"text-2xl font-bold text-[#6E8C82] mb-4\">{locale === 'fr' ? 'Ã€ Propos du Programme' : 'About the Program'}</h2>\n                            <p className=\"text-lg text-gray-700 leading-relaxed whitespace-pre-wrap\">{description}</p>\n                        </div>\n\n                        <div className=\"mb-12\">\n                            <h2 className=\"text-2xl font-bold text-[#6E8C82] mb-6\">{locale === 'fr' ? 'Objectifs ClÃ©s' : 'Key Objectives'}</h2>\n                            <ul className=\"space-y-4\">\n                                {objectives.map((obj: string, i: number) => (\n                                    <li key={i} className=\"flex items-start gap-3\">\n                                        <CheckCircle className=\"text-[#2E8B57] mt-1 flex-shrink-0\" size={20} />\n                                        <span className=\"text-gray-700 text-lg\">{obj}</span>\n                                    </li>\n                                ))}\n                            </ul>\n                        </div>\n                    </div>\n\n                    <div className=\"lg:col-span-1\">\n                        <div className=\"bg-white p-6 rounded-xl shadow-lg border border-gray-100 sticky top-24\">\n                            <h3 className=\"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">\n                                <BarChart className=\"text-[#6E8C82]\" /> {locale === 'fr' ? 'Mesures d\\'Impact' : 'Impact Metrics'}\n                            </h3>\n                            <div className=\"space-y-6\">\n                                {Object.entries(metrics).map(([key, value]) => (\n                                    <div key={key}>\n                                        <div className=\"text-3xl font-bold text-[#2E8B57]\">{String(value)}</div>\n                                        <div className=\"text-gray-600 capitalize\">\n                                            {locale === 'fr' ? (\n                                                key === 'beneficiaries' ? 'bÃ©nÃ©ficiaires' :\n                                                    key === 'meals' ? 'repas' :\n                                                        key === 'gardens' ? 'jardins' :\n                                                            key === 'families' ? 'familles' :\n                                                                key === 'patients' ? 'patients' :\n                                                                    key === 'villages' ? 'villages' :\n                                                                        key.replace(/_/g, ' ')\n                                            ) : key.replace(/_/g, ' ')}\n                                        </div>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/[locale]/programs/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/AdminShell.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Image' is defined but never used.","line":6,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":13},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/home/evans/Projects/NRDC/app/admin/AdminShell.tsx:69:13\n  67 |         const publicPages = ['/admin/login', '/admin/forgot-password', '/admin/reset-password']\n  68 |         if (publicPages.includes(pathname) || pathname.startsWith('/admin/reset-password')) {\n> 69 |             setLoading(false)\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  70 |             return\n  71 |         }\n  72 |","line":69,"column":13,"nodeType":null,"endLine":69,"endColumn":23},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":111,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":111,"endColumn":55},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":112,"column":44,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":112,"endColumn":64}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useRouter, usePathname } from 'next/navigation'\nimport Link from 'next/link'\nimport Image from 'next/image'\nimport {\n    LayoutDashboard,\n    FileText,\n    BookOpen,\n    Image as ImageIcon,\n    Mail,\n    LogOut,\n    Menu,\n    X,\n    Settings,\n    Users,\n    BarChart3,\n    FileDown,\n    MessageSquare,\n    Edit3,\n    AlertTriangle,\n    Activity,\n    Globe,\n    Megaphone,\n    Heart,\n    Repeat,\n} from 'lucide-react'\nimport clsx from 'clsx'\nimport { ToastProvider } from '@/components/Toast'\nimport { ConfirmDialogProvider } from '@/components/ConfirmDialog'\nimport GlobalSearch from '@/components/GlobalSearch'\nimport Navbar from '@/components/Navbar'\nimport Footer from '@/components/Footer'\n\nconst navItems = [\n    { name: 'Dashboard', href: '/admin/dashboard', icon: LayoutDashboard, adminOnly: false },\n    { name: 'Programs', href: '/admin/programs', icon: FileText, adminOnly: false },\n    { name: 'Blog Posts', href: '/admin/blog', icon: BookOpen, adminOnly: false },\n    { name: 'Gallery', href: '/admin/gallery', icon: ImageIcon, adminOnly: false },\n    { name: 'Team Members', href: '/admin/team', icon: Users, adminOnly: true },\n    { name: 'Statistics', href: '/admin/statistics', icon: BarChart3, adminOnly: false },\n    { name: 'Resources', href: '/admin/resources', icon: FileDown, adminOnly: false },\n    { name: 'Testimonials', href: '/admin/testimonials', icon: MessageSquare, adminOnly: false },\n    { name: 'Site Content', href: '/admin/content', icon: Edit3, adminOnly: false },\n    { name: 'Contact Messages', href: '/admin/contact', icon: Mail, adminOnly: false },\n    { name: 'Translations', href: '/admin/translations', icon: Globe, adminOnly: true },\n    { name: 'Advertisements', href: '/admin/ads', icon: Megaphone, adminOnly: false },\n    { name: 'Donations', href: '/admin/donations', icon: Heart, adminOnly: false },\n    { name: 'Subscriptions', href: '/admin/subscriptions', icon: Repeat, adminOnly: false },\n    { name: 'System Logs', href: '/admin/logs', icon: AlertTriangle, adminOnly: true },\n    { name: 'Audit Logs', href: '/admin/audit', icon: Activity, adminOnly: true },\n    { name: 'User Management', href: '/admin/users', icon: Users, adminOnly: true },\n    { name: 'Settings', href: '/admin/settings', icon: Settings, adminOnly: true },\n]\n\n\nexport default function AdminLayout({ children }: { children: React.ReactNode }) {\n    const router = useRouter()\n    const pathname = usePathname()\n    const [isOpen, setIsOpen] = useState(false)\n    const [loading, setLoading] = useState(true)\n    const [userRole, setUserRole] = useState<string | null>(null)\n\n    useEffect(() => {\n        // Public admin pages that don't require authentication\n        const publicPages = ['/admin/login', '/admin/forgot-password', '/admin/reset-password']\n        if (publicPages.includes(pathname) || pathname.startsWith('/admin/reset-password')) {\n            setLoading(false)\n            return\n        }\n\n        setLoading(true) // Ensure we show spinner while checking auth for protected pages\n\n        async function checkAuth() {\n            try {\n                const res = await fetch('/api/auth/me')\n                const data = await res.json()\n\n                if (!data.user) {\n                    router.push('/admin/login')\n                } else {\n                    setUserRole(data.user.role)\n                    setLoading(false)\n                }\n            } catch (error) {\n                console.error('Auth check failed:', error)\n                setLoading(false)\n            }\n        }\n        checkAuth()\n    }, [pathname, router]) // Add dependencies\n\n    async function handleLogout() {\n        await fetch('/api/auth/me', { method: 'POST' })\n        router.push('/admin/login')\n    }\n\n    if (loading) {\n        return (\n            <div className=\"min-h-screen flex items-center justify-center\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#6E8C82]\"></div>\n            </div>\n        )\n    }\n\n    const publicPages = ['/admin/login', '/admin/forgot-password', '/admin/reset-password']\n    if (publicPages.includes(pathname) || pathname.startsWith('/admin/reset-password')) {\n        // For admin auth pages, we need to provide minimal i18n context for Navbar\n        // We'll use English as default\n        const messages = require('@/messages/en.json')\n        const { NextIntlClientProvider } = require('next-intl')\n\n        return (\n            <NextIntlClientProvider locale=\"en\" messages={messages}>\n                <Navbar />\n                <main className=\"flex-grow\">\n                    {children}\n                </main>\n                <Footer />\n            </NextIntlClientProvider>\n        )\n    }\n\n    return (\n        <ConfirmDialogProvider>\n            <ToastProvider>\n                <div className=\"min-h-screen bg-gray-50 flex\">\n                    {/* Sidebar */}\n                    <aside className={clsx(\n                        'fixed inset-y-0 left-0 z-50 w-64 bg-[#6E8C82] text-white transform transition-transform duration-200 ease-in-out lg:relative lg:translate-x-0 flex flex-col',\n                        isOpen ? 'translate-x-0' : '-translate-x-full'\n                    )}>\n                        <div className=\"p-6 border-b border-[#587068] flex-shrink-0\">\n                            <h2 className=\"text-xl font-bold text-white\">Admin Panel</h2>\n                        </div>\n                        <nav className=\"flex-1 overflow-y-auto p-4\">\n                            {userRole === null ? (\n                                // Show skeleton loading state while fetching user role\n                                <div className=\"space-y-2\">\n                                    {[1, 2, 3, 4, 5, 6].map((i) => (\n                                        <div key={i} className=\"h-12 bg-[#6E8C82] rounded-lg animate-pulse\" />\n                                    ))}\n                                </div>\n                            ) : (\n                                navItems\n                                    .filter(item => !item.adminOnly || userRole === 'ADMIN')\n                                    .map((item) => (\n                                        <Link\n                                            key={item.name}\n                                            href={item.href}\n                                            onClick={() => setIsOpen(false)}\n                                            className={clsx(\n                                                \"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-[#587068] transition-colors mb-2\",\n                                                pathname === item.href && \"bg-[#587068]\"\n                                            )}\n                                        >\n                                            <item.icon size={20} />\n                                            {item.name}\n                                        </Link>\n                                    ))\n                            )}\n                        </nav>\n                        <div className=\"p-4 border-t border-[#587068] flex-shrink-0\">\n                            <button\n                                onClick={handleLogout}\n                                className=\"flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-[#587068] transition-colors w-full\"\n                            >\n                                <LogOut size={20} />\n                                Logout\n                            </button>\n                        </div>\n                    </aside>\n\n                    {/* Main Content */}\n                    <div className=\"flex-1 flex flex-col w-full\">\n                        <header className=\"bg-white shadow-sm p-4 lg:hidden\">\n                            <button onClick={() => setIsOpen(!isOpen)}>\n                                {isOpen ? <X size={24} /> : <Menu size={24} />}\n                            </button>\n                        </header>\n                        <main className=\"flex-1 p-8\">\n                            {children}\n                        </main>\n                    </div>\n\n\n                    {/* Overlay */}\n                    {\n                        isOpen && (\n                            <div\n                                className=\"fixed inset-0 bg-black/50 z-40 lg:hidden\"\n                                onClick={() => setIsOpen(false)}\n                            />\n                        )\n                    }\n                </div>\n                <GlobalSearch />\n            </ToastProvider>\n        </ConfirmDialogProvider>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/ads/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used.","line":4,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MousePointer' is defined but never used.","line":4,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":49},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Copy' is defined but never used.","line":4,"column":66,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":70},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[483,486],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[483,486],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Plus, Search, Trash2, Eye, MousePointer, Palette, Edit, Copy } from 'lucide-react'\n\ninterface Advertisement {\n    id: string\n    name: string\n    type: string\n    placement: string\n    code: string\n    priority: number\n    active: boolean\n    startDate: string | null\n    endDate: string | null\n    impressions: number\n    clicks: number\n}\n\n// Ad template generator\nconst generateAdCode = (template: string, config: any) => {\n    const adContent = {\n        gradient_banner: `\n            <div style=\"width: 100%; max-width: ${config.width || '728px'}; height: ${config.height || '90px'}; margin: 0 auto; background: linear-gradient(135deg, ${config.color1 || '#667eea'} 0%, ${config.color2 || '#764ba2'} 100%); background-size: 200% 200%; animation: gradientShift 3s ease infinite; border-radius: 12px; position: relative; font-family: 'Inter', Arial, sans-serif; overflow: hidden; display: flex; align-items: center; justify-content: space-between; padding: 0 24px; box-sizing: border-box; cursor: pointer; box-shadow: 0 10px 40px rgba(102, 126, 234, 0.4); transition: all 0.3s ease;\" onmouseover=\"this.style.transform='translateY(-2px) scale(1.01)';\" onmouseout=\"this.style.transform='';\">\n                <div style=\"position: absolute; top: 4px; right: 4px; background: rgba(255,255,255,0.9); color: #666; font-size: 9px; padding: 2px 5px; border-radius: 3px;\">Ad</div>\n                <div style=\"display: flex; align-items: center; gap: 16px;\">\n                    <div style=\"width: 50px; height: 50px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); border-radius: 10px; display: flex; align-items: center; justify-content: center;\">\n                        <span style=\"font-size: 24px;\">${config.icon || 'ðŸŽ¯'}</span>\n                    </div>\n                    <div>\n                        <div style=\"color: white; font-weight: 700; font-size: 17px; text-shadow: 0 2px 4px rgba(0,0,0,0.1);\">${config.title || 'Your Ad Title'}</div>\n                        <div style=\"color: rgba(255,255,255,0.95); font-size: 12px;\">${config.subtitle || 'Add your description here'}</div>\n                    </div>\n                </div>\n                <div style=\"background: white; color: ${config.color1 || '#667eea'}; padding: 10px 22px; border-radius: 8px; font-size: 13px; font-weight: 700; box-shadow: 0 4px 15px rgba(0,0,0,0.15);\">\n                    ${config.buttonText || 'Learn More'} â†’\n                </div>\n                <style>@keyframes gradientShift { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; }}</style>\n            </div>\n        `,\n        product_showcase: `\n            <div style=\"width: ${config.width || '300px'}; height: ${config.height || '250px'}; margin: 0 auto; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 16px; position: relative; font-family: 'Inter', Arial, sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 24px; box-sizing: border-box; cursor: pointer; box-shadow: 0 10px 30px rgba(0,0,0,0.1); transition: all 0.4s ease;\" onmouseover=\"this.style.transform='scale(1.03)';\" onmouseout=\"this.style.transform='';\">\n                <div style=\"position: absolute; top: 8px; right: 8px; background: rgba(0,0,0,0.5); color: white; font-size: 9px; padding: 3px 6px; border-radius: 4px;\">Ad</div>\n                <div style=\"width: 110px; height: 110px; background: white; border-radius: 50%; margin-bottom: 16px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 25px rgba(0,0,0,0.12);\">\n                    <span style=\"font-size: 48px;\">${config.icon || 'ðŸŽ'}</span>\n                </div>\n                <div style=\"text-align: center;\">\n                    <div style=\"color: #333; font-weight: 800; font-size: 20px; margin-bottom: 6px;\">${config.title || 'Product Name'}</div>\n                    <div style=\"color: #666; font-size: 13px; margin-bottom: 18px;\">${config.subtitle || 'Product description here'}</div>\n                    <div style=\"background: #222; color: white; padding: 11px 28px; border-radius: 25px; font-size: 13px; font-weight: 700; display: inline-block; box-shadow: 0 4px 15px rgba(0,0,0,0.2);\">\n                        ${config.buttonText || 'Shop Now'}\n                    </div>\n                </div>\n            </div>\n        `\n    }\n\n    const content = adContent[template as keyof typeof adContent] || adContent.gradient_banner\n    const targetUrl = config.targetUrl || '#'\n\n    // Wrap in clickable link\n    return `<a href=\"${targetUrl}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"display: block; width: 100%; height: 100%; text-decoration: none; cursor: pointer;\">${content}</a>`\n}\n\nexport default function AdsPage() {\n    const [ads, setAds] = useState<Advertisement[]>([])\n    const [loading, setLoading] = useState(true)\n    const [searchTerm, setSearchTerm] = useState('')\n    const [editingAd, setEditingAd] = useState<Advertisement | null>(null)\n\n    const [isCreating, setIsCreating] = useState(false)\n    const [selectedTemplate, setSelectedTemplate] = useState('gradient_banner')\n    const [adConfig, setAdConfig] = useState({\n        name: '',\n        placement: 'HOME_TOP',\n        targetUrl: '#',\n        width: '728px',\n        height: '90px',\n        color1: '#667eea',\n        color2: '#764ba2',\n        title: 'Premium Service',\n        subtitle: 'Get started today with special offer',\n        buttonText: 'Learn More',\n        icon: 'ðŸŽ¯',\n        priority: 1,\n        active: true\n    })\n\n    useEffect(() => {\n        fetchAds()\n    }, [])\n\n    async function fetchAds() {\n        setLoading(true)\n        try {\n            const res = await fetch('/api/ads/manage')\n            if (res.ok) {\n                const data = await res.json()\n                setAds(data)\n            }\n        } catch (error) {\n            console.error('Error fetching ads:', error)\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    async function handleSaveAd() {\n        const code = generateAdCode(selectedTemplate, adConfig)\n        const adData = {\n            name: adConfig.name,\n            type: 'CUSTOM',\n            placement: adConfig.placement,\n            code: code,\n            priority: adConfig.priority,\n            active: adConfig.active,\n            startDate: null,\n            endDate: null\n        }\n\n        try {\n            const res = await fetch('/api/ads/manage', {\n                method: editingAd ? 'PUT' : 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(editingAd ? { ...adData, id: editingAd.id } : adData)\n            })\n\n            if (res.ok) {\n                fetchAds()\n                setIsCreating(false)\n                setEditingAd(null)\n                resetConfig()\n            }\n        } catch (error) {\n            console.error('Error saving ad:', error)\n        }\n    }\n\n    async function handleDelete(id: string) {\n        if (!confirm('Delete this ad?')) return\n        try {\n            const res = await fetch(`/api/ads/manage?id=${id}`, { method: 'DELETE' })\n            if (res.ok) fetchAds()\n        } catch (error) {\n            console.error('Error deleting ad:', error)\n        }\n    }\n\n    function handleEditAd(ad: Advertisement) {\n        setEditingAd(ad)\n        setIsCreating(true)\n\n        // Extract URL from code (simple regex)\n        const urlMatch = ad.code.match(/href=\"([^\"]*)\"/)\n        const currentUrl = urlMatch ? urlMatch[1] : adConfig.targetUrl\n\n        const config = {\n            ...adConfig,\n            name: ad.name,\n            placement: ad.placement,\n            targetUrl: currentUrl,\n            // Preserve other defaults for now as they are hard to parse back\n            // Ideally we should store config separately in DB but for now this fixes the link\n        }\n        setAdConfig(config)\n    }\n\n    function resetConfig() {\n        setAdConfig({\n            name: '',\n            placement: 'HOME_TOP',\n            targetUrl: '#',\n            width: '728px',\n            height: '90px',\n            color1: '#667eea',\n            color2: '#764ba2',\n            title: 'Premium Service',\n            subtitle: 'Get started today',\n            buttonText: 'Learn More',\n            icon: 'ðŸŽ¯',\n            priority: 1,\n            active: true\n        })\n    }\n\n    const filteredAds = ads.filter(a =>\n        a.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        a.placement.toLowerCase().includes(searchTerm.toLowerCase())\n    )\n\n    return (\n        <div className=\"p-6\">\n            <div className=\"flex justify-between items-center mb-6\">\n                <h1 className=\"text-2xl font-bold text-gray-900\">Visual Ad Builder</h1>\n                <button\n                    onClick={() => { setIsCreating(true); setEditingAd(null); resetConfig(); }}\n                    className=\"bg-[#6E8C82] text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-[#587068]\"\n                >\n                    <Plus size={20} />\n                    Create Visual Ad\n                </button>\n            </div>\n\n            <div className=\"bg-white rounded-xl shadow-sm border p-4 mb-6\">\n                <div className=\"relative\">\n                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" size={20} />\n                    <input\n                        type=\"text\"\n                        placeholder=\"Search ads...\"\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                        className=\"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6E8C82]\"\n                    />\n                </div>\n            </div>\n\n            {isCreating && (\n                <div className=\"bg-white p-6 rounded-xl shadow-lg border mb-6\">\n                    <h3 className=\"font-bold text-xl mb-4 flex items-center gap-2\">\n                        <Palette /> {editingAd ? 'Edit' : 'Create'} Visual Ad\n                    </h3>\n\n                    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                        {/* Configuration Panel */}\n                        <div className=\"space-y-4\">\n                            <div>\n                                <label className=\"block text-sm font-medium mb-1\">Ad Name</label>\n                                <input\n                                    type=\"text\"\n                                    value={adConfig.name}\n                                    onChange={(e) => setAdConfig({ ...adConfig, name: e.target.value })}\n                                    className=\"w-full px-3 py-2 border rounded-lg\"\n                                    placeholder=\"e.g., Summer Sale Banner\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium mb-1\">Template</label>\n                                <select\n                                    value={selectedTemplate}\n                                    onChange={(e) => {\n                                        setSelectedTemplate(e.target.value)\n                                        if (e.target.value === 'product_showcase') {\n                                            setAdConfig({ ...adConfig, width: '300px', height: '250px' })\n                                        } else {\n                                            setAdConfig({ ...adConfig, width: '728px', height: '90px' })\n                                        }\n                                    }}\n                                    className=\"w-full px-3 py-2 border rounded-lg\"\n                                >\n                                    <option value=\"gradient_banner\">Gradient Banner (728x90)</option>\n                                    <option value=\"product_showcase\">Product Showcase (300x250)</option>\n                                </select>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium mb-1\">Placement</label>\n                                <select\n                                    value={adConfig.placement}\n                                    onChange={(e) => setAdConfig({ ...adConfig, placement: e.target.value })}\n                                    className=\"w-full px-3 py-2 border rounded-lg\"\n                                >\n                                    <option value=\"HOME_TOP\">Home Top</option>\n                                    <option value=\"HOME_BOTTOM\">Home Bottom</option>\n                                    <option value=\"BLOG_TOP\">Blog Top</option>\n                                    <option value=\"BLOG_BOTTOM\">Blog Bottom</option>\n                                    <option value=\"PROGRAMS_TOP\">Programs Top</option>\n                                    <option value=\"PROGRAMS_BOTTOM\">Programs Bottom</option>\n                                </select>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium mb-1\">Target URL (Click Destination)</label>\n                                <input\n                                    type=\"url\"\n                                    value={adConfig.targetUrl}\n                                    onChange={(e) => setAdConfig({ ...adConfig, targetUrl: e.target.value })}\n                                    className=\"w-full px-3 py-2 border rounded-lg\"\n                                    placeholder=\"https://example.com/your-product\"\n                                />\n                                <p className=\"text-xs text-gray-500 mt-1\">Where users go when they click the ad</p>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium mb-1\">Color 1</label>\n                                    <input\n                                        type=\"color\"\n                                        value={adConfig.color1}\n                                        onChange={(e) => setAdConfig({ ...adConfig, color1: e.target.value })}\n                                        className=\"w-full h-10 rounded cursor-pointer\"\n                                    />\n                                </div>\n                                <div>\n                                    <label className=\"block text-sm font-medium mb-1\">Color 2</label>\n                                    <input\n                                        type=\"color\"\n                                        value={adConfig.color2}\n                                        onChange={(e) => setAdConfig({ ...adConfig, color2: e.target.value })}\n                                        className=\"w-full h-10 rounded cursor-pointer\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium mb-1\">Icon (Emoji)</label>\n                                <input\n                                    type=\"text\"\n                                    value={adConfig.icon}\n                                    onChange={(e) => setAdConfig({ ...adConfig, icon: e.target.value })}\n                                    className=\"w-full px-3 py-2 border rounded-lg text-2xl text-center\"\n                                    maxLength={2}\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium mb-1\">Title</label>\n                                <input\n                                    type=\"text\"\n                                    value={adConfig.title}\n                                    onChange={(e) => setAdConfig({ ...adConfig, title: e.target.value })}\n                                    className=\"w-full px-3 py-2 border rounded-lg\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium mb-1\">Subtitle</label>\n                                <input\n                                    type=\"text\"\n                                    value={adConfig.subtitle}\n                                    onChange={(e) => setAdConfig({ ...adConfig, subtitle: e.target.value })}\n                                    className=\"w-full px-3 py-2 border rounded-lg\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium mb-1\">Button Text</label>\n                                <input\n                                    type=\"text\"\n                                    value={adConfig.buttonText}\n                                    onChange={(e) => setAdConfig({ ...adConfig, buttonText: e.target.value })}\n                                    className=\"w-full px-3 py-2 border rounded-lg\"\n                                />\n                            </div>\n\n                            <div className=\"flex items-center gap-2\">\n                                <input\n                                    type=\"checkbox\"\n                                    checked={adConfig.active}\n                                    onChange={(e) => setAdConfig({ ...adConfig, active: e.target.checked })}\n                                    className=\"w-4 h-4\"\n                                />\n                                <label className=\"text-sm font-medium\">Active</label>\n                            </div>\n                        </div>\n\n                        {/* Live Preview */}\n                        <div>\n                            <label className=\"block text-sm font-medium mb-2\">Live Preview</label>\n                            <div className=\"bg-gray-50 p-6 rounded-lg border-2 border-dashed border-gray-300 min-h-[300px] flex items-center justify-center\">\n                                <div dangerouslySetInnerHTML={{ __html: generateAdCode(selectedTemplate, adConfig) }} />\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"flex justify-end gap-2 mt-6\">\n                        <button\n                            onClick={() => { setIsCreating(false); setEditingAd(null); }}\n                            className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg\"\n                        >\n                            Cancel\n                        </button>\n                        <button\n                            onClick={handleSaveAd}\n                            className=\"px-4 py-2 bg-[#6E8C82] text-white rounded-lg hover:bg-[#587068]\"\n                        >\n                            {editingAd ? 'Update' : 'Save'} Ad\n                        </button>\n                    </div>\n                </div>\n            )}\n\n            <div className=\"grid grid-cols-1 gap-4\">\n                {loading ? (\n                    <div className=\"text-center py-8\">Loading...</div>\n                ) : filteredAds.length === 0 ? (\n                    <div className=\"text-center py-8 text-gray-500\">No ads found</div>\n                ) : (\n                    filteredAds.map((ad) => (\n                        <div key={ad.id} className=\"bg-white p-4 rounded-xl shadow-sm border\">\n                            <div className=\"flex items-start justify-between gap-4\">\n                                <div className=\"flex-1\">\n                                    <div className=\"flex items-center gap-2 mb-2\">\n                                        <span className={`w-2 h-2 rounded-full ${ad.active ? 'bg-green-500' : 'bg-gray-300'}`} />\n                                        <h3 className=\"font-bold\">{ad.name}</h3>\n                                        <span className=\"text-xs bg-[#6E8C82]/10 px-2 py-0.5 rounded\">{ad.placement}</span>\n                                    </div>\n                                    <div className=\"bg-gray-50 p-4 rounded border\">\n                                        <div dangerouslySetInnerHTML={{ __html: ad.code }} />\n                                    </div>\n                                </div>\n\n                                <div className=\"flex flex-col gap-2\">\n                                    <div className=\"text-center px-3 py-1 bg-gray-50 rounded\">\n                                        <div className=\"text-xs text-gray-500\">Views</div>\n                                        <div className=\"font-bold\">{ad.impressions}</div>\n                                    </div>\n                                    <div className=\"text-center px-3 py-1 bg-gray-50 rounded\">\n                                        <div className=\"text-xs text-gray-500\">Clicks</div>\n                                        <div className=\"font-bold\">{ad.clicks}</div>\n                                    </div>\n                                    <button\n                                        onClick={() => handleEditAd(ad)}\n                                        className=\"p-2 text-[#6E8C82] hover:bg-[#6E8C82]/10 rounded\"\n                                        title=\"Edit\"\n                                    >\n                                        <Edit size={18} />\n                                    </button>\n                                    <button\n                                        onClick={() => handleDelete(ad.id)}\n                                        className=\"p-2 text-red-500 hover:bg-red-50 rounded\"\n                                        title=\"Delete\"\n                                    >\n                                        <Trash2 size={18} />\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    ))\n                )}\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/audit/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":4,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":4,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":52}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Activity, RefreshCw, Clock, User, FileText, PlusCircle, Edit2, Trash2, LogIn } from 'lucide-react'\n\ninterface AuditLog {\n    id: string\n    action: string\n    entity: string\n    entityId: string | null\n    details: string | null\n    userId: string | null\n    createdAt: string\n}\n\nexport default function AuditLogsPage() {\n    const [logs, setLogs] = useState<AuditLog[]>([])\n    const [loading, setLoading] = useState(true)\n\n    async function fetchLogs() {\n        setLoading(true)\n        try {\n            const res = await fetch('/api/audit')\n            const data = await res.json()\n            // Ensure data is an array before setting\n            setLogs(Array.isArray(data) ? data : [])\n        } catch (error) {\n            console.error('Failed to fetch audit logs:', error)\n            setLogs([])\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    useEffect(() => {\n        fetchLogs()\n    }, [])\n\n    function getActionIcon(action: string) {\n        switch (action) {\n            case 'CREATE': return <PlusCircle size={16} className=\"text-green-600\" />\n            case 'UPDATE': return <Edit2 size={16} className=\"text-[#6E8C82]\" />\n            case 'DELETE': return <Trash2 size={16} className=\"text-red-600\" />\n            case 'LOGIN': return <LogIn size={16} className=\"text-purple-600\" />\n            default: return <Activity size={16} className=\"text-gray-600\" />\n        }\n    }\n\n    function getActionColor(action: string) {\n        switch (action) {\n            case 'CREATE': return 'bg-green-50 border-green-200 text-green-700'\n            case 'UPDATE': return 'bg-[#6E8C82]/10 border-[#6E8C82]/30 text-[#587068]'\n            case 'DELETE': return 'bg-red-50 border-red-200 text-red-700'\n            case 'LOGIN': return 'bg-purple-50 border-purple-200 text-purple-700'\n            default: return 'bg-gray-50 border-gray-200 text-gray-700'\n        }\n    }\n\n    return (\n        <div className=\"h-[calc(100vh-100px)] flex flex-col\">\n            <div className=\"flex justify-between items-center mb-6\">\n                <div>\n                    <h1 className=\"text-3xl font-bold text-gray-900 flex items-center gap-2\">\n                        <Activity size={32} className=\"text-[#6E8C82]\" />\n                        Audit Logs\n                    </h1>\n                    <p className=\"text-gray-600 mt-1\">\n                        Track administrative actions and changes\n                    </p>\n                </div>\n                <button\n                    onClick={fetchLogs}\n                    className=\"bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-4 py-2 rounded-lg flex items-center gap-2 transition-colors\"\n                >\n                    <RefreshCw size={18} className={loading ? 'animate-spin' : ''} />\n                    Refresh\n                </button>\n            </div>\n\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 flex flex-col overflow-hidden flex-1\">\n                <div className=\"overflow-y-auto flex-1 p-0\">\n                    <table className=\"w-full text-left border-collapse\">\n                        <thead className=\"bg-gray-50 sticky top-0 z-10 border-b border-gray-200 shadow-sm\">\n                            <tr>\n                                <th className=\"p-4 font-semibold text-gray-700 w-48\">Timestamp</th>\n                                <th className=\"p-4 font-semibold text-gray-700 w-32\">Action</th>\n                                <th className=\"p-4 font-semibold text-gray-700 w-32\">Entity</th>\n                                <th className=\"p-4 font-semibold text-gray-700 w-48\">User</th>\n                                <th className=\"p-4 font-semibold text-gray-700\">Details</th>\n                            </tr>\n                        </thead>\n                        <tbody className=\"divide-y divide-gray-100\">\n                            {loading && logs.length === 0 ? (\n                                <tr>\n                                    <td colSpan={5} className=\"text-center py-12 text-gray-500\">Loading logs...</td>\n                                </tr>\n                            ) : logs.length === 0 ? (\n                                <tr>\n                                    <td colSpan={5} className=\"text-center py-12 text-gray-500\">No audit logs found.</td>\n                                </tr>\n                            ) : (\n                                logs.map((log) => (\n                                    <tr key={log.id} className=\"hover:bg-gray-50 transition-colors\">\n                                        <td className=\"p-4 text-sm text-gray-600 font-mono whitespace-nowrap\">\n                                            {new Date(log.createdAt).toLocaleString()}\n                                        </td>\n                                        <td className=\"p-4\">\n                                            <span className={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border ${getActionColor(log.action)}`}>\n                                                {getActionIcon(log.action)}\n                                                {log.action}\n                                            </span>\n                                        </td>\n                                        <td className=\"p-4 text-sm font-medium text-gray-800\">\n                                            {log.entity}\n                                        </td>\n                                        <td className=\"p-4 text-sm text-gray-600\">\n                                            {log.userId ? (\n                                                <span className=\"flex items-center gap-1.5\">\n                                                    <User size={14} className=\"text-gray-400\" />\n                                                    <span className=\"font-mono text-xs bg-gray-100 px-1.5 py-0.5 rounded\">{log.userId.substring(0, 8)}...</span>\n                                                </span>\n                                            ) : (\n                                                <span className=\"text-gray-400 italic\">System</span>\n                                            )}\n                                        </td>\n                                        <td className=\"p-4 text-sm text-gray-600\">\n                                            {log.details && (\n                                                <code className=\"bg-gray-50 border border-gray-100 px-2 py-1 rounded text-xs font-mono block overflow-hidden text-ellipsis whitespace-nowrap max-w-md\">\n                                                    {log.details}\n                                                </code>\n                                            )}\n                                        </td>\n                                    </tr>\n                                ))\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/blog/[id]/history/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":5,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":50},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchHistory'. Either include it or remove the dependency array.","line":28,"column":8,"nodeType":"ArrayExpression","endLine":28,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchHistory]","fix":{"range":[825,827],"text":"[fetchHistory]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":63,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState, use } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { ArrowLeft, Clock, RotateCcw, CheckCircle } from 'lucide-react'\nimport { useToast } from '@/components/Toast'\nimport { useConfirm } from '@/components/ConfirmDialog'\nimport Link from 'next/link'\n\ninterface PostHistory {\n    id: string\n    title: string\n    content: string\n    createdAt: string\n    editorId: string\n}\n\nexport default function PostHistoryPage({ params }: { params: Promise<{ id: string }> }) {\n    const { id } = use(params)\n    const router = useRouter()\n    const { showToast } = useToast()\n    const { confirm } = useConfirm()\n    const [history, setHistory] = useState<PostHistory[]>([])\n    const [loading, setLoading] = useState(true)\n\n    useEffect(() => {\n        fetchHistory()\n    }, [])\n\n    async function fetchHistory() {\n        const res = await fetch(`/api/blogs/${id}/history`)\n        if (res.ok) {\n            const data = await res.json()\n            setHistory(data)\n        }\n        setLoading(false)\n    }\n\n    async function handleRestore(version: PostHistory) {\n        const confirmed = await confirm(\n            `Are you sure you want to restore this version from ${new Date(version.createdAt).toLocaleString()}? Current content will be overwritten.`,\n            'Restore Version'\n        )\n\n        if (!confirmed) return\n\n        try {\n            const res = await fetch(`/api/blogs?id=${id}`, {\n                method: 'PUT',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    title: version.title,\n                    content: version.content,\n                })\n            })\n\n            if (res.ok) {\n                showToast('Version restored successfully!', 'success')\n                router.push('/admin/blog')\n            } else {\n                throw new Error('Failed to restore')\n            }\n        } catch (error) {\n            showToast('Failed to restore version', 'error')\n        }\n    }\n\n    if (loading) {\n        return <div className=\"text-center py-12\">Loading history...</div>\n    }\n\n    return (\n        <div>\n            <div className=\"flex items-center gap-4 mb-8\">\n                <Link href=\"/admin/blog\" className=\"text-gray-500 hover:text-gray-700\">\n                    <ArrowLeft size={24} />\n                </Link>\n                <div>\n                    <h1 className=\"text-3xl font-bold text-gray-900\">Version History</h1>\n                    <p className=\"text-gray-600\">View and restore previous versions of this post</p>\n                </div>\n            </div>\n\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\n                {history.length === 0 ? (\n                    <div className=\"text-center py-12 text-gray-500\">\n                        No history available for this post.\n                    </div>\n                ) : (\n                    <div className=\"divide-y divide-gray-100\">\n                        {history.map((version) => (\n                            <div key={version.id} className=\"p-6 hover:bg-gray-50 transition-colors\">\n                                <div className=\"flex justify-between items-start\">\n                                    <div>\n                                        <div className=\"flex items-center gap-2 mb-2\">\n                                            <Clock size={16} className=\"text-gray-400\" />\n                                            <span className=\"font-medium text-gray-900\">\n                                                {new Date(version.createdAt).toLocaleString()}\n                                            </span>\n                                        </div>\n                                        <h3 className=\"text-lg font-semibold text-gray-800 mb-2\">{version.title}</h3>\n                                        <div className=\"text-sm text-gray-500 line-clamp-2 font-mono bg-gray-50 p-2 rounded\">\n                                            {version.content.replace(/<[^>]*>/g, '').substring(0, 150)}...\n                                        </div>\n                                    </div>\n                                    <button\n                                        onClick={() => handleRestore(version)}\n                                        className=\"flex items-center gap-2 px-4 py-2 text-sm font-medium text-[#6E8C82] bg-[#6E8C82]/10 hover:bg-[#6E8C82]/20 rounded-lg transition-colors\"\n                                    >\n                                        <RotateCcw size={16} />\n                                        Restore\n                                    </button>\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/blog/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used.","line":4,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EyeOff' is defined but never used.","line":4,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":146,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":146,"endColumn":23},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":239,"column":41,"nodeType":"JSXOpeningElement","endLine":239,"endColumn":121}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Plus, Trash2, Edit, X, Eye, EyeOff, Image as ImageIcon, Search, History } from 'lucide-react'\nimport { useToast } from '@/components/Toast'\nimport { useConfirm } from '@/components/ConfirmDialog'\nimport Editor from '@/components/Editor'\nimport Link from 'next/link'\n\ninterface BlogPost {\n    id: string\n    title: string\n    slug: string\n    content: string\n    excerpt: string | null\n    image: string | null\n    category: string\n    tags: string | null\n    published: boolean\n    createdAt: string\n}\n\nexport default function AdminBlogPage() {\n    const { showToast } = useToast()\n    const { confirm } = useConfirm()\n    const [posts, setPosts] = useState<BlogPost[]>([])\n    const [loading, setLoading] = useState(true)\n    const [showForm, setShowForm] = useState(false)\n    const [uploading, setUploading] = useState(false)\n    const [editingId, setEditingId] = useState<string | null>(null)\n    const [imagePreview, setImagePreview] = useState<string | null>(null)\n    const [searchTerm, setSearchTerm] = useState('')\n\n    const filteredPosts = posts.filter(post =>\n        post.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        post.category.toLowerCase().includes(searchTerm.toLowerCase())\n    )\n    const [formData, setFormData] = useState({\n        title: '',\n        content: '',\n        excerpt: '',\n        category: '',\n        tags: '',\n        published: false,\n        imageFile: null as File | null,\n        imageUrl: ''\n    })\n\n    useEffect(() => {\n        fetchPosts()\n    }, [])\n\n    async function fetchPosts() {\n        const res = await fetch('/api/blogs')\n        const data = await res.json()\n        setPosts(data)\n        setLoading(false)\n    }\n\n    function handleAdd() {\n        setFormData({ title: '', content: '', excerpt: '', category: '', tags: '', published: false, imageFile: null, imageUrl: '' })\n        setImagePreview(null)\n        setEditingId(null)\n        setShowForm(true)\n    }\n\n    function handleEdit(post: BlogPost) {\n        setFormData({\n            title: post.title,\n            content: post.content,\n            excerpt: post.excerpt || '',\n            category: post.category,\n            tags: post.tags || '',\n            published: post.published,\n            imageFile: null,\n            imageUrl: post.image || ''\n        })\n        setImagePreview(post.image || null)\n        setEditingId(post.id)\n        setShowForm(true)\n    }\n\n    function handleFileChange(e: React.ChangeEvent<HTMLInputElement>) {\n        const file = e.target.files?.[0]\n        if (file) {\n            setFormData({ ...formData, imageFile: file })\n            const reader = new FileReader()\n            reader.onloadend = () => {\n                setImagePreview(reader.result as string)\n            }\n            reader.readAsDataURL(file)\n        }\n    }\n\n    async function handleSubmit(e: React.FormEvent) {\n        e.preventDefault()\n        setUploading(true)\n\n        try {\n            let imageUrl = formData.imageUrl\n\n            // Upload new image if selected\n            if (formData.imageFile) {\n                const uploadFormData = new FormData()\n                uploadFormData.append('file', formData.imageFile)\n\n                const uploadRes = await fetch('/api/upload', {\n                    method: 'POST',\n                    body: uploadFormData\n                })\n\n                if (!uploadRes.ok) throw new Error('Upload failed')\n                const { url } = await uploadRes.json()\n                imageUrl = url\n            }\n\n            const slug = formData.title.toLowerCase().replace(/[^a-z0-9]+/g, '-')\n\n            const payload = {\n                title: formData.title,\n                content: formData.content,\n                excerpt: formData.excerpt,\n                category: formData.category,\n                tags: formData.tags,\n                published: formData.published,\n                image: imageUrl,\n                slug\n            }\n\n            const url = editingId ? `/api/blogs?id=${editingId}` : '/api/blogs'\n            const method = editingId ? 'PUT' : 'POST'\n\n            const res = await fetch(url, {\n                method,\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(payload)\n            })\n\n            if (res.ok) {\n                showToast(editingId ? 'Post updated successfully!' : 'Post created successfully!', 'success')\n                setShowForm(false)\n                fetchPosts()\n            } else {\n                throw new Error('Failed to save post')\n            }\n        } catch (error) {\n            showToast('Error saving post. Please try again.', 'error')\n        } finally {\n            setUploading(false)\n        }\n    }\n\n    async function handleDelete(id: string, title: string) {\n        const confirmed = await confirm(\n            `Are you sure you want to delete \"${title}\"? This action cannot be undone.`,\n            'Delete Post'\n        )\n\n        if (!confirmed) return\n\n        const res = await fetch(`/api/blogs?id=${id}`, {\n            method: 'DELETE'\n        })\n\n        if (res.ok) {\n            showToast('Post deleted successfully!', 'success')\n            fetchPosts()\n        } else {\n            showToast('Failed to delete post', 'error')\n        }\n    }\n\n    async function togglePublish(id: string, published: boolean) {\n        const res = await fetch(`/api/blogs?id=${id}`, {\n            method: 'PUT',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ published: !published })\n        })\n\n        if (res.ok) {\n            fetchPosts()\n        }\n    }\n\n    if (loading) {\n        return <div className=\"text-center py-12\">Loading...</div>\n    }\n\n    return (\n        <div>\n            <div className=\"flex flex-col md:flex-row justify-between items-center mb-8 gap-4\">\n                <h1 className=\"text-3xl font-bold text-gray-900\">Blog Posts</h1>\n                <div className=\"flex gap-4 w-full md:w-auto\">\n                    <div className=\"relative flex-1 md:w-64\">\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" size={20} />\n                        <input\n                            type=\"text\"\n                            placeholder=\"Search posts...\"\n                            className=\"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                    </div>\n                    <button\n                        onClick={handleAdd}\n                        className=\"bg-[#6E8C82] hover:bg-[#587068] text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors whitespace-nowrap\"\n                        disabled={uploading}\n                    >\n                        <Plus size={20} />\n                        Add Post\n                    </button>\n                </div>\n            </div>\n\n            {showForm && (\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8\">\n                    <div className=\"flex justify-between items-center mb-4\">\n                        <h2 className=\"text-xl font-bold\">{editingId ? 'Edit' : 'Create'} Post</h2>\n                        <button onClick={() => setShowForm(false)} className=\"text-gray-500 hover:text-gray-700\">\n                            <X size={24} />\n                        </button>\n                    </div>\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Title</label>\n                            <input\n                                type=\"text\"\n                                required\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                value={formData.title}\n                                onChange={e => setFormData({ ...formData, title: e.target.value })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Featured Image</label>\n                            <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-[#6E8C82] transition-colors\">\n                                {imagePreview ? (\n                                    <div className=\"space-y-3\">\n                                        <img src={imagePreview} alt=\"Preview\" className=\"max-h-48 mx-auto rounded-lg\" />\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => {\n                                                setImagePreview(null)\n                                                setFormData({ ...formData, imageFile: null, imageUrl: '' })\n                                            }}\n                                            className=\"text-red-600 hover:text-red-800 text-sm\"\n                                        >\n                                            Remove Image\n                                        </button>\n                                    </div>\n                                ) : (\n                                    <div>\n                                        <ImageIcon size={36} className=\"mx-auto text-gray-400 mb-2\" />\n                                        <label className=\"cursor-pointer\">\n                                            <span className=\"text-[#6E8C82] hover:underline font-medium\">Click to upload image</span>\n                                            <input\n                                                type=\"file\"\n                                                accept=\"image/*\"\n                                                className=\"hidden\"\n                                                onChange={handleFileChange}\n                                            />\n                                        </label>\n                                        <p className=\"text-xs text-gray-500 mt-1\">PNG, JPG up to 10MB</p>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Category</label>\n                            <input\n                                type=\"text\"\n                                required\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                placeholder=\"News, Stories, Updates\"\n                                value={formData.category}\n                                onChange={e => setFormData({ ...formData, category: e.target.value })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Excerpt (Summary)</label>\n                            <textarea\n                                rows={2}\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                value={formData.excerpt}\n                                onChange={e => setFormData({ ...formData, excerpt: e.target.value })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Content</label>\n                            <Editor\n                                value={formData.content}\n                                onChange={(content) => setFormData({ ...formData, content })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Tags (comma-separated)</label>\n                            <input\n                                type=\"text\"\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                placeholder=\"nutrition, health, community\"\n                                value={formData.tags}\n                                onChange={e => setFormData({ ...formData, tags: e.target.value })}\n                            />\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                            <input\n                                type=\"checkbox\"\n                                id=\"published\"\n                                className=\"w-4 h-4 text-[#6E8C82] rounded focus:ring-[#6E8C82]\"\n                                checked={formData.published}\n                                onChange={e => setFormData({ ...formData, published: e.target.checked })}\n                            />\n                            <label htmlFor=\"published\" className=\"text-sm font-medium text-gray-700\">Publish immediately</label>\n                        </div>\n                        <div className=\"flex gap-3\">\n                            <button\n                                type=\"submit\"\n                                className=\"bg-[#2E8B57] text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 disabled:opacity-50\"\n                                disabled={uploading}\n                            >\n                                {uploading ? (\n                                    <>\n                                        <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent\"></div>\n                                        Uploading...\n                                    </>\n                                ) : (\n                                    <>{editingId ? 'Update' : 'Create'} Post</>\n                                )}\n                            </button>\n                            <button type=\"button\" onClick={() => setShowForm(false)} className=\"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors\">\n                                Cancel\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            )}\n\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\n                <table className=\"w-full\">\n                    <thead className=\"bg-gray-50 border-b border-gray-200\">\n                        <tr>\n                            <th className=\"text-left p-4 font-semibold text-gray-700\">Title</th>\n                            <th className=\"text-left p-4 font-semibold text-gray-700\">Category</th>\n                            <th className=\"text-left p-4 font-semibold text-gray-700\">Status</th>\n                            <th className=\"text-left p-4 font-semibold text-gray-700\">Date</th>\n                            <th className=\"text-left p-4 font-semibold text-gray-700\">Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {filteredPosts.map((post) => (\n                            <tr key={post.id} className=\"border-b border-gray-100 last:border-0\">\n                                <td className=\"p-4 font-medium text-gray-900\">{post.title}</td>\n                                <td className=\"p-4 text-gray-600\">{post.category}</td>\n                                <td className=\"p-4\">\n                                    <button\n                                        onClick={() => togglePublish(post.id, post.published)}\n                                        className={`px-3 py-1 rounded-full text-xs font-semibold ${post.published ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-600'\n                                            }`}\n                                    >\n                                        {post.published ? 'Published' : 'Draft'}\n                                    </button>\n                                </td>\n                                <td className=\"p-4 text-gray-600\">\n                                    {new Date(post.createdAt).toLocaleDateString()}\n                                </td>\n                                <td className=\"p-4\">\n                                    <div className=\"flex gap-2\">\n                                        <button\n                                            onClick={() => handleEdit(post)}\n                                            className=\"text-[#6E8C82] hover:text-[#587068] p-2\"\n                                            title=\"Edit\"\n                                        >\n                                            <Edit size={18} />\n                                        </button>\n                                        <button\n                                            onClick={() => handleDelete(post.id, post.title)}\n                                            className=\"text-red-600 hover:text-red-800 p-2\"\n                                            title=\"Delete\"\n                                        >\n                                            <Trash2 size={18} />\n                                        </button>\n                                        <Link\n                                            href={`/admin/blog/${post.id}/history`}\n                                            className=\"text-gray-600 hover:text-gray-800 p-2\"\n                                            title=\"History\"\n                                        >\n                                            <History size={18} />\n                                        </Link>\n                                    </div>\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n                {posts.length === 0 && (\n                    <div className=\"text-center py-12 text-gray-500\">\n                        No blog posts yet. Create your first post!\n                    </div>\n                )}\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/contact/page.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchSubmissions` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/home/evans/Projects/NRDC/app/admin/contact/page.tsx:24:9\n  22 |\n  23 |     useEffect(() => {\n> 24 |         fetchSubmissions()\n     |         ^^^^^^^^^^^^^^^^ `fetchSubmissions` accessed before it is declared\n  25 |     }, [])\n  26 |\n  27 |     async function fetchSubmissions() {\n\n/home/evans/Projects/NRDC/app/admin/contact/page.tsx:27:5\n  25 |     }, [])\n  26 |\n> 27 |     async function fetchSubmissions() {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 28 |         const res = await fetch('/api/contact')\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 29 |         const data = await res.json()\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 30 |         setSubmissions(data)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 31 |         setLoading(false)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 32 |     }\n     | ^^^^^^ `fetchSubmissions` is declared here\n  33 |\n  34 |     function exportToCSV() {\n  35 |         const headers = ['Name', 'Email', 'Message', 'Status', 'Date']","line":24,"column":9,"nodeType":null,"endLine":24,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Download, Mail, X, Eye, Copy, Check } from 'lucide-react'\nimport { useToast } from '@/components/Toast'\n\ninterface ContactSubmission {\n    id: string\n    name: string\n    email: string\n    message: string\n    status: string\n    createdAt: string\n}\n\nexport default function AdminContactPage() {\n    const { showToast } = useToast()\n    const [submissions, setSubmissions] = useState<ContactSubmission[]>([])\n    const [loading, setLoading] = useState(true)\n    const [selectedMessage, setSelectedMessage] = useState<ContactSubmission | null>(null)\n    const [copied, setCopied] = useState(false)\n\n    useEffect(() => {\n        fetchSubmissions()\n    }, [])\n\n    async function fetchSubmissions() {\n        const res = await fetch('/api/contact')\n        const data = await res.json()\n        setSubmissions(data)\n        setLoading(false)\n    }\n\n    function exportToCSV() {\n        const headers = ['Name', 'Email', 'Message', 'Status', 'Date']\n        const rows = submissions.map(sub => [\n            sub.name,\n            sub.email,\n            sub.message.replace(/\"/g, '\"\"'), // Escape quotes\n            sub.status,\n            new Date(sub.createdAt).toLocaleString()\n        ])\n\n        const csvContent = [\n            headers.join(','),\n            ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\n        ].join('\\n')\n\n        const blob = new Blob([csvContent], { type: 'text/csv' })\n        const url = URL.createObjectURL(blob)\n        const a = document.createElement('a')\n        a.href = url\n        a.download = `contact-submissions-${new Date().toISOString().split('T')[0]}.csv`\n        a.click()\n        a.click()\n        URL.revokeObjectURL(url)\n        showToast('Export started successfully!', 'success')\n    }\n\n    const handleCopyEmail = () => {\n        if (selectedMessage) {\n            navigator.clipboard.writeText(selectedMessage.email)\n            setCopied(true)\n            showToast('Email copied to clipboard', 'success')\n            setTimeout(() => setCopied(false), 2000)\n        }\n    }\n\n    if (loading) {\n        return <div className=\"text-center py-12\">Loading...</div>\n    }\n\n    return (\n        <div>\n            <div className=\"flex justify-between items-center mb-8\">\n                <h1 className=\"text-3xl font-bold text-gray-900\">Contact Messages</h1>\n                <button\n                    onClick={exportToCSV}\n                    className=\"bg-[#2E8B57] hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors\"\n                >\n                    <Download size={20} />\n                    Export to CSV\n                </button>\n            </div>\n\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\n                <div className=\"max-h-[600px] overflow-y-auto\">\n                    <table className=\"w-full\">\n                        <thead className=\"bg-gray-50 border-b border-gray-200 sticky top-0\">\n                            <tr>\n                                <th className=\"text-left p-4 font-semibold text-gray-700\">Name</th>\n                                <th className=\"text-left p-4 font-semibold text-gray-700\">Email</th>\n                                <th className=\"text-left p-4 font-semibold text-gray-700\">Message</th>\n                                <th className=\"text-left p-4 font-semibold text-gray-700\">Date</th>\n                                <th className=\"text-left p-4 font-semibold text-gray-700\">Actions</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {submissions.map((submission) => (\n                                <tr key={submission.id} className=\"border-b border-gray-100 last:border-0 hover:bg-gray-50\">\n                                    <td className=\"p-4 font-medium text-gray-900\">{submission.name}</td>\n                                    <td className=\"p-4 text-gray-600\">\n                                        <a href={`mailto:${submission.email}`} className=\"text-[#6E8C82] hover:underline flex items-center gap-1\">\n                                            <Mail size={16} />\n                                            {submission.email}\n                                        </a>\n                                    </td>\n                                    <td className=\"p-4 text-gray-700 max-w-md\">\n                                        <p className=\"line-clamp-2\">{submission.message}</p>\n                                    </td>\n                                    <td className=\"p-4 text-gray-600 text-sm whitespace-nowrap\">\n                                        {new Date(submission.createdAt).toLocaleDateString()}\n                                    </td>\n                                    <td className=\"p-4\">\n                                        <button\n                                            onClick={() => setSelectedMessage(submission)}\n                                            className=\"text-[#6E8C82] hover:text-[#587068] flex items-center gap-1 text-sm font-medium transition-colors\"\n                                        >\n                                            <Eye size={16} />\n                                            View Full\n                                        </button>\n                                    </td>\n                                </tr>\n                            ))}\n                        </tbody>\n                    </table>\n                </div>\n                {submissions.length === 0 && (\n                    <div className=\"text-center py-12 text-gray-500\">\n                        No contact submissions yet.\n                    </div>\n                )}\n            </div>\n\n            {/* Message Detail Modal */}\n            {selectedMessage && (\n                <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4\" onClick={() => setSelectedMessage(null)}>\n                    <div className=\"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto\" onClick={(e) => e.stopPropagation()}>\n                        <div className=\"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-start\">\n                            <div>\n                                <h2 className=\"text-2xl font-bold text-gray-900\">Message Details</h2>\n                                <p className=\"text-sm text-gray-500 mt-1\">\n                                    {new Date(selectedMessage.createdAt).toLocaleDateString('en-US', {\n                                        year: 'numeric',\n                                        month: 'long',\n                                        day: 'numeric',\n                                        hour: '2-digit',\n                                        minute: '2-digit'\n                                    })}\n                                </p>\n                            </div>\n                            <button\n                                onClick={() => setSelectedMessage(null)}\n                                className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n                            >\n                                <X size={24} />\n                            </button>\n                        </div>\n\n                        <div className=\"p-6 space-y-4\">\n                            <div>\n                                <label className=\"text-sm font-semibold text-gray-700 block mb-1\">From:</label>\n                                <p className=\"text-gray-900 font-medium\">{selectedMessage.name}</p>\n                            </div>\n\n                            <div>\n                                <label className=\"text-sm font-semibold text-gray-700 block mb-1\">Email:</label>\n                                <a\n                                    href={`mailto:${selectedMessage.email}`}\n                                    className=\"text-[#6E8C82] hover:underline flex items-center gap-2\"\n                                >\n                                    <Mail size={18} />\n                                    {selectedMessage.email}\n                                </a>\n                            </div>\n\n                            <div>\n                                <label className=\"text-sm font-semibold text-gray-700 block mb-2\">Message:</label>\n                                <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\n                                    <p className=\"text-gray-800 whitespace-pre-wrap leading-relaxed\">\n                                        {selectedMessage.message}\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div className=\"sticky bottom-0 bg-gray-50 border-t border-gray-200 p-6 flex gap-3\">\n                            <button\n                                onClick={handleCopyEmail}\n                                className=\"flex-1 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors\"\n                            >\n                                {copied ? <Check size={20} className=\"text-green-600\" /> : <Copy size={20} />}\n                                {copied ? 'Copied!' : 'Copy Email'}\n                            </button>\n                            <a\n                                href={`mailto:${selectedMessage.email}?subject=Re: Contact Form Submission`}\n                                className=\"flex-1 bg-[#6E8C82] hover:bg-[#587068] text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors\"\n                            >\n                                <Mail size={20} />\n                                Reply via Email\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/content/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/dashboard/page.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchAnalytics` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/home/evans/Projects/NRDC/app/admin/dashboard/page.tsx:31:9\n  29 |\n  30 |     useEffect(() => {\n> 31 |         fetchAnalytics()\n     |         ^^^^^^^^^^^^^^ `fetchAnalytics` accessed before it is declared\n  32 |     }, [])\n  33 |\n  34 |     async function fetchAnalytics() {\n\n/home/evans/Projects/NRDC/app/admin/dashboard/page.tsx:34:5\n  32 |     }, [])\n  33 |\n> 34 |     async function fetchAnalytics() {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 35 |         const res = await fetch('/api/analytics')\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 36 |         if (res.ok) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 37 |             const data = await res.json()\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 38 |             setAnalytics(data)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 39 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |         setLoading(false)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |     }\n     | ^^^^^^ `fetchAnalytics` is declared here\n  42 |\n  43 |     if (loading) {\n  44 |         return <div className=\"text-center py-12\">Loading analytics...</div>","line":31,"column":9,"nodeType":null,"endLine":31,"endColumn":23},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Link' is not defined.","line":158,"column":22,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":158,"endColumn":26},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Link' is not defined.","line":162,"column":22,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":162,"endColumn":26},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Link' is not defined.","line":166,"column":22,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":166,"endColumn":26},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Link' is not defined.","line":170,"column":22,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":170,"endColumn":26},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":171,"column":25,"nodeType":"JSXOpeningElement","endLine":171,"endColumn":69}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, PieChart, Pie, Cell, Legend } from 'recharts'\nimport { FileText, BookOpen, Image, Mail, TrendingUp, Activity, Users, Sparkles } from 'lucide-react'\n\ninterface Analytics {\n    stats: {\n        totalBlogs: number\n        publishedBlogs: number\n        totalPrograms: number\n        totalTeamMembers: number\n        totalGalleryImages: number\n        totalResources: number\n        totalTestimonials: number\n        approvedTestimonials: number\n        totalContacts: number\n        newContacts: number\n    }\n    activityData: Array<{ date: string; count: number }>\n    topCategories: Array<{ name: string; value: number }>\n}\n\nconst COLORS = ['#6E8C82', '#2E8B57', '#FF8042', '#FFBB28', '#00C49F']\n\nexport default function AdminDashboardPage() {\n    const [analytics, setAnalytics] = useState<Analytics | null>(null)\n    const [loading, setLoading] = useState(true)\n\n    useEffect(() => {\n        fetchAnalytics()\n    }, [])\n\n    async function fetchAnalytics() {\n        const res = await fetch('/api/analytics')\n        if (res.ok) {\n            const data = await res.json()\n            setAnalytics(data)\n        }\n        setLoading(false)\n    }\n\n    if (loading) {\n        return <div className=\"text-center py-12\">Loading analytics...</div>\n    }\n\n    if (!analytics) {\n        return <div className=\"text-center py-12 text-red-600\">Failed to load analytics</div>\n    }\n\n    const statCards = [\n        { label: 'Blog Posts', value: `${analytics.stats.publishedBlogs}/${analytics.stats.totalBlogs}`, subtext: 'Published', icon: BookOpen, color: 'bg-purple-500' },\n        { label: 'Programs', value: analytics.stats.totalPrograms, subtext: 'Active', icon: FileText, color: 'bg-[#6E8C82]/100' },\n        { label: 'Gallery', value: analytics.stats.totalGalleryImages, subtext: 'Images', icon: Image, color: 'bg-green-500' },\n        { label: 'Team', value: analytics.stats.totalTeamMembers, subtext: 'Members', icon: Users, color: 'bg-orange-500' },\n        { label: 'Testimonials', value: `${analytics.stats.approvedTestimonials}/${analytics.stats.totalTestimonials}`, subtext: 'Approved', icon: Sparkles, color: 'bg-pink-500' },\n        { label: 'Contacts', value: analytics.stats.newContacts, subtext: `${analytics.stats.totalContacts} Total`, icon: Mail, color: 'bg-red-500' },\n    ]\n\n    return (\n        <div className=\"space-y-8\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between\">\n                <div>\n                    <h1 className=\"text-3xl font-bold text-gray-900\">Dashboard</h1>\n                    <p className=\"text-gray-600 mt-1\">Welcome back! Here&apos;s your NRDC overview</p>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm text-gray-500\">\n                    <Activity size={16} className=\"text-green-600\" />\n                    <span>Analytics</span>\n                </div>\n            </div>\n\n            {/* Stats Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {statCards.map((stat) => (\n                    <div key={stat.label} className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow\">\n                        <div className=\"flex items-center justify-between\">\n                            <div>\n                                <p className=\"text-sm font-medium text-gray-600\">{stat.label}</p>\n                                <p className=\"text-3xl font-bold text-gray-900 mt-2\">{stat.value}</p>\n                                <p className=\"text-xs text-gray-500 mt-1\">{stat.subtext}</p>\n                            </div>\n                            <div className={`${stat.color} p-3 rounded-lg`}>\n                                <stat.icon size={24} className=\"text-white\" />\n                            </div>\n                        </div>\n                    </div>\n                ))}\n            </div>\n\n            {/* Charts Grid */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Activity Chart */}\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\n                    <div className=\"flex items-center gap-2 mb-6\">\n                        <TrendingUp size={20} className=\"text-[#6E8C82]\" />\n                        <h2 className=\"text-xl font-bold text-gray-900\">Content Activity (Last 7 Days)</h2>\n                    </div>\n                    {analytics.activityData.length > 0 ? (\n                        <ResponsiveContainer width=\"100%\" height={300}>\n                            <BarChart data={analytics.activityData}>\n                                <CartesianGrid strokeDasharray=\"3 3\" />\n                                <XAxis\n                                    dataKey=\"date\"\n                                    tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                                />\n                                <YAxis />\n                                <Tooltip\n                                    labelFormatter={(value) => new Date(value).toLocaleDateString()}\n                                    formatter={(value) => [`${value} posts`, 'Count']}\n                                />\n                                <Bar dataKey=\"count\" fill=\"#6E8C82\" radius={[8, 8, 0, 0]} />\n                            </BarChart>\n                        </ResponsiveContainer>\n                    ) : (\n                        <div className=\"text-center py-12 text-gray-500\">No activity data yet</div>\n                    )}\n                </div>\n\n                {/* Top Categories Pie Chart */}\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\n                    <div className=\"flex items-center gap-2 mb-6\">\n                        <BookOpen size={20} className=\"text-[#2E8B57]\" />\n                        <h2 className=\"text-xl font-bold text-gray-900\">Top Blog Categories</h2>\n                    </div>\n                    {analytics.topCategories.length > 0 ? (\n                        <ResponsiveContainer width=\"100%\" height={300}>\n                            <PieChart>\n                                <Pie\n                                    data={analytics.topCategories}\n                                    cx=\"50%\"\n                                    cy=\"50%\"\n                                    labelLine={false}\n                                    label={({ name, percent }: { name?: string, percent?: number }) => `${name || 'Unknown'} (${((percent || 0) * 100).toFixed(0)}%)`}\n                                    outerRadius={80}\n                                    fill=\"#8884d8\"\n                                    dataKey=\"value\"\n                                >\n                                    {analytics.topCategories.map((entry, index) => (\n                                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                                    ))}\n                                </Pie>\n                                <Tooltip />\n                                <Legend />\n                            </PieChart>\n                        </ResponsiveContainer>\n                    ) : (\n                        <div className=\"text-center py-12 text-gray-500\">No category data yet</div>\n                    )}\n                </div>\n            </div>\n\n            {/* Quick Actions */}\n            <div className=\"bg-gradient-to-r from-[#6E8C82] to-[#2E8B57] rounded-xl shadow-sm p-6 text-white\">\n                <h2 className=\"text-xl font-bold mb-4\">Quick Actions</h2>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                    <Link href=\"/admin/blog\" className=\"bg-white/10 hover:bg-white/20 rounded-lg p-4 text-center transition-colors backdrop-blur-sm\">\n                        <BookOpen size={32} className=\"mx-auto mb-2\" />\n                        <p className=\"text-sm font-medium\">New Blog Post</p>\n                    </Link>\n                    <Link href=\"/admin/programs\" className=\"bg-white/10 hover:bg-white/20 rounded-lg p-4 text-center transition-colors backdrop-blur-sm\">\n                        <FileText size={32} className=\"mx-auto mb-2\" />\n                        <p className=\"text-sm font-medium\">Add Program</p>\n                    </Link>\n                    <Link href=\"/admin/contact\" className=\"bg-white/10 hover:bg-white/20 rounded-lg p-4 text-center transition-colors backdrop-blur-sm\">\n                        <Mail size={32} className=\"mx-auto mb-2\" />\n                        <p className=\"text-sm font-medium\">View Messages</p>\n                    </Link>\n                    <Link href=\"/admin/gallery\" className=\"bg-white/10 hover:bg-white/20 rounded-lg p-4 text-center transition-colors backdrop-blur-sm\">\n                        <Image size={32} className=\"mx-auto mb-2\" />\n                        <p className=\"text-sm font-medium\">Upload Image</p>\n                    </Link>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/donations/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Save' is defined but never used.","line":4,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":4,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":37},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":4,"column":78,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":86},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":63,"column":8,"nodeType":"ArrayExpression","endLine":63,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchData]","fix":{"range":[2065,2067],"text":"[fetchData]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState, useCallback } from 'react'\nimport { Plus, Trash2, Edit, Save, X, DollarSign, BarChart, Receipt, Filter, Download } from 'lucide-react'\nimport { useToast } from '@/components/Toast'\nimport { useConfirm } from '@/components/ConfirmDialog'\n\ninterface DonationTier {\n    id: string\n    amount: number\n    description: string\n    isPopular: boolean\n    order: number\n}\n\ninterface DonationStat {\n    id: string\n    value: string\n    label: string\n    order: number\n}\n\ninterface DonationRecord {\n    id: string\n    amount: number\n    currency: string\n    donorName: string | null\n    donorEmail: string\n    donorPhone: string | null\n    paymentMethod: string\n    paymentStatus: string\n    reference: string | null\n    createdAt: string\n    updatedAt: string\n}\n\nexport default function AdminDonationsPage() {\n    const { showToast } = useToast()\n    const { confirm } = useConfirm()\n    const [tiers, setTiers] = useState<DonationTier[]>([])\n    const [stats, setStats] = useState<DonationStat[]>([])\n    const [loading, setLoading] = useState(true)\n    const [activeTab, setActiveTab] = useState<'tiers' | 'stats' | 'history'>('tiers')\n\n    // Donation records state\n    const [donations, setDonations] = useState<DonationRecord[]>([])\n    const [donationsTotal, setDonationsTotal] = useState(0)\n    const [donationsLoading, setDonationsLoading] = useState(false)\n    const [statusFilter, setStatusFilter] = useState<string>('')\n    const [methodFilter, setMethodFilter] = useState<string>('')\n\n    // Form states\n    const [showTierForm, setShowTierForm] = useState(false)\n    const [tierForm, setTierForm] = useState({ amount: '', description: '', isPopular: false, order: 0 })\n    const [editingTier, setEditingTier] = useState<DonationTier | null>(null)\n\n    const [showStatForm, setShowStatForm] = useState(false)\n    const [statForm, setStatForm] = useState({ value: '', label: '', order: 0 })\n    const [editingStat, setEditingStat] = useState<DonationStat | null>(null)\n\n    useEffect(() => {\n        fetchData()\n    }, [])\n\n    async function fetchData() {\n        try {\n            const [tiersRes, statsRes] = await Promise.all([\n                fetch('/api/donations/tiers'),\n                fetch('/api/donations/stats')\n            ])\n\n            if (tiersRes.ok) setTiers(await tiersRes.json())\n            if (statsRes.ok) setStats(await statsRes.json())\n        } catch (error) {\n            console.error('Error fetching data:', error)\n            showToast('Failed to load data', 'error')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    // Tier Handlers\n    async function handleTierSubmit(e: React.FormEvent) {\n        e.preventDefault()\n        const url = '/api/donations/tiers'\n        const method = editingTier ? 'PUT' : 'POST'\n        const body = editingTier ? { ...tierForm, id: editingTier.id } : tierForm\n\n        const res = await fetch(url, {\n            method,\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(body)\n        })\n\n        if (res.ok) {\n            showToast(`Donation tier ${editingTier ? 'updated' : 'created'} successfully`, 'success')\n            setShowTierForm(false)\n            setEditingTier(null)\n            setTierForm({ amount: '', description: '', isPopular: false, order: 0 })\n            fetchData()\n        } else {\n            showToast('Failed to save donation tier', 'error')\n        }\n    }\n\n    async function deleteTier(id: string) {\n        if (!await confirm('Are you sure you want to delete this donation tier?', 'Delete Tier')) return\n\n        const res = await fetch(`/api/donations/tiers?id=${id}`, { method: 'DELETE' })\n        if (res.ok) {\n            showToast('Donation tier deleted', 'success')\n            fetchData()\n        } else {\n            showToast('Failed to delete tier', 'error')\n        }\n    }\n\n    // Stat Handlers\n    async function handleStatSubmit(e: React.FormEvent) {\n        e.preventDefault()\n        const url = '/api/donations/stats'\n        const method = editingStat ? 'PUT' : 'POST'\n        const body = editingStat ? { ...statForm, id: editingStat.id } : statForm\n\n        const res = await fetch(url, {\n            method,\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(body)\n        })\n\n        if (res.ok) {\n            showToast(`Statistic ${editingStat ? 'updated' : 'created'} successfully`, 'success')\n            setShowStatForm(false)\n            setEditingStat(null)\n            setStatForm({ value: '', label: '', order: 0 })\n            fetchData()\n        } else {\n            showToast('Failed to save statistic', 'error')\n        }\n    }\n\n    async function deleteStat(id: string) {\n        if (!await confirm('Are you sure you want to delete this statistic?', 'Delete Statistic')) return\n\n        const res = await fetch(`/api/donations/stats?id=${id}`, { method: 'DELETE' })\n        if (res.ok) {\n            showToast('Statistic deleted', 'success')\n            fetchData()\n        } else {\n            showToast('Failed to delete statistic', 'error')\n        }\n    }\n\n    function startEditTier(tier: DonationTier) {\n        setEditingTier(tier)\n        setTierForm({\n            amount: tier.amount.toString(),\n            description: tier.description,\n            isPopular: tier.isPopular,\n            order: tier.order\n        })\n        setShowTierForm(true)\n    }\n\n    function startEditStat(stat: DonationStat) {\n        setEditingStat(stat)\n        setStatForm({\n            value: stat.value,\n            label: stat.label,\n            order: stat.order\n        })\n        setShowStatForm(true)\n    }\n\n    // Fetch donation records\n    const fetchDonations = useCallback(async () => {\n        setDonationsLoading(true)\n        try {\n            const params = new URLSearchParams()\n            if (statusFilter) params.append('status', statusFilter)\n            if (methodFilter) params.append('method', methodFilter)\n\n            const res = await fetch(`/api/donations/records?${params.toString()}`)\n            if (res.ok) {\n                const data = await res.json()\n                setDonations(data.donations)\n                setDonationsTotal(data.total)\n            } else {\n                showToast('Failed to load donations', 'error')\n            }\n        } catch (error) {\n            console.error('Error fetching donations:', error)\n            showToast('Failed to load donations', 'error')\n        } finally {\n            setDonationsLoading(false)\n        }\n    }, [statusFilter, methodFilter, showToast])\n\n    // Update donation status\n    async function updateDonationStatus(id: string, status: string) {\n        if (!await confirm(`Are you sure you want to mark this donation as \"${status}\"?`)) return\n\n        try {\n            const res = await fetch('/api/donations/records', {\n                method: 'PATCH',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ id, status })\n            })\n\n            if (res.ok) {\n                showToast('Donation status updated', 'success')\n                fetchDonations()\n            } else {\n                showToast('Failed to update status', 'error')\n            }\n        } catch (error) {\n            console.error('Error updating donation:', error)\n            showToast('Failed to update status', 'error')\n        }\n    }\n\n    // Load donations when history tab is active or filters change\n    useEffect(() => {\n        if (activeTab === 'history') {\n            fetchDonations()\n        }\n    }, [activeTab, fetchDonations])\n\n    // Format currency\n    function formatCurrency(amount: number, currency: string) {\n        return new Intl.NumberFormat('en-KE', {\n            style: 'currency',\n            currency: currency || 'KES'\n        }).format(amount)\n    }\n\n    // Format date\n    function formatDate(date: string) {\n        return new Date(date).toLocaleDateString('en-US', {\n            year: 'numeric',\n            month: 'short',\n            day: 'numeric',\n            hour: '2-digit',\n            minute: '2-digit'\n        })\n    }\n\n    // Get status badge color\n    function getStatusColor(status: string) {\n        switch (status) {\n            case 'completed': return 'bg-green-100 text-green-800'\n            case 'pending': return 'bg-yellow-100 text-yellow-800'\n            case 'failed': return 'bg-red-100 text-red-800'\n            case 'refunded': return 'bg-gray-100 text-gray-800'\n            default: return 'bg-gray-100 text-gray-800'\n        }\n    }\n\n    if (loading) return <div className=\"p-8 text-center\">Loading...</div>\n\n    return (\n        <div>\n            <div className=\"mb-8\">\n                <h1 className=\"text-3xl font-bold text-gray-900\">Donation Management</h1>\n                <p className=\"text-gray-600 mt-1\">Manage donation tiers and impact statistics</p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"flex gap-4 mb-8 border-b border-gray-200\">\n                <button\n                    onClick={() => setActiveTab('tiers')}\n                    className={`pb-4 px-4 font-medium flex items-center gap-2 transition-colors ${activeTab === 'tiers'\n                        ? 'border-b-2 border-[#6E8C82] text-[#6E8C82]'\n                        : 'text-gray-500 hover:text-gray-700'\n                        }`}\n                >\n                    <DollarSign size={20} />\n                    Donation Tiers\n                </button>\n                <button\n                    onClick={() => setActiveTab('stats')}\n                    className={`pb-4 px-4 font-medium flex items-center gap-2 transition-colors ${activeTab === 'stats'\n                        ? 'border-b-2 border-[#6E8C82] text-[#6E8C82]'\n                        : 'text-gray-500 hover:text-gray-700'\n                        }`}\n                >\n                    <BarChart size={20} />\n                    Impact Statistics\n                </button>\n                <button\n                    onClick={() => setActiveTab('history')}\n                    className={`pb-4 px-4 font-medium flex items-center gap-2 transition-colors ${activeTab === 'history'\n                        ? 'border-b-2 border-[#6E8C82] text-[#6E8C82]'\n                        : 'text-gray-500 hover:text-gray-700'\n                        }`}\n                >\n                    <Receipt size={20} />\n                    Transaction History\n                </button>\n            </div>\n\n            {activeTab === 'tiers' ? (\n                <div>\n                    <div className=\"flex justify-end mb-6\">\n                        <button\n                            onClick={() => {\n                                setEditingTier(null)\n                                setTierForm({ amount: '', description: '', isPopular: false, order: 0 })\n                                setShowTierForm(true)\n                            }}\n                            className=\"bg-[#6E8C82] hover:bg-[#587068] text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors\"\n                        >\n                            <Plus size={20} />\n                            Add Tier\n                        </button>\n                    </div>\n\n                    {showTierForm && (\n                        <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-8 max-w-2xl\">\n                            <h3 className=\"text-xl font-bold mb-4\">{editingTier ? 'Edit Tier' : 'New Donation Tier'}</h3>\n                            <form onSubmit={handleTierSubmit} className=\"space-y-4\">\n                                <div className=\"grid grid-cols-2 gap-4\">\n                                    <div>\n                                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Amount (KES)</label>\n                                        <input\n                                            type=\"number\"\n                                            required\n                                            className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                            value={tierForm.amount}\n                                            onChange={e => setTierForm({ ...tierForm, amount: e.target.value })}\n                                        />\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Order</label>\n                                        <input\n                                            type=\"number\"\n                                            required\n                                            className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                            value={tierForm.order}\n                                            onChange={e => setTierForm({ ...tierForm, order: parseInt(e.target.value) || 0 })}\n                                        />\n                                    </div>\n                                </div>\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Description</label>\n                                    <input\n                                        type=\"text\"\n                                        required\n                                        className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                        value={tierForm.description}\n                                        onChange={e => setTierForm({ ...tierForm, description: e.target.value })}\n                                    />\n                                </div>\n                                <div className=\"flex items-center gap-2\">\n                                    <input\n                                        type=\"checkbox\"\n                                        id=\"isPopular\"\n                                        className=\"w-4 h-4 text-[#6E8C82] rounded focus:ring-[#6E8C82]\"\n                                        checked={tierForm.isPopular}\n                                        onChange={e => setTierForm({ ...tierForm, isPopular: e.target.checked })}\n                                    />\n                                    <label htmlFor=\"isPopular\" className=\"text-sm font-medium text-gray-700\">Mark as Most Popular</label>\n                                </div>\n                                <div className=\"flex justify-end gap-3 pt-4\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => setShowTierForm(false)}\n                                        className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\"\n                                    >\n                                        Cancel\n                                    </button>\n                                    <button\n                                        type=\"submit\"\n                                        className=\"bg-[#6E8C82] text-white px-6 py-2 rounded-lg hover:bg-[#587068] transition-colors\"\n                                    >\n                                        {editingTier ? 'Update Tier' : 'Create Tier'}\n                                    </button>\n                                </div>\n                            </form>\n                        </div>\n                    )}\n\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                        {tiers.map(tier => (\n                            <div key={tier.id} className={`bg-white p-6 rounded-xl shadow-sm border-2 relative ${tier.isPopular ? 'border-[#2E8B57]' : 'border-gray-100'}`}>\n                                {tier.isPopular && (\n                                    <div className=\"absolute -top-3 left-1/2 -translate-x-1/2 bg-[#2E8B57] text-white px-3 py-1 rounded-full text-xs font-semibold\">\n                                        Popular\n                                    </div>\n                                )}\n                                <div className=\"flex justify-between items-start mb-4\">\n                                    <div className=\"text-3xl font-bold text-[#6E8C82]\">KES {tier.amount}</div>\n                                    <div className=\"flex gap-2\">\n                                        <button onClick={() => startEditTier(tier)} className=\"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors\">\n                                            <Edit size={18} />\n                                        </button>\n                                        <button onClick={() => deleteTier(tier.id)} className=\"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors\">\n                                            <Trash2 size={18} />\n                                        </button>\n                                    </div>\n                                </div>\n                                <p className=\"text-gray-600 text-sm\">{tier.description}</p>\n                                <div className=\"mt-4 text-xs text-gray-400\">Order: {tier.order}</div>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n            ) : activeTab === 'stats' ? (\n                <div>\n                    <div className=\"flex justify-end mb-6\">\n                        <button\n                            onClick={() => {\n                                setEditingStat(null)\n                                setStatForm({ value: '', label: '', order: 0 })\n                                setShowStatForm(true)\n                            }}\n                            className=\"bg-[#6E8C82] hover:bg-[#587068] text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors\"\n                        >\n                            <Plus size={20} />\n                            Add Statistic\n                        </button>\n                    </div>\n\n                    {showStatForm && (\n                        <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-8 max-w-2xl\">\n                            <h3 className=\"text-xl font-bold mb-4\">{editingStat ? 'Edit Statistic' : 'New Statistic'}</h3>\n                            <form onSubmit={handleStatSubmit} className=\"space-y-4\">\n                                <div className=\"grid grid-cols-2 gap-4\">\n                                    <div>\n                                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Value (e.g. 95%)</label>\n                                        <input\n                                            type=\"text\"\n                                            required\n                                            className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                            value={statForm.value}\n                                            onChange={e => setStatForm({ ...statForm, value: e.target.value })}\n                                        />\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Order</label>\n                                        <input\n                                            type=\"number\"\n                                            required\n                                            className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                            value={statForm.order}\n                                            onChange={e => setStatForm({ ...statForm, order: parseInt(e.target.value) || 0 })}\n                                        />\n                                    </div>\n                                </div>\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Label</label>\n                                    <input\n                                        type=\"text\"\n                                        required\n                                        className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                        value={statForm.label}\n                                        onChange={e => setStatForm({ ...statForm, label: e.target.value })}\n                                    />\n                                </div>\n                                <div className=\"flex justify-end gap-3 pt-4\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => setShowStatForm(false)}\n                                        className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\"\n                                    >\n                                        Cancel\n                                    </button>\n                                    <button\n                                        type=\"submit\"\n                                        className=\"bg-[#6E8C82] text-white px-6 py-2 rounded-lg hover:bg-[#587068] transition-colors\"\n                                    >\n                                        {editingStat ? 'Update Statistic' : 'Create Statistic'}\n                                    </button>\n                                </div>\n                            </form>\n                        </div>\n                    )}\n\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                        {stats.map(stat => (\n                            <div key={stat.id} className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 text-center relative group\">\n                                <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1\">\n                                    <button onClick={() => startEditStat(stat)} className=\"p-1 text-gray-500 hover:bg-gray-100 rounded\">\n                                        <Edit size={16} />\n                                    </button>\n                                    <button onClick={() => deleteStat(stat.id)} className=\"p-1 text-red-500 hover:bg-red-50 rounded\">\n                                        <Trash2 size={16} />\n                                    </button>\n                                </div>\n                                <div className=\"text-4xl font-bold text-[#2E8B57] mb-2\">{stat.value}</div>\n                                <p className=\"text-gray-600\">{stat.label}</p>\n                                <div className=\"mt-2 text-xs text-gray-400\">Order: {stat.order}</div>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n            ) : activeTab === 'history' ? (\n                <div>\n                    {/* Filters */}\n                    <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-6\">\n                        <div className=\"flex items-center gap-2 mb-4\">\n                            <Filter size={20} className=\"text-gray-600\" />\n                            <h3 className=\"text-lg font-semibold\">Filters</h3>\n                        </div>\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Payment Status</label>\n                                <select\n                                    value={statusFilter}\n                                    onChange={(e) => setStatusFilter(e.target.value)}\n                                    className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                >\n                                    <option value=\"\">All Statuses</option>\n                                    <option value=\"completed\">Completed</option>\n                                    <option value=\"pending\">Pending</option>\n                                    <option value=\"failed\">Failed</option>\n                                    <option value=\"refunded\">Refunded</option>\n                                </select>\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Payment Method</label>\n                                <select\n                                    value={methodFilter}\n                                    onChange={(e) => setMethodFilter(e.target.value)}\n                                    className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                >\n                                    <option value=\"\">All Methods</option>\n                                    <option value=\"mchanga\">M-Changa</option>\n                                </select>\n                            </div>\n                            <div className=\"flex items-end\">\n                                <button\n                                    onClick={() => {\n                                        setStatusFilter('')\n                                        setMethodFilter('')\n                                    }}\n                                    className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\"\n                                >\n                                    Clear Filters\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Summary Cards */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n                        <div className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-100\">\n                            <div className=\"text-sm text-gray-600\">Total Donations</div>\n                            <div className=\"text-2xl font-bold text-gray-900\">{donationsTotal}</div>\n                        </div>\n                        <div className=\"bg-green-50 p-4 rounded-xl shadow-sm border border-green-100\">\n                            <div className=\"text-sm text-green-600\">Completed</div>\n                            <div className=\"text-2xl font-bold text-green-700\">\n                                {donations.filter(d => d.paymentStatus === 'completed').length}\n                            </div>\n                        </div>\n                        <div className=\"bg-yellow-50 p-4 rounded-xl shadow-sm border border-yellow-100\">\n                            <div className=\"text-sm text-yellow-600\">Pending</div>\n                            <div className=\"text-2xl font-bold text-yellow-700\">\n                                {donations.filter(d => d.paymentStatus === 'pending').length}\n                            </div>\n                        </div>\n                        <div className=\"bg-red-50 p-4 rounded-xl shadow-sm border border-red-100\">\n                            <div className=\"text-sm text-red-600\">Failed</div>\n                            <div className=\"text-2xl font-bold text-red-700\">\n                                {donations.filter(d => d.paymentStatus === 'failed').length}\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Donations Table */}\n                    {donationsLoading ? (\n                        <div className=\"text-center py-12\">\n                            <div className=\"animate-spin h-8 w-8 border-4 border-[#6E8C82] border-t-transparent rounded-full mx-auto\"></div>\n                            <p className=\"mt-4 text-gray-600\">Loading donations...</p>\n                        </div>\n                    ) : donations.length === 0 ? (\n                        <div className=\"bg-white p-12 rounded-xl shadow-sm border border-gray-100 text-center\">\n                            <Receipt size={48} className=\"mx-auto text-gray-400 mb-4\" />\n                            <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">No Donations Yet</h3>\n                            <p className=\"text-gray-500\">Donations will appear here once they start coming in.</p>\n                        </div>\n                    ) : (\n                        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\n                            <div className=\"overflow-x-auto\">\n                                <table className=\"w-full\">\n                                    <thead className=\"bg-gray-50 border-b border-gray-200\">\n                                        <tr>\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Date</th>\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Donor</th>\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Amount</th>\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Method</th>\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Status</th>\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Reference</th>\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Actions</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody className=\"bg-white divide-y divide-gray-200\">\n                                        {donations.map((donation) => (\n                                            <tr key={donation.id} className=\"hover:bg-gray-50\">\n                                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                                                    {formatDate(donation.createdAt)}\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm font-medium text-gray-900\">\n                                                        {donation.donorName || 'Anonymous'}\n                                                    </div>\n                                                    <div className=\"text-sm text-gray-500\">{donation.donorEmail}</div>\n                                                    {donation.donorPhone && (\n                                                        <div className=\"text-xs text-gray-400\">{donation.donorPhone}</div>\n                                                    )}\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900\">\n                                                    {formatCurrency(donation.amount, donation.currency)}\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 capitalize\">\n                                                    {donation.paymentMethod}\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <span className={`px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(donation.paymentStatus)}`}>\n                                                        {donation.paymentStatus}\n                                                    </span>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap text-xs text-gray-500 font-mono\">\n                                                    {donation.reference?.substring(0, 20)}...\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                                                    {donation.paymentStatus === 'pending' && (\n                                                        <div className=\"flex gap-2\">\n                                                            <button\n                                                                onClick={() => updateDonationStatus(donation.id, 'completed')}\n                                                                className=\"text-green-600 hover:text-green-800 font-medium\"\n                                                            >\n                                                                Approve\n                                                            </button>\n                                                            <button\n                                                                onClick={() => updateDonationStatus(donation.id, 'failed')}\n                                                                className=\"text-red-600 hover:text-red-800 font-medium\"\n                                                            >\n                                                                Reject\n                                                            </button>\n                                                        </div>\n                                                    )}\n                                                    {donation.paymentStatus === 'completed' && (\n                                                        <button\n                                                            onClick={() => updateDonationStatus(donation.id, 'refunded')}\n                                                            className=\"text-gray-600 hover:text-gray-800 font-medium\"\n                                                        >\n                                                            Refund\n                                                        </button>\n                                                    )}\n                                                </td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            ) : null}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/forgot-password/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[994,997],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[994,997],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { Mail, ArrowLeft } from 'lucide-react'\nimport Link from 'next/link'\n\nexport default function ForgotPasswordPage() {\n    const [email, setEmail] = useState('')\n    const [loading, setLoading] = useState(false)\n    const [message, setMessage] = useState('')\n    const [error, setError] = useState('')\n\n    async function handleSubmit(e: React.FormEvent) {\n        e.preventDefault()\n        setLoading(true)\n        setMessage('')\n        setError('')\n\n        try {\n            const res = await fetch('/api/auth/forgot-password', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ email }),\n            })\n\n            const data = await res.json()\n\n            if (!res.ok) {\n                throw new Error(data.error || 'Failed to send reset email')\n            }\n\n            setMessage(data.message)\n            setEmail('')\n        } catch (err: any) {\n            setError(err.message || 'An error occurred')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-green-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden\">\n                {/* Header */}\n                <div className=\"bg-gradient-to-r from-[#6E8C82] to-[#2E8B57] p-8 text-white\">\n                    <div className=\"flex items-center gap-3 mb-2\">\n                        <Mail size={32} />\n                        <h1 className=\"text-3xl font-bold\">Forgot Password</h1>\n                    </div>\n                    <p className=\"text-white/80\">We&apos;ll send you a reset link</p>\n                </div>\n\n                {/* Form */}\n                <div className=\"p-8\">\n                    {message ? (\n                        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4 mb-6\">\n                            <p className=\"text-green-800\">{message}</p>\n                        </div>\n                    ) : (\n                        <form onSubmit={handleSubmit} className=\"space-y-6\">\n                            {error && (\n                                <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n                                    <p className=\"text-red-800\">{error}</p>\n                                </div>\n                            )}\n\n                            <div>\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                                    Email Address\n                                </label>\n                                <input\n                                    type=\"email\"\n                                    required\n                                    value={email}\n                                    onChange={(e) => setEmail(e.target.value)}\n                                    className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                    placeholder=\"admin@nrdc.org\"\n                                />\n                            </div>\n\n                            <button\n                                type=\"submit\"\n                                disabled={loading}\n                                className=\"w-full bg-gradient-to-r from-[#6E8C82] to-[#2E8B57] hover:from-[#0d5aa3] hover:to-[#267048] text-white py-3 rounded-lg font-semibold transition-all transform hover:scale-[1.02] disabled:opacity-50 disabled:hover:scale-100\"\n                            >\n                                {loading ? (\n                                    <div className=\"flex items-center justify-center gap-2\">\n                                        <div className=\"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent\"></div>\n                                        Sending...\n                                    </div>\n                                ) : (\n                                    'Send Reset Link'\n                                )}\n                            </button>\n                        </form>\n                    )}\n\n                    <div className=\"mt-6 text-center\">\n                        <Link\n                            href=\"/admin/login\"\n                            className=\"inline-flex items-center gap-2 text-[#6E8C82] hover:text-[#587068] font-medium transition-colors\"\n                        >\n                            <ArrowLeft size={18} />\n                            Back to Login\n                        </Link>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/gallery/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":97,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":97,"endColumn":23},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":151,"column":41,"nodeType":"JSXOpeningElement","endLine":151,"endColumn":116}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Plus, Trash2, Upload, Image as ImageIcon } from 'lucide-react'\nimport { useToast } from '@/components/Toast'\nimport { useConfirm } from '@/components/ConfirmDialog'\n\ninterface GalleryImage {\n    id: string\n    url: string\n    caption: string | null\n    category: string | null\n    createdAt: string\n}\n\nexport default function AdminGalleryPage() {\n    const { showToast } = useToast()\n    const { confirm } = useConfirm()\n    const [images, setImages] = useState<GalleryImage[]>([])\n    const [loading, setLoading] = useState(true)\n    const [showForm, setShowForm] = useState(false)\n    const [uploading, setUploading] = useState(false)\n    const [preview, setPreview] = useState<string | null>(null)\n    const [formData, setFormData] = useState({\n        file: null as File | null,\n        caption: '',\n        category: ''\n    })\n\n    useEffect(() => {\n        fetchImages()\n    }, [])\n\n    async function fetchImages() {\n        const res = await fetch('/api/gallery')\n        const data = await res.json()\n        setImages(data)\n        setLoading(false)\n    }\n\n    function handleFileChange(e: React.ChangeEvent<HTMLInputElement>) {\n        const file = e.target.files?.[0]\n        if (file) {\n            setFormData({ ...formData, file })\n            const reader = new FileReader()\n            reader.onloadend = () => {\n                setPreview(reader.result as string)\n            }\n            reader.readAsDataURL(file)\n        }\n    }\n\n    async function handleSubmit(e: React.FormEvent) {\n        e.preventDefault()\n\n        if (!formData.file) {\n            showToast('Please select an image', 'warning')\n            return\n        }\n\n        setUploading(true)\n\n        try {\n            // Upload image to Cloudinary\n            const uploadFormData = new FormData()\n            uploadFormData.append('file', formData.file)\n\n            const uploadRes = await fetch('/api/upload', {\n                method: 'POST',\n                body: uploadFormData\n            })\n\n            if (!uploadRes.ok) {\n                throw new Error('Upload failed')\n            }\n\n            const { url } = await uploadRes.json()\n\n            // Save to gallery\n            const res = await fetch('/api/gallery', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    url,\n                    caption: formData.caption,\n                    category: formData.category\n                })\n            })\n\n            if (res.ok) {\n                setFormData({ file: null, caption: '', category: '' })\n                setPreview(null)\n                setShowForm(false)\n                fetchImages()\n                showToast('Image uploaded successfully!', 'success')\n            }\n        } catch (error) {\n            showToast('Error uploading image. Please try again.', 'error')\n        } finally {\n            setUploading(false)\n        }\n    }\n\n    async function handleDelete(id: string) {\n        const confirmed = await confirm(\n            'Are you sure you want to delete this image? This action cannot be undone.',\n            'Delete Image'\n        )\n\n        if (!confirmed) return\n\n        const res = await fetch(`/api/gallery?id=${id}`, {\n            method: 'DELETE'\n        })\n\n        if (res.ok) {\n            showToast('Image deleted successfully!', 'success')\n            fetchImages()\n        } else {\n            showToast('Failed to delete image', 'error')\n        }\n    }\n\n    if (loading) {\n        return <div className=\"text-center py-12\">Loading...</div>\n    }\n\n    return (\n        <div>\n            <div className=\"flex justify-between items-center mb-8\">\n                <h1 className=\"text-3xl font-bold text-gray-900\">Gallery</h1>\n                <button\n                    onClick={() => setShowForm(!showForm)}\n                    className=\"bg-[#6E8C82] hover:bg-[#587068] text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors\"\n                    disabled={uploading}\n                >\n                    <Plus size={20} />\n                    {showForm ? 'Cancel' : 'Upload Image'}\n                </button>\n            </div>\n\n            {showForm && (\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8 max-w-2xl\">\n                    <h2 className=\"text-xl font-bold mb-4\">Upload New Image</h2>\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Select Image</label>\n                            <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-[#6E8C82] transition-colors\">\n                                {preview ? (\n                                    <div className=\"space-y-3\">\n                                        <img src={preview} alt=\"Preview\" className=\"max-h-64 mx-auto rounded-lg\" />\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => {\n                                                setPreview(null)\n                                                setFormData({ ...formData, file: null })\n                                            }}\n                                            className=\"text-red-600 hover:text-red-800 text-sm\"\n                                        >\n                                            Remove\n                                        </button>\n                                    </div>\n                                ) : (\n                                    <div>\n                                        <ImageIcon size={48} className=\"mx-auto text-gray-400 mb-3\" />\n                                        <label className=\"cursor-pointer\">\n                                            <span className=\"text-[#6E8C82] hover:underline font-medium\">Click to upload</span>\n                                            <input\n                                                type=\"file\"\n                                                accept=\"image/*\"\n                                                className=\"hidden\"\n                                                onChange={handleFileChange}\n                                                required\n                                            />\n                                        </label>\n                                        <p className=\"text-xs text-gray-500 mt-2\">PNG, JPG, GIF up to 10MB</p>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Caption</label>\n                            <input\n                                type=\"text\"\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                placeholder=\"Photo caption...\"\n                                value={formData.caption}\n                                onChange={e => setFormData({ ...formData, caption: e.target.value })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Category</label>\n                            <input\n                                type=\"text\"\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                placeholder=\"Programs, Events, Community\"\n                                value={formData.category}\n                                onChange={e => setFormData({ ...formData, category: e.target.value })}\n                            />\n                        </div>\n                        <button\n                            type=\"submit\"\n                            className=\"bg-[#2E8B57] text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 disabled:opacity-50\"\n                            disabled={uploading}\n                        >\n                            {uploading ? (\n                                <>\n                                    <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent\"></div>\n                                    Uploading...\n                                </>\n                            ) : (\n                                <>\n                                    <Upload size={20} />\n                                    Upload to Gallery\n                                </>\n                            )}\n                        </button>\n                    </form>\n                </div>\n            )}\n\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\">\n                {images.map((image) => (\n                    <div key={image.id} className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden group\">\n                        <div className=\"aspect-square relative bg-gray-200\">\n                            <div\n                                className=\"absolute inset-0 bg-cover bg-center\"\n                                style={{ backgroundImage: `url(\"${image.url}\")` }}\n                            />\n                            <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/50 transition-all flex items-center justify-center\">\n                                <button\n                                    onClick={() => handleDelete(image.id)}\n                                    className=\"opacity-0 group-hover:opacity-100 transition-opacity bg-red-600 text-white p-3 rounded-lg hover:bg-red-700\"\n                                >\n                                    <Trash2 size={20} />\n                                </button>\n                            </div>\n                        </div>\n                        {image.caption && (\n                            <div className=\"p-3\">\n                                <p className=\"text-sm text-gray-700\">{image.caption}</p>\n                                {image.category && (\n                                    <p className=\"text-xs text-gray-500 mt-1\">{image.category}</p>\n                                )}\n                            </div>\n                        )}\n                    </div>\n                ))}\n            </div>\n\n            {images.length === 0 && (\n                <div className=\"text-center py-12 text-gray-500\">\n                    <Upload size={48} className=\"mx-auto mb-4 opacity-50\" />\n                    <p className=\"text-lg\">No images in the gallery yet.</p>\n                    <p className=\"text-sm\">Click &quot;Upload Image&quot; to get started!</p>\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/login/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":40,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { Loader2, Eye, EyeOff } from 'lucide-react'\nimport Image from 'next/image'\nimport Link from 'next/link'\n\nexport default function AdminLoginPage() {\n    const router = useRouter()\n    const [loading, setLoading] = useState(false)\n    const [error, setError] = useState('')\n    const [showPassword, setShowPassword] = useState(false)\n\n    async function handleSubmit(e: React.FormEvent<HTMLFormElement>) {\n        e.preventDefault()\n        setLoading(true)\n        setError('')\n\n        const formData = new FormData(e.currentTarget)\n        const data = {\n            email: formData.get('email'),\n            password: formData.get('password'),\n        }\n\n        try {\n            const res = await fetch('/api/auth/login', {\n                method: 'POST',\n                body: JSON.stringify(data),\n                headers: { 'Content-Type': 'application/json' },\n            })\n\n            const result = await res.json()\n\n            if (res.ok) {\n                router.push('/admin/dashboard')\n            } else {\n                setError(result.error || 'Login failed')\n            }\n        } catch (err) {\n            setError('An error occurred. Please try again.')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <div className=\"min-h-screen bg-gradient-to-br from-[#6E8C82] via-[#2E8B57] to-[#6E8C82] animate-gradient-xy flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md\">\n                <div className=\"text-center mb-8\">\n                    <Image\n                        src=\"/images/nrdc-logo-v3.png\"\n                        alt=\"NRDC Logo\"\n                        width={240}\n                        height={120}\n                        className=\"h-24 w-auto mx-auto mb-4 rounded-xl\"\n                    />\n                    <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">Admin Portal</h1>\n                    <p className=\"text-gray-600\">Sign in to manage your dashboard</p>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"space-y-6\">\n                    <div>\n                        <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                            Email Address\n                        </label>\n                        <input\n                            type=\"email\"\n                            name=\"email\"\n                            id=\"email\"\n                            required\n                            className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                            placeholder=\"admin@nrdc.org\"\n                        />\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                            Password\n                        </label>\n                        <div className=\"relative\">\n                            <input\n                                type={showPassword ? \"text\" : \"password\"}\n                                name=\"password\"\n                                id=\"password\"\n                                required\n                                className=\"w-full px-4 py-3 pr-12 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n                            />\n                            <button\n                                type=\"button\"\n                                onClick={() => setShowPassword(!showPassword)}\n                                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors\"\n                                aria-label={showPassword ? \"Hide password\" : \"Show password\"}\n                            >\n                                {showPassword ? (\n                                    <EyeOff size={20} />\n                                ) : (\n                                    <Eye size={20} />\n                                )}\n                            </button>\n                        </div>\n                    </div>\n\n                    {error && (\n                        <div className=\"bg-red-50 text-red-700 p-3 rounded-lg text-sm\">\n                            {error}\n                        </div>\n                    )}\n\n                    <button\n                        type=\"submit\"\n                        disabled={loading}\n                        className=\"w-full bg-[#6E8C82] hover:bg-[#587068] text-white font-bold py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2 disabled:opacity-50\"\n                    >\n                        {loading && <Loader2 className=\"animate-spin\" size={20} />}\n                        Sign In\n                    </button>\n                </form>\n\n                <div className=\"mt-4 text-center\">\n                    <Link\n                        href=\"/admin/forgot-password\"\n                        className=\"text-sm text-[#6E8C82] hover:text-[#587068] font-medium transition-colors\"\n                    >\n                        Forgot your password?\n                    </Link>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/logs/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/programs/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UploadIcon' is defined but never used.","line":4,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":137,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":137,"endColumn":23},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":228,"column":41,"nodeType":"JSXOpeningElement","endLine":228,"endColumn":121}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Plus, Trash2, Edit, X, Upload as UploadIcon, Image as ImageIcon, Search } from 'lucide-react'\nimport { useToast } from '@/components/Toast'\nimport { useConfirm } from '@/components/ConfirmDialog'\n\ninterface Program {\n    id: string\n    title: string\n    slug: string\n    description: string\n    objectives: string\n    metrics: string\n    photos: string\n    createdAt: string\n}\n\nexport default function AdminProgramsPage() {\n    const { showToast } = useToast()\n    const { confirm } = useConfirm()\n    const [programs, setPrograms] = useState<Program[]>([])\n    const [loading, setLoading] = useState(true)\n    const [showForm, setShowForm] = useState(false)\n    const [uploading, setUploading] = useState(false)\n    const [editingId, setEditingId] = useState<string | null>(null)\n    const [photoPreview, setPhotoPreview] = useState<string | null>(null)\n    const [searchTerm, setSearchTerm] = useState('')\n\n    const filteredPrograms = programs.filter(program =>\n        program.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        program.slug.toLowerCase().includes(searchTerm.toLowerCase())\n    )\n    const [formData, setFormData] = useState({\n        title: '',\n        description: '',\n        objectives: '',\n        metrics: '',\n        photoFile: null as File | null,\n        photoUrl: ''\n    })\n\n    useEffect(() => {\n        fetchPrograms()\n    }, [])\n\n    async function fetchPrograms() {\n        const res = await fetch('/api/programs')\n        const data = await res.json()\n        setPrograms(data)\n        setLoading(false)\n    }\n\n    function handleAdd() {\n        setFormData({ title: '', description: '', objectives: '', metrics: '{}', photoFile: null, photoUrl: '' })\n        setPhotoPreview(null)\n        setEditingId(null)\n        setShowForm(true)\n    }\n\n    function handleEdit(program: Program) {\n        const photos = JSON.parse(program.photos || '[]')\n        setFormData({\n            title: program.title,\n            description: program.description,\n            objectives: program.objectives,\n            metrics: program.metrics,\n            photoFile: null,\n            photoUrl: photos[0] || ''\n        })\n        setPhotoPreview(photos[0] || null)\n        setEditingId(program.id)\n        setShowForm(true)\n    }\n\n    function handleFileChange(e: React.ChangeEvent<HTMLInputElement>) {\n        const file = e.target.files?.[0]\n        if (file) {\n            setFormData({ ...formData, photoFile: file })\n            const reader = new FileReader()\n            reader.onloadend = () => {\n                setPhotoPreview(reader.result as string)\n            }\n            reader.readAsDataURL(file)\n        }\n    }\n\n    async function handleSubmit(e: React.FormEvent) {\n        e.preventDefault()\n        setUploading(true)\n\n        try {\n            let photoUrl = formData.photoUrl\n\n            // Upload new image if selected\n            if (formData.photoFile) {\n                const uploadFormData = new FormData()\n                uploadFormData.append('file', formData.photoFile)\n\n                const uploadRes = await fetch('/api/upload', {\n                    method: 'POST',\n                    body: uploadFormData\n                })\n\n                if (!uploadRes.ok) throw new Error('Upload failed')\n                const { url } = await uploadRes.json()\n                photoUrl = url\n            }\n\n            const slug = formData.title.toLowerCase().replace(/[^a-z0-9]+/g, '-')\n\n            const payload = {\n                title: formData.title,\n                description: formData.description,\n                objectives: formData.objectives,\n                metrics: formData.metrics,\n                photos: photoUrl ? photoUrl : '',\n                slug\n            }\n\n            const url = editingId ? `/api/programs?id=${editingId}` : '/api/programs'\n            const method = editingId ? 'PUT' : 'POST'\n\n            const res = await fetch(url, {\n                method,\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(payload)\n            })\n\n            if (res.ok) {\n                showToast(editingId ? 'Program updated successfully!' : 'Program created successfully!', 'success')\n                setShowForm(false)\n                fetchPrograms()\n            } else {\n                throw new Error('Failed to save program')\n            }\n        } catch (error) {\n            showToast('Error saving program. Please try again.', 'error')\n        } finally {\n            setUploading(false)\n        }\n    }\n\n    async function handleDelete(id: string, title: string) {\n        const confirmed = await confirm(\n            `Are you sure you want to delete \"${title}\"? This action cannot be undone.`,\n            'Delete Program'\n        )\n\n        if (!confirmed) return\n\n        const res = await fetch(`/api/programs?id=${id}`, {\n            method: 'DELETE'\n        })\n\n        if (res.ok) {\n            showToast('Program deleted successfully!', 'success')\n            fetchPrograms()\n        } else {\n            showToast('Failed to delete program', 'error')\n        }\n    }\n\n    if (loading) {\n        return <div className=\"text-center py-12\">Loading...</div>\n    }\n\n    return (\n        <div>\n            <div className=\"flex flex-col md:flex-row justify-between items-center mb-8 gap-4\">\n                <h1 className=\"text-3xl font-bold text-gray-900\">Programs</h1>\n                <div className=\"flex gap-4 w-full md:w-auto\">\n                    <div className=\"relative flex-1 md:w-64\">\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" size={20} />\n                        <input\n                            type=\"text\"\n                            placeholder=\"Search programs...\"\n                            className=\"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                    </div>\n                    <button\n                        onClick={handleAdd}\n                        className=\"bg-[#6E8C82] hover:bg-[#587068] text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors whitespace-nowrap\"\n                        disabled={uploading}\n                    >\n                        <Plus size={20} />\n                        Add Program\n                    </button>\n                </div>\n            </div>\n\n            {showForm && (\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8\">\n                    <div className=\"flex justify-between items-center mb-4\">\n                        <h2 className=\"text-xl font-bold\">{editingId ? 'Edit' : 'Create'} Program</h2>\n                        <button onClick={() => setShowForm(false)} className=\"text-gray-500 hover:text-gray-700\">\n                            <X size={24} />\n                        </button>\n                    </div>\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Title</label>\n                            <input\n                                type=\"text\"\n                                required\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                value={formData.title}\n                                onChange={e => setFormData({ ...formData, title: e.target.value })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Description</label>\n                            <textarea\n                                required\n                                rows={4}\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                value={formData.description}\n                                onChange={e => setFormData({ ...formData, description: e.target.value })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Program Cover Photo</label>\n                            <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-[#6E8C82] transition-colors\">\n                                {photoPreview ? (\n                                    <div className=\"space-y-3\">\n                                        <img src={photoPreview} alt=\"Preview\" className=\"max-h-48 mx-auto rounded-lg\" />\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => {\n                                                setPhotoPreview(null)\n                                                setFormData({ ...formData, photoFile: null, photoUrl: '' })\n                                            }}\n                                            className=\"text-red-600 hover:text-red-800 text-sm\"\n                                        >\n                                            Remove Photo\n                                        </button>\n                                    </div>\n                                ) : (\n                                    <div>\n                                        <ImageIcon size={36} className=\"mx-auto text-gray-400 mb-2\" />\n                                        <label className=\"cursor-pointer\">\n                                            <span className=\"text-[#6E8C82] hover:underline font-medium\">Click to upload photo</span>\n                                            <input\n                                                type=\"file\"\n                                                accept=\"image/*\"\n                                                className=\"hidden\"\n                                                onChange={handleFileChange}\n                                            />\n                                        </label>\n                                        <p className=\"text-xs text-gray-500 mt-1\">PNG, JPG up to 10MB</p>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                                Objectives (one per line)\n                            </label>\n                            <textarea\n                                rows={3}\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                placeholder=\"Provide nutritious meals&#10;Improve health outcomes&#10;Build community resilience\"\n                                value={formData.objectives}\n                                onChange={e => setFormData({ ...formData, objectives: e.target.value })}\n                            />\n                            <p className=\"text-xs text-gray-500 mt-1\">Enter each objective on a new line</p>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Impact Metrics\n                            </label>\n                            <div className=\"space-y-3\">\n                                {(() => {\n                                    try {\n                                        const metricsObj = formData.metrics ? JSON.parse(formData.metrics) : {}\n                                        const metricsArray = Object.entries(metricsObj)\n\n                                        return (\n                                            <>\n                                                {metricsArray.map(([key, value], index) => (\n                                                    <div key={index} className=\"flex gap-2\">\n                                                        <input\n                                                            type=\"text\"\n                                                            placeholder=\"Metric name (e.g., people_served)\"\n                                                            className=\"flex-1 px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                                            value={key}\n                                                            onChange={e => {\n                                                                const newMetrics = { ...metricsObj }\n                                                                delete newMetrics[key]\n                                                                newMetrics[e.target.value] = value\n                                                                setFormData({ ...formData, metrics: JSON.stringify(newMetrics) })\n                                                            }}\n                                                        />\n                                                        <input\n                                                            type=\"text\"\n                                                            placeholder=\"Value (e.g., 5,000+)\"\n                                                            className=\"flex-1 px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                                            value={String(value)}\n                                                            onChange={e => {\n                                                                const newMetrics = { ...metricsObj, [key]: e.target.value }\n                                                                setFormData({ ...formData, metrics: JSON.stringify(newMetrics) })\n                                                            }}\n                                                        />\n                                                        <button\n                                                            type=\"button\"\n                                                            onClick={() => {\n                                                                const newMetrics = { ...metricsObj }\n                                                                delete newMetrics[key]\n                                                                setFormData({ ...formData, metrics: JSON.stringify(newMetrics) })\n                                                            }}\n                                                            className=\"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors\"\n                                                        >\n                                                            <X size={18} />\n                                                        </button>\n                                                    </div>\n                                                ))}\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => {\n                                                        const newMetrics = { ...metricsObj, [`metric_${Date.now()}`]: '' }\n                                                        setFormData({ ...formData, metrics: JSON.stringify(newMetrics) })\n                                                    }}\n                                                    className=\"text-[#6E8C82] hover:underline text-sm font-medium flex items-center gap-1\"\n                                                >\n                                                    <Plus size={16} />\n                                                    Add Metric\n                                                </button>\n                                            </>\n                                        )\n                                    } catch {\n                                        return (\n                                            <div className=\"text-red-600 text-sm\">\n                                                Invalid metrics format. <button\n                                                    type=\"button\"\n                                                    onClick={() => setFormData({ ...formData, metrics: '{}' })}\n                                                    className=\"underline\"\n                                                >\n                                                    Reset\n                                                </button>\n                                            </div>\n                                        )\n                                    }\n                                })()}\n                            </div>\n                            <p className=\"text-xs text-gray-500 mt-2\">\n                                Add metrics like &quot;people_served: 5,000+&quot; or &quot;locations: 12&quot;\n                            </p>\n                        </div>\n                        <div className=\"flex gap-3\">\n                            <button\n                                type=\"submit\"\n                                className=\"bg-[#2E8B57] text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 disabled:opacity-50\"\n                                disabled={uploading}\n                            >\n                                {uploading ? (\n                                    <>\n                                        <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent\"></div>\n                                        Uploading...\n                                    </>\n                                ) : (\n                                    <>{editingId ? 'Update' : 'Create'} Program</>\n                                )}\n                            </button>\n                            <button type=\"button\" onClick={() => setShowForm(false)} className=\"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors\">\n                                Cancel\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            )}\n\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\n                <table className=\"w-full\">\n                    <thead className=\"bg-gray-50 border-b border-gray-200\">\n                        <tr>\n                            <th className=\"text-left p-4 font-semibold text-gray-700\">Title</th>\n                            <th className=\"text-left p-4 font-semibold text-gray-700\">Slug</th>\n                            <th className=\"text-left p-4 font-semibold text-gray-700\">Created</th>\n                            <th className=\"text-left p-4 font-semibold text-gray-700\">Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {filteredPrograms.map((program) => (\n                            <tr key={program.id} className=\"border-b border-gray-100 last:border-0\">\n                                <td className=\"p-4 font-medium text-gray-900\">{program.title}</td>\n                                <td className=\"p-4 text-gray-600\">{program.slug}</td>\n                                <td className=\"p-4 text-gray-600\">\n                                    {new Date(program.createdAt).toLocaleDateString()}\n                                </td>\n                                <td className=\"p-4\">\n                                    <div className=\"flex gap-2\">\n                                        <button\n                                            onClick={() => handleEdit(program)}\n                                            className=\"text-[#6E8C82] hover:text-[#587068] p-2\"\n                                        >\n                                            <Edit size={18} />\n                                        </button>\n                                        <button\n                                            onClick={() => handleDelete(program.id, program.title)}\n                                            className=\"text-red-600 hover:text-red-800 p-2\"\n                                        >\n                                            <Trash2 size={18} />\n                                        </button>\n                                    </div>\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n                {programs.length === 0 && (\n                    <div className=\"text-center py-12 text-gray-500\">\n                        No programs yet. Create your first program!\n                    </div>\n                )}\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/reset-password/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":59,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1740,1743],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1740,1743],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Lock, CheckCircle } from 'lucide-react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport Link from 'next/link'\n\nexport default function ResetPasswordPage() {\n    const router = useRouter()\n    const searchParams = useSearchParams()\n    const token = searchParams.get('token')\n\n    const [password, setPassword] = useState('')\n    const [confirmPassword, setConfirmPassword] = useState('')\n    const [loading, setLoading] = useState(false)\n    const [success, setSuccess] = useState(false)\n    const [error, setError] = useState('')\n\n    useEffect(() => {\n        if (!token) {\n            setError('Invalid or missing reset token')\n        }\n    }, [token])\n\n    async function handleSubmit(e: React.FormEvent) {\n        e.preventDefault()\n        setLoading(true)\n        setError('')\n\n        if (password !== confirmPassword) {\n            setError('Passwords do not match')\n            setLoading(false)\n            return\n        }\n\n        if (password.length < 6) {\n            setError('Password must be at least 6 characters')\n            setLoading(false)\n            return\n        }\n\n        try {\n            const res = await fetch('/api/auth/reset-password', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ token, password }),\n            })\n\n            const data = await res.json()\n\n            if (!res.ok) {\n                throw new Error(data.error || 'Failed to reset password')\n            }\n\n            setSuccess(true)\n            setTimeout(() => {\n                router.push('/admin/login')\n            }, 2000)\n        } catch (err: any) {\n            setError(err.message || 'An error occurred')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    if (success) {\n        return (\n            <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-green-50 flex items-center justify-center p-4\">\n                <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 text-center\">\n                    <div className=\"flex justify-center mb-4\">\n                        <CheckCircle size={64} className=\"text-green-600\" />\n                    </div>\n                    <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">Password Reset Successfully!</h1>\n                    <p className=\"text-gray-600\">Redirecting to login...</p>\n                </div>\n            </div>\n        )\n    }\n\n    return (\n        <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-green-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden\">\n                {/* Header */}\n                <div className=\"bg-gradient-to-r from-[#6E8C82] to-[#2E8B57] p-8 text-white\">\n                    <div className=\"flex items-center gap-3 mb-2\">\n                        <Lock size={32} />\n                        <h1 className=\"text-3xl font-bold\">Reset Password</h1>\n                    </div>\n                    <p className=\"text-white/80\">Enter your new password</p>\n                </div>\n\n                {/* Form */}\n                <div className=\"p-8\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n                                <p className=\"text-red-800\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                                New Password\n                            </label>\n                            <input\n                                type=\"password\"\n                                required\n                                value={password}\n                                onChange={(e) => setPassword(e.target.value)}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"Enter new password\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                                Confirm Password\n                            </label>\n                            <input\n                                type=\"password\"\n                                required\n                                value={confirmPassword}\n                                onChange={(e) => setConfirmPassword(e.target.value)}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"Confirm new password\"\n                            />\n                        </div>\n\n                        <button\n                            type=\"submit\"\n                            disabled={loading || !token}\n                            className=\"w-full bg-gradient-to-r from-[#6E8C82] to-[#2E8B57] hover:from-[#0d5aa3] hover:to-[#267048] text-white py-3 rounded-lg font-semibold transition-all transform hover:scale-[1.02] disabled:opacity-50 disabled:hover:scale-100\"\n                        >\n                            {loading ? (\n                                <div className=\"flex items-center justify-center gap-2\">\n                                    <div className=\"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent\"></div>\n                                    Resetting...\n                                </div>\n                            ) : (\n                                'Reset Password'\n                            )}\n                        </button>\n                    </form>\n\n                    <div className=\"mt-6 text-center\">\n                        <Link\n                            href=\"/admin/login\"\n                            className=\"text-[#6E8C82] hover:text-[#587068] font-medium transition-colors\"\n                        >\n                            Back to Login\n                        </Link>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/resources/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/settings/page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchSettings'. Either include it or remove the dependency array.","line":29,"column":8,"nodeType":"ArrayExpression","endLine":29,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchSettings]","fix":{"range":[794,796],"text":"[fetchSettings]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useToast } from '@/components/Toast'\nimport { Loader2, Save } from 'lucide-react'\n\nexport default function AdminSettingsPage() {\n    const { showToast } = useToast()\n    const [loading, setLoading] = useState(true)\n    const [saving, setSaving] = useState(false)\n    const [settings, setSettings] = useState({\n        core_values: '',\n        contact_email: '',\n        contact_phone: '',\n        contact_address: '',\n        // Bank details\n        bank_account_name: '',\n        bank_account_number: '',\n        bank_branch: '',\n        bank_code: '',\n        bank_branch_code: '',\n        bank_swift_code: '',\n        bank_phone_number: '',\n        bank_name: ''\n    })\n\n    useEffect(() => {\n        fetchSettings()\n    }, [])\n\n    async function fetchSettings() {\n        try {\n            const [settingsRes, bankRes] = await Promise.all([\n                fetch('/api/settings'),\n                fetch('/api/settings/bank')\n            ])\n\n            if (settingsRes.ok) {\n                const data = await settingsRes.json()\n                setSettings(prev => ({\n                    ...prev,\n                    ...data\n                }))\n            }\n\n            if (bankRes.ok) {\n                const bankData = await bankRes.json()\n                if (bankData) {\n                    setSettings(prev => ({\n                        ...prev,\n                        bank_account_name: bankData.accountName || '',\n                        bank_account_number: bankData.accountNumber || '',\n                        bank_branch: bankData.branch || '',\n                        bank_code: bankData.bankCode || '',\n                        bank_branch_code: bankData.branchCode || '',\n                        bank_swift_code: bankData.swiftCode || '',\n                        bank_phone_number: bankData.phoneNumber || '',\n                        bank_name: bankData.bankName || ''\n                    }))\n                }\n            }\n        } catch (error) {\n            console.error('Error fetching settings:', error)\n            showToast('Failed to load settings', 'error')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    async function handleSave() {\n        setSaving(true)\n        try {\n            // Save general settings\n            const settingsRes = await fetch('/api/settings', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    core_values: settings.core_values,\n                    contact_email: settings.contact_email,\n                    contact_phone: settings.contact_phone,\n                    contact_address: settings.contact_address\n                })\n            })\n\n            // Save bank details\n            const bankRes = await fetch('/api/settings/bank', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    accountName: settings.bank_account_name,\n                    accountNumber: settings.bank_account_number,\n                    branch: settings.bank_branch,\n                    bankCode: settings.bank_code,\n                    branchCode: settings.bank_branch_code,\n                    swiftCode: settings.bank_swift_code,\n                    phoneNumber: settings.bank_phone_number,\n                    bankName: settings.bank_name\n                })\n            })\n\n            if (settingsRes.ok && bankRes.ok) {\n                showToast('Settings saved successfully!', 'success')\n            } else {\n                showToast('Failed to save some settings', 'error')\n            }\n        } catch (error) {\n            console.error('Error saving settings:', error)\n            showToast('Failed to save settings', 'error')\n        } finally {\n            setSaving(false)\n        }\n    }\n\n    if (loading) {\n        return (\n            <div className=\"flex items-center justify-center min-h-[400px]\">\n                <Loader2 className=\"animate-spin text-[#6E8C82]\" size={32} />\n            </div>\n        )\n    }\n\n    return (\n        <div>\n            <div className=\"flex justify-between items-center mb-8\">\n                <h1 className=\"text-3xl font-bold text-gray-900\">Settings</h1>\n                <button\n                    onClick={handleSave}\n                    disabled={saving}\n                    className=\"bg-[#6E8C82] hover:bg-[#587068] text-white px-6 py-2.5 rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50\"\n                >\n                    {saving ? <Loader2 className=\"animate-spin\" size={20} /> : <Save size={20} />}\n                    Save Changes\n                </button>\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n                {/* General Settings */}\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\n                    <h2 className=\"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">\n                        <span className=\"w-1 h-6 bg-[#6E8C82] rounded-full\"></span>\n                        General Settings\n                    </h2>\n\n                    <div className=\"space-y-6\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Core Values (comma-separated)\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={settings.core_values}\n                                onChange={e => setSettings({ ...settings, core_values: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"Integrity, Compassion, Sustainability...\"\n                            />\n                            <p className=\"text-sm text-gray-500 mt-1\">\n                                These values will be displayed on the About page.\n                            </p>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Contact Information */}\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\n                    <h2 className=\"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">\n                        <span className=\"w-1 h-6 bg-[#2E8B57] rounded-full\"></span>\n                        Contact Information\n                    </h2>\n\n                    <div className=\"space-y-6\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Contact Email\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={settings.contact_email}\n                                onChange={e => setSettings({ ...settings, contact_email: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"contact@nrdc.org\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Phone Number\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={settings.contact_phone}\n                                onChange={e => setSettings({ ...settings, contact_phone: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"+254 727 001 702\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Physical Address\n                            </label>\n                            <textarea\n                                value={settings.contact_address}\n                                onChange={e => setSettings({ ...settings, contact_address: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                rows={3}\n                                placeholder=\"Enter physical address...\"\n                            />\n                        </div>\n                    </div>\n                </div>\n\n                {/* Bank Account Details */}\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 lg:col-span-2\">\n                    <h2 className=\"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2\">\n                        <span className=\"w-1 h-6 bg-[#2E8B57] rounded-full\"></span>\n                        Bank Account Details\n                    </h2>\n\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Account Name *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={settings.bank_account_name}\n                                onChange={e => setSettings({ ...settings, bank_account_name: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"NRDC\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Account Number *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={settings.bank_account_number}\n                                onChange={e => setSettings({ ...settings, bank_account_number: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"01207150002\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Bank Name\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={settings.bank_name}\n                                onChange={e => setSettings({ ...settings, bank_name: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"ABC Bank\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Branch *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={settings.bank_branch}\n                                onChange={e => setSettings({ ...settings, bank_branch: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"Nairobi\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Bank Code\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={settings.bank_code}\n                                onChange={e => setSettings({ ...settings, bank_code: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"19\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Branch Code\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={settings.bank_branch_code}\n                                onChange={e => setSettings({ ...settings, bank_branch_code: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"000\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Swift Code\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={settings.bank_swift_code}\n                                onChange={e => setSettings({ ...settings, bank_swift_code: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"AFRIKENX\"\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                Phone Number\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={settings.bank_phone_number}\n                                onChange={e => setSettings({ ...settings, bank_phone_number: e.target.value })}\n                                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent outline-none transition-all\"\n                                placeholder=\"972900\"\n                            />\n                        </div>\n                    </div>\n\n                    <p className=\"text-sm text-gray-500 mt-4\">\n                        These bank details will be displayed on the donation page for donors who prefer bank transfers.\n                    </p>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/statistics/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":117,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3330,3333],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3330,3333],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { BarChart3, Plus, Edit, Trash2, X } from 'lucide-react'\nimport * as Icons from 'lucide-react'\n\ninterface Statistic {\n    id: string\n    label: string\n    value: string\n    icon: string\n    order: number\n    active: boolean\n    createdAt: string\n    updatedAt: string\n}\n\nconst iconsAvailable = [\n    'Users', 'Utensils', 'Sprout', 'Heart', 'Award', 'Target', 'TrendingUp', 'Gift', 'Home', 'Globe'\n]\n\nexport default function AdminStatisticsPage() {\n    const [statistics, setStatistics] = useState<Statistic[]>([])\n    const [loading, setLoading] = useState(true)\n    const [editing, setEditing] = useState<Statistic | null>(null)\n    const [showForm, setShowForm] = useState(false)\n\n    const [formData, setFormData] = useState({\n        label: '',\n        value: '',\n        icon: 'Users',\n        order: 0,\n        active: true,\n    })\n\n    useEffect(() => {\n        fetchStatistics()\n    }, [])\n\n    async function fetchStatistics() {\n        const res = await fetch('/api/statistics', { cache: 'no-store' })\n        const data = await res.json()\n        setStatistics(data)\n        setLoading(false)\n    }\n\n    function openCreateForm() {\n        setEditing(null)\n        setFormData({\n            label: '',\n            value: '',\n            icon: 'Users',\n            order: statistics.length,\n            active: true,\n        })\n        setShowForm(true)\n    }\n\n    function openEditForm(stat: Statistic) {\n        setEditing(stat)\n        setFormData({\n            label: stat.label,\n            value: stat.value,\n            icon: stat.icon,\n            order: stat.order,\n            active: stat.active,\n        })\n        setShowForm(true)\n    }\n\n    async function handleSubmit(e: React.FormEvent) {\n        e.preventDefault()\n        setLoading(true)\n\n        try {\n            if (editing) {\n                await fetch(`/api/statistics/${editing.id}`, {\n                    method: 'PATCH',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify(formData),\n                })\n            } else {\n                await fetch('/api/statistics', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify(formData),\n                })\n            }\n\n            setShowForm(false)\n            fetchStatistics()\n        } catch (error) {\n            console.error('Error saving statistic:', error)\n            alert('Failed to save statistic')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    async function handleDelete(id: string) {\n        if (!confirm('Are you sure you want to delete this statistic?')) return\n\n        try {\n            const res = await fetch(`/api/statistics/${id}`, { method: 'DELETE' })\n            if (!res.ok) {\n                const error = await res.json()\n                throw new Error(error.error || 'Failed to delete statistic')\n            }\n            fetchStatistics()\n        } catch (error) {\n            console.error('Error deleting statistic:', error)\n            alert(error instanceof Error ? error.message : 'Failed to delete statistic')\n        }\n    }\n\n    function getIconComponent(iconName: string) {\n        const Icon = (Icons as any)[iconName] || Icons.BarChart3\n        return <Icon size={24} />\n    }\n\n    if (loading && !showForm) {\n        return <div className=\"text-center py-12\">Loading statistics...</div>\n    }\n\n    return (\n        <div>\n            <div className=\"flex justify-between items-center mb-8\">\n                <div>\n                    <h1 className=\"text-3xl font-bold text-gray-900 flex items-center gap-2\">\n                        <BarChart3 size={32} className=\"text-[#6E8C82]\" />\n                        Statistics Management\n                    </h1>\n                    <p className=\"text-gray-600 mt-1\">Manage impact numbers displayed on the homepage</p>\n                </div>\n                <button\n                    onClick={openCreateForm}\n                    className=\"bg-[#6E8C82] hover:bg-[#587068] text-white px-6 py-3 rounded-lg flex items-center gap-2 transition-colors\"\n                >\n                    <Plus size={20} />\n                    Add Statistic\n                </button>\n            </div>\n\n            {/* Statistics Grid */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                {statistics.map((stat) => (\n                    <div\n                        key={stat.id}\n                        className={`bg-white rounded-xl shadow-sm border p-6 ${!stat.active ? 'opacity-50' : ''\n                            }`}\n                    >\n                        <div className=\"flex items-center justify-between mb-4\">\n                            <div className=\"p-3 bg-[#6E8C82]/20 rounded-lg text-[#6E8C82]\">\n                                {getIconComponent(stat.icon)}\n                            </div>\n                            {!stat.active && (\n                                <span className=\"text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded\">\n                                    Inactive\n                                </span>\n                            )}\n                        </div>\n                        <h3 className=\"text-3xl font-bold text-gray-900 mb-1\">{stat.value}</h3>\n                        <p className=\"text-gray-600 text-sm mb-4\">{stat.label}</p>\n                        <div className=\"flex gap-2\">\n                            <button\n                                onClick={() => openEditForm(stat)}\n                                className=\"flex-1 bg-[#6E8C82]/10 hover:bg-[#6E8C82]/20 text-[#587068] px-4 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm\"\n                            >\n                                <Edit size={16} />\n                                Edit\n                            </button>\n                            <button\n                                onClick={() => handleDelete(stat.id)}\n                                className=\"flex-1 bg-red-50 hover:bg-red-100 text-red-700 px-4 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm\"\n                            >\n                                <Trash2 size={16} />\n                                Delete\n                            </button>\n                        </div>\n                    </div>\n                ))}\n            </div>\n\n            {/* Create/Edit Modal */}\n            {showForm && (\n                <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4\">\n                    <div className=\"bg-white rounded-xl shadow-2xl max-w-md w-full\">\n                        <div className=\"border-b border-gray-200 p-6 flex justify-between items-center\">\n                            <h2 className=\"text-2xl font-bold text-gray-900\">\n                                {editing ? 'Edit Statistic' : 'Add Statistic'}\n                            </h2>\n                            <button\n                                onClick={() => setShowForm(false)}\n                                className=\"text-gray-400 hover:text-gray-600\"\n                            >\n                                <X size={24} />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                            <div>\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                    Label *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    required\n                                    placeholder=\"e.g., Lives Impacted\"\n                                    value={formData.label}\n                                    onChange={(e) => setFormData({ ...formData, label: e.target.value })}\n                                    className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                    Value *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    required\n                                    placeholder=\"e.g., 50,000+\"\n                                    value={formData.value}\n                                    onChange={(e) => setFormData({ ...formData, value: e.target.value })}\n                                    className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                    Icon *\n                                </label>\n                                <select\n                                    value={formData.icon}\n                                    onChange={(e) => setFormData({ ...formData, icon: e.target.value })}\n                                    className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                >\n                                    {iconsAvailable.map((iconName) => (\n                                        <option key={iconName} value={iconName}>\n                                            {iconName}\n                                        </option>\n                                    ))}\n                                </select>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                        Display Order\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={formData.order}\n                                        onChange={(e) => setFormData({ ...formData, order: parseInt(e.target.value) })}\n                                        className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                        Status\n                                    </label>\n                                    <select\n                                        value={formData.active ? 'active' : 'inactive'}\n                                        onChange={(e) => setFormData({ ...formData, active: e.target.value === 'active' })}\n                                        className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                    >\n                                        <option value=\"active\">Active</option>\n                                        <option value=\"inactive\">Inactive</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div className=\"flex gap-3 pt-4\">\n                                <button\n                                    type=\"button\"\n                                    onClick={() => setShowForm(false)}\n                                    className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-medium transition-colors\"\n                                >\n                                    Cancel\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading}\n                                    className=\"flex-1 bg-[#6E8C82] hover:bg-[#587068] text-white px-6 py-3 rounded-lg font-medium transition-colors disabled:opacity-50\"\n                                >\n                                    {loading ? 'Saving...' : editing ? 'Update' : 'Create'}\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/subscriptions/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DollarSign' is defined but never used.","line":4,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":47},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchSubscriptions'. Either include it or remove the dependency array.","line":46,"column":8,"nodeType":"ArrayExpression","endLine":46,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [fetchSubscriptions, statusFilter]","fix":{"range":[1178,1192],"text":"[fetchSubscriptions, statusFilter]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Repeat, TrendingUp, Users, DollarSign, Pause, Play, X, Calendar } from 'lucide-react'\nimport { useToast } from '@/components/Toast'\nimport { useConfirm } from '@/components/ConfirmDialog'\n\ninterface Subscription {\n    id: string\n    donorEmail: string\n    donorName: string | null\n    donorPhone: string | null\n    amount: number\n    currency: string\n    frequency: string\n    status: string\n    nextChargeDate: string\n    createdAt: string\n    updatedAt: string\n}\n\ninterface Metrics {\n    total: number\n    active: number\n    paused: number\n    cancelled: number\n    mrr: number\n}\n\nexport default function AdminSubscriptionsPage() {\n    const { showToast } = useToast()\n    const { confirm } = useConfirm()\n    const [subscriptions, setSubscriptions] = useState<Subscription[]>([])\n    const [metrics, setMetrics] = useState<Metrics>({\n        total: 0,\n        active: 0,\n        paused: 0,\n        cancelled: 0,\n        mrr: 0,\n    })\n    const [loading, setLoading] = useState(true)\n    const [statusFilter, setStatusFilter] = useState<string>('')\n\n    useEffect(() => {\n        fetchSubscriptions()\n    }, [statusFilter])\n\n    async function fetchSubscriptions() {\n        setLoading(true)\n        try {\n            const params = new URLSearchParams()\n            if (statusFilter) params.append('status', statusFilter)\n\n            const res = await fetch(`/api/subscriptions?${params.toString()}`)\n            if (res.ok) {\n                const data = await res.json()\n                setSubscriptions(data.subscriptions)\n                setMetrics(data.metrics)\n            } else {\n                showToast('Failed to load subscriptions', 'error')\n            }\n        } catch (error) {\n            console.error('Error fetching subscriptions:', error)\n            showToast('Failed to load subscriptions', 'error')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    async function handleAction(id: string, action: 'pause' | 'resume' | 'cancel') {\n        const confirmMessages = {\n            pause: 'Are you sure you want to pause this subscription?',\n            resume: 'Are you sure you want to resume this subscription?',\n            cancel: 'Are you sure you want to cancel this subscription? This cannot be undone.',\n        }\n\n        if (!await confirm(confirmMessages[action])) return\n\n        try {\n            const res = await fetch(`/api/subscriptions/${id}`, {\n                method: 'PATCH',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ action }),\n            })\n\n            if (res.ok) {\n                showToast(`Subscription ${action}d successfully`, 'success')\n                fetchSubscriptions()\n            } else {\n                showToast(`Failed to ${action} subscription`, 'error')\n            }\n        } catch (error) {\n            console.error(`Error ${action}ing subscription:`, error)\n            showToast(`Failed to ${action} subscription`, 'error')\n        }\n    }\n\n    function formatCurrency(amount: number, currency: string) {\n        return new Intl.NumberFormat('en-US', {\n            style: 'currency',\n            currency: currency || 'KES',\n        }).format(amount)\n    }\n\n    function formatDate(date: string) {\n        return new Date(date).toLocaleDateString('en-US', {\n            year: 'numeric',\n            month: 'short',\n            day: 'numeric',\n        })\n    }\n\n    function getStatusColor(status: string) {\n        switch (status) {\n            case 'active':\n                return 'bg-green-100 text-green-800'\n            case 'paused':\n                return 'bg-yellow-100 text-yellow-800'\n            case 'cancelled':\n                return 'bg-gray-100 text-gray-800'\n            default:\n                return 'bg-gray-100 text-gray-800'\n        }\n    }\n\n    function getFrequencyBadge(frequency: string) {\n        return frequency === 'monthly' ? (\n            <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-[#6E8C82]/20 text-blue-800\">\n                Monthly\n            </span>\n        ) : (\n            <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800\">\n                Yearly\n            </span>\n        )\n    }\n\n    if (loading) return <div className=\"p-8 text-center\">Loading...</div>\n\n    return (\n        <div>\n            <div className=\"mb-8\">\n                <h1 className=\"text-3xl font-bold text-gray-900\">Recurring Donations</h1>\n                <p className=\"text-gray-600 mt-1\">Manage subscription donors and track recurring revenue</p>\n            </div>\n\n            {/* Metrics Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8\">\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\n                    <div className=\"flex items-center justify-between\">\n                        <div>\n                            <p className=\"text-sm font-medium text-gray-600\">Total Subscriptions</p>\n                            <p className=\"text-3xl font-bold text-gray-900 mt-2\">{metrics.total}</p>\n                        </div>\n                        <Repeat className=\"w-10 h-10 text-gray-400\" />\n                    </div>\n                </div>\n\n                <div className=\"bg-green-50 p-6 rounded-xl shadow-sm border border-green-100\">\n                    <div className=\"flex items-center justify-between\">\n                        <div>\n                            <p className=\"text-sm font-medium text-green-600\">Active</p>\n                            <p className=\"text-3xl font-bold text-green-700 mt-2\">{metrics.active}</p>\n                        </div>\n                        <Users className=\"w-10 h-10 text-green-400\" />\n                    </div>\n                </div>\n\n                <div className=\"bg-yellow-50 p-6 rounded-xl shadow-sm border border-yellow-100\">\n                    <div className=\"flex items-center justify-between\">\n                        <div>\n                            <p className=\"text-sm font-medium text-yellow-600\">Paused</p>\n                            <p className=\"text-3xl font-bold text-yellow-700 mt-2\">{metrics.paused}</p>\n                        </div>\n                        <Pause className=\"w-10 h-10 text-yellow-400\" />\n                    </div>\n                </div>\n\n                <div className=\"bg-gray-50 p-6 rounded-xl shadow-sm border border-gray-100\">\n                    <div className=\"flex items-center justify-between\">\n                        <div>\n                            <p className=\"text-sm font-medium text-gray-600\">Cancelled</p>\n                            <p className=\"text-3xl font-bold text-gray-700 mt-2\">{metrics.cancelled}</p>\n                        </div>\n                        <X className=\"w-10 h-10 text-gray-400\" />\n                    </div>\n                </div>\n\n                <div className=\"bg-gradient-to-br from-[#6E8C82] to-[#2E8B57] p-6 rounded-xl shadow-sm\">\n                    <div className=\"flex items-center justify-between\">\n                        <div>\n                            <p className=\"text-sm font-medium text-white/90\">MRR</p>\n                            <p className=\"text-3xl font-bold text-white mt-2\">\n                                {formatCurrency(metrics.mrr, 'KES')}\n                            </p>\n                            <p className=\"text-xs text-white/75 mt-1\">Monthly Recurring Revenue</p>\n                        </div>\n                        <TrendingUp className=\"w-10 h-10 text-white/80\" />\n                    </div>\n                </div>\n            </div>\n\n            {/* Filters */}\n            <div className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-100 mb-6\">\n                <div className=\"flex items-center gap-4\">\n                    <label className=\"text-sm font-medium text-gray-700\">Filter by Status:</label>\n                    <select\n                        value={statusFilter}\n                        onChange={(e) => setStatusFilter(e.target.value)}\n                        className=\"px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                    >\n                        <option value=\"\">All Statuses</option>\n                        <option value=\"active\">Active</option>\n                        <option value=\"paused\">Paused</option>\n                        <option value=\"cancelled\">Cancelled</option>\n                    </select>\n                    {statusFilter && (\n                        <button\n                            onClick={() => setStatusFilter('')}\n                            className=\"text-sm text-gray-600 hover:text-gray-900\"\n                        >\n                            Clear Filter\n                        </button>\n                    )}\n                </div>\n            </div>\n\n            {/* Subscriptions Table */}\n            {subscriptions.length === 0 ? (\n                <div className=\"bg-white p-12 rounded-xl shadow-sm border border-gray-100 text-center\">\n                    <Repeat size={48} className=\"mx-auto text-gray-400 mb-4\" />\n                    <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">\n                        No Subscriptions Yet\n                    </h3>\n                    <p className=\"text-gray-500\">\n                        Recurring donations will appear here once donors set them up.\n                    </p>\n                </div>\n            ) : (\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\n                    <div className=\"overflow-x-auto\">\n                        <table className=\"w-full\">\n                            <thead className=\"bg-gray-50 border-b border-gray-200\">\n                                <tr>\n                                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                                        Donor\n                                    </th>\n                                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                                        Amount\n                                    </th>\n                                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                                        Frequency\n                                    </th>\n                                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                                        Status\n                                    </th>\n                                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                                        Next Charge\n                                    </th>\n                                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                                        Started\n                                    </th>\n                                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                                        Actions\n                                    </th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"bg-white divide-y divide-gray-200\">\n                                {subscriptions.map((sub) => (\n                                    <tr key={sub.id} className=\"hover:bg-gray-50\">\n                                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                                            <div className=\"text-sm font-medium text-gray-900\">\n                                                {sub.donorName || 'Anonymous'}\n                                            </div>\n                                            <div className=\"text-sm text-gray-500\">{sub.donorEmail}</div>\n                                            {sub.donorPhone && (\n                                                <div className=\"text-xs text-gray-400\">{sub.donorPhone}</div>\n                                            )}\n                                        </td>\n                                        <td className=\"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900\">\n                                            {formatCurrency(sub.amount, sub.currency)}\n                                        </td>\n                                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                                            {getFrequencyBadge(sub.frequency)}\n                                        </td>\n                                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                                            <span\n                                                className={`px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(\n                                                    sub.status\n                                                )}`}\n                                            >\n                                                {sub.status}\n                                            </span>\n                                        </td>\n                                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                                            <div className=\"flex items-center gap-2\">\n                                                <Calendar size={14} className=\"text-gray-400\" />\n                                                {formatDate(sub.nextChargeDate)}\n                                            </div>\n                                        </td>\n                                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                                            {formatDate(sub.createdAt)}\n                                        </td>\n                                        <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                                            {sub.status === 'active' && (\n                                                <div className=\"flex gap-2\">\n                                                    <button\n                                                        onClick={() => handleAction(sub.id, 'pause')}\n                                                        className=\"text-yellow-600 hover:text-yellow-800 font-medium flex items-center gap-1\"\n                                                        title=\"Pause subscription\"\n                                                    >\n                                                        <Pause size={16} />\n                                                        Pause\n                                                    </button>\n                                                    <button\n                                                        onClick={() => handleAction(sub.id, 'cancel')}\n                                                        className=\"text-red-600 hover:text-red-800 font-medium flex items-center gap-1\"\n                                                        title=\"Cancel subscription\"\n                                                    >\n                                                        <X size={16} />\n                                                        Cancel\n                                                    </button>\n                                                </div>\n                                            )}\n                                            {sub.status === 'paused' && (\n                                                <div className=\"flex gap-2\">\n                                                    <button\n                                                        onClick={() => handleAction(sub.id, 'resume')}\n                                                        className=\"text-green-600 hover:text-green-800 font-medium flex items-center gap-1\"\n                                                        title=\"Resume subscription\"\n                                                    >\n                                                        <Play size={16} />\n                                                        Resume\n                                                    </button>\n                                                    <button\n                                                        onClick={() => handleAction(sub.id, 'cancel')}\n                                                        className=\"text-red-600 hover:text-red-800 font-medium flex items-center gap-1\"\n                                                        title=\"Cancel subscription\"\n                                                    >\n                                                        <X size={16} />\n                                                        Cancel\n                                                    </button>\n                                                </div>\n                                            )}\n                                            {sub.status === 'cancelled' && (\n                                                <span className=\"text-gray-400 text-xs\">No actions</span>\n                                            )}\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/team/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UploadIcon' is defined but never used.","line":4,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ImageIcon' is defined but never used.","line":4,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":73},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'imagePreview' is assigned a value but never used.","line":29,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setImagePreview' is assigned a value but never used.","line":29,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Plus, Trash2, Edit, X, Upload as UploadIcon, Image as ImageIcon, Search, Loader2, Upload, Users } from 'lucide-react'\nimport Image from 'next/image'\nimport { useToast } from '@/components/Toast'\nimport { useConfirm } from '@/components/ConfirmDialog'\n\ninterface TeamMember {\n    id: string\n    name: string\n    title: string\n    bio: string | null\n    imageUrl: string | null\n    order: number\n    active: boolean\n    createdAt: string\n    updatedAt: string\n}\n\nexport default function AdminTeamPage() {\n    const { showToast } = useToast()\n    const { confirm } = useConfirm()\n    const [teamMembers, setTeamMembers] = useState<TeamMember[]>([])\n    const [loading, setLoading] = useState(true)\n    const [editing, setEditing] = useState<TeamMember | null>(null)\n    const [showForm, setShowForm] = useState(false)\n    const [uploading, setUploading] = useState(false)\n    const [imagePreview, setImagePreview] = useState<string | null>(null)\n    const [searchTerm, setSearchTerm] = useState('')\n\n    const filteredMembers = teamMembers.filter(member =>\n        member.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        member.title.toLowerCase().includes(searchTerm.toLowerCase())\n    )\n    const [formData, setFormData] = useState({\n        name: '',\n        title: '',\n        bio: '',\n        imageUrl: '',\n        order: 0,\n        active: true,\n    })\n\n    useEffect(() => {\n        fetchTeamMembers()\n    }, [])\n\n    async function fetchTeamMembers() {\n        const res = await fetch('/api/team')\n        const data = await res.json()\n        setTeamMembers(data)\n        setLoading(false)\n    }\n\n    function openCreateForm() {\n        setEditing(null)\n        setFormData({\n            name: '',\n            title: '',\n            bio: '',\n            imageUrl: '',\n            order: teamMembers.length,\n            active: true,\n        })\n        setShowForm(true)\n    }\n\n    function openEditForm(member: TeamMember) {\n        setEditing(member)\n        setFormData({\n            name: member.name,\n            title: member.title,\n            bio: member.bio || '',\n            imageUrl: member.imageUrl || '',\n            order: member.order,\n            active: member.active,\n        })\n        setShowForm(true)\n    }\n\n    async function handleSubmit(e: React.FormEvent) {\n        e.preventDefault()\n        setLoading(true)\n\n        try {\n            if (editing) {\n                // Update\n                await fetch(`/api/team/${editing.id}`, {\n                    method: 'PATCH',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify(formData),\n                })\n            } else {\n                // Create\n                await fetch('/api/team', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify(formData),\n                })\n            }\n\n            setShowForm(false)\n            fetchTeamMembers()\n            showToast(editing ? 'Team member updated successfully!' : 'Team member created successfully!', 'success')\n        } catch (error) {\n            console.error('Error saving team member:', error)\n            showToast('Failed to save team member', 'error')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    async function handleDelete(id: string) {\n        // Find member name for confirmation message\n        const member = teamMembers.find(m => m.id === id)\n        const name = member ? member.name : 'this team member'\n\n        const confirmed = await confirm(\n            `Are you sure you want to delete ${name}? This action cannot be undone.`,\n            'Delete Team Member'\n        )\n\n        if (!confirmed) return\n\n        try {\n            await fetch(`/api/team/${id}`, { method: 'DELETE' })\n            showToast('Team member deleted successfully!', 'success')\n            fetchTeamMembers()\n        } catch (error) {\n            console.error('Error deleting team member:', error)\n            showToast('Failed to delete team member', 'error')\n        }\n    }\n\n    async function handleImageUpload(e: React.ChangeEvent<HTMLInputElement>) {\n        const file = e.target.files?.[0]\n        if (!file) return\n\n        setUploading(true)\n        const uploadFormData = new FormData()\n        uploadFormData.append('file', file)\n        uploadFormData.append('upload_preset', process.env.NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET || 'nrdc_team')\n\n        try {\n            const res = await fetch(\n                `https://api.cloudinary.com/v1_1/${process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME}/image/upload`,\n                {\n                    method: 'POST',\n                    body: uploadFormData,\n                }\n            )\n\n            const data = await res.json()\n            setFormData({ ...formData, imageUrl: data.secure_url })\n            showToast('Image uploaded successfully!', 'success')\n        } catch (error) {\n            console.error('Error uploading image:', error)\n            showToast('Failed to upload image', 'error')\n        } finally {\n            setUploading(false)\n        }\n    }\n\n    if (loading && !showForm) {\n        return <div className=\"text-center py-12\">Loading team members...</div>\n    }\n\n    return (\n        <div>\n            <div className=\"flex flex-col md:flex-row justify-between items-center mb-8 gap-4\">\n                <h1 className=\"text-3xl font-bold text-gray-900 flex items-center gap-2\">\n                    <Users size={32} className=\"text-[#6E8C82]\" />\n                    Team Management\n                </h1>\n                <div className=\"flex gap-4 w-full md:w-auto\">\n                    <div className=\"relative flex-1 md:w-64\">\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" size={20} />\n                        <input\n                            type=\"text\"\n                            placeholder=\"Search team...\"\n                            className=\"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                    </div>\n                    <button\n                        onClick={openCreateForm}\n                        className=\"bg-[#6E8C82] hover:bg-[#587068] text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors whitespace-nowrap\"\n                        disabled={uploading}\n                    >\n                        <Plus size={20} />\n                        Add Team Member\n                    </button>\n                </div>\n            </div>\n            <p className=\"text-gray-600 mt-1 mb-8\">Manage team members displayed on the About page</p>\n\n\n            {/* Team Members Grid */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {filteredMembers.map((member) => (\n                    <div\n                        key={member.id}\n                        className={`bg-white rounded-xl shadow-sm border p-6 ${!member.active ? 'opacity-50' : ''\n                            }`}\n                    >\n                        <div className=\"text-center\">\n                            {member.imageUrl ? (\n                                <Image\n                                    src={member.imageUrl}\n                                    alt={member.name}\n                                    width={120}\n                                    height={120}\n                                    className=\"w-24 h-24 rounded-full mx-auto mb-4 object-cover\"\n                                />\n                            ) : (\n                                <div className=\"w-24 h-24 rounded-full mx-auto mb-4 bg-gray-200 flex items-center justify-center\">\n                                    <Users size={40} className=\"text-gray-400\" />\n                                </div>\n                            )}\n                            <h3 className=\"font-bold text-lg text-gray-900\">{member.name}</h3>\n                            <p className=\"text-[#6E8C82] text-sm mb-2\">{member.title}</p>\n                            {member.bio && (\n                                <p className=\"text-gray-600 text-sm line-clamp-3\">{member.bio}</p>\n                            )}\n                        </div>\n                        <div className=\"flex gap-2 mt-4\">\n                            <button\n                                onClick={() => openEditForm(member)}\n                                className=\"flex-1 bg-[#6E8C82]/10 hover:bg-[#6E8C82]/20 text-[#587068] px-4 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm\"\n                            >\n                                <Edit size={16} />\n                                Edit\n                            </button>\n                            <button\n                                onClick={() => handleDelete(member.id)}\n                                className=\"flex-1 bg-red-50 hover:bg-red-100 text-red-700 px-4 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm\"\n                            >\n                                <Trash2 size={16} />\n                                Delete\n                            </button>\n                        </div>\n                    </div>\n                ))}\n            </div>\n\n            {/* Create/Edit Modal */}\n            {showForm && (\n                <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4\">\n                    <div className=\"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n                        <div className=\"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-center\">\n                            <h2 className=\"text-2xl font-bold text-gray-900\">\n                                {editing ? 'Edit Team Member' : 'Add Team Member'}\n                            </h2>\n                            <button\n                                onClick={() => setShowForm(false)}\n                                className=\"text-gray-400 hover:text-gray-600\"\n                            >\n                                <X size={24} />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                            <div>\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                                    Photo\n                                </label>\n                                <div className=\"flex items-center gap-4\">\n                                    {formData.imageUrl && (\n                                        <Image\n                                            src={formData.imageUrl}\n                                            alt=\"Preview\"\n                                            width={80}\n                                            height={80}\n                                            className=\"w-20 h-20 rounded-full object-cover\"\n                                        />\n                                    )}\n                                    <div>\n                                        <input\n                                            type=\"file\"\n                                            accept=\"image/*\"\n                                            onChange={handleImageUpload}\n                                            className=\"hidden\"\n                                            id=\"image-upload\"\n                                        />\n                                        <label\n                                            htmlFor=\"image-upload\"\n                                            className=\"cursor-pointer bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg flex items-center gap-2 transition-colors\"\n                                        >\n                                            {uploading ? (\n                                                <><Loader2 size={18} className=\"animate-spin\" /> Uploading...</>\n                                            ) : (\n                                                <><Upload size={18} /> Upload Photo</>\n                                            )}\n                                        </label>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                    Name *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    required\n                                    value={formData.name}\n                                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                    className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                    Title/Position *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    required\n                                    value={formData.title}\n                                    onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                                    className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                    Bio\n                                </label>\n                                <textarea\n                                    value={formData.bio}\n                                    onChange={(e) => setFormData({ ...formData, bio: e.target.value })}\n                                    rows={4}\n                                    className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                        Display Order\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={formData.order}\n                                        onChange={(e) => {\n                                            const val = parseInt(e.target.value)\n                                            setFormData({ ...formData, order: isNaN(val) ? 0 : val })\n                                        }}\n                                        className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\n                                        Status\n                                    </label>\n                                    <select\n                                        value={formData.active ? 'active' : 'inactive'}\n                                        onChange={(e) => setFormData({ ...formData, active: e.target.value === 'active' })}\n                                        className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] focus:border-transparent\"\n                                    >\n                                        <option value=\"active\">Active</option>\n                                        <option value=\"inactive\">Inactive</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div className=\"flex gap-3 pt-4\">\n                                <button\n                                    type=\"button\"\n                                    onClick={() => setShowForm(false)}\n                                    className=\"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-medium transition-colors\"\n                                >\n                                    Cancel\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading}\n                                    className=\"flex-1 bg-[#6E8C82] hover:bg-[#587068] text-white px-6 py-3 rounded-lg font-medium transition-colors disabled:opacity-50\"\n                                >\n                                    {loading ? 'Saving...' : editing ? 'Update' : 'Create'}\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/testimonials/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedTestimonial' is assigned a value but never used.","line":27,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":31},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchTestimonials` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/home/evans/Projects/NRDC/app/admin/testimonials/page.tsx:30:9\n  28 |\n  29 |     useEffect(() => {\n> 30 |         fetchTestimonials()\n     |         ^^^^^^^^^^^^^^^^^ `fetchTestimonials` accessed before it is declared\n  31 |     }, [])\n  32 |\n  33 |     async function fetchTestimonials() {\n\n/home/evans/Projects/NRDC/app/admin/testimonials/page.tsx:33:5\n  31 |     }, [])\n  32 |\n> 33 |     async function fetchTestimonials() {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 34 |         const res = await fetch('/api/testimonials?status=ALL')\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 35 |         const data = await res.json()\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 36 |         setTestimonials(data)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 37 |         setLoading(false)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 38 |     }\n     | ^^^^^^ `fetchTestimonials` is declared here\n  39 |\n  40 |     async function updateStatus(id: string, status: string) {\n  41 |         try {","line":30,"column":9,"nodeType":null,"endLine":30,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { MessageSquare, Check, X as XIcon, Trash2, Star } from 'lucide-react'\nimport { useToast } from '@/components/Toast'\nimport { useConfirm } from '@/components/ConfirmDialog'\n\ninterface Testimonial {\n    id: string\n    name: string\n    role: string | null\n    message: string\n    imageUrl: string | null\n    rating: number | null\n    status: string\n    order: number\n    createdAt: string\n    updatedAt: string\n}\n\nexport default function AdminTestimonialsPage() {\n    const { showToast } = useToast()\n    const { confirm } = useConfirm()\n    const [testimonials, setTestimonials] = useState<Testimonial[]>([])\n    const [filter, setFilter] = useState<'ALL' | 'PENDING' | 'APPROVED' | 'REJECTED'>('ALL')\n    const [loading, setLoading] = useState(true)\n    const [selectedTestimonial, setSelectedTestimonial] = useState<Testimonial | null>(null)\n\n    useEffect(() => {\n        fetchTestimonials()\n    }, [])\n\n    async function fetchTestimonials() {\n        const res = await fetch('/api/testimonials?status=ALL')\n        const data = await res.json()\n        setTestimonials(data)\n        setLoading(false)\n    }\n\n    async function updateStatus(id: string, status: string) {\n        try {\n            await fetch(`/api/testimonials/${id}`, {\n                method: 'PATCH',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ status }),\n            })\n            fetchTestimonials()\n            setSelectedTestimonial(null)\n            showToast(`Testimonial ${status.toLowerCase()} successfully!`, 'success')\n        } catch (error) {\n            console.error('Error updating testimonial:', error)\n            showToast('Failed to update testimonial', 'error')\n        }\n    }\n\n    async function handleDelete(id: string) {\n        const confirmed = await confirm(\n            'Are you sure you want to delete this testimonial? This action cannot be undone.',\n            'Delete Testimonial'\n        )\n\n        if (!confirmed) return\n\n        try {\n            await fetch(`/api/testimonials/${id}`, { method: 'DELETE' })\n            showToast('Testimonial deleted successfully!', 'success')\n            fetchTestimonials()\n        } catch (error) {\n            console.error('Error deleting testimonial:', error)\n            showToast('Failed to delete testimonial', 'error')\n        }\n    }\n\n    const filteredTestimonials = filter === 'ALL'\n        ? testimonials\n        : testimonials.filter(t => t.status === filter)\n\n    const pendingCount = testimonials.filter(t => t.status === 'PENDING').length\n\n    if (loading) {\n        return <div className=\"text-center py-12\">Loading testimonials...</div>\n    }\n\n    return (\n        <div>\n            <div className=\"flex justify-between items-center mb-8\">\n                <div>\n                    <h1 className=\"text-3xl font-bold text-gray-900 flex items-center gap-2\">\n                        <MessageSquare size={32} className=\"text-[#6E8C82]\" />\n                        Testimonials Management\n                    </h1>\n                    <p className=\"text-gray-600 mt-1\">\n                        Review and approve testimonials from users\n                        {pendingCount > 0 && (\n                            <span className=\"ml-2 bg-orange-100 text-orange-700 px-2 py-1 rounded text-sm font-medium\">\n                                {pendingCount} pending\n                            </span>\n                        )}\n                    </p>\n                </div>\n            </div>\n\n            {/* Filter Tabs */}\n            <div className=\"flex gap-2 mb-6\">\n                {(['ALL', 'PENDING', 'APPROVED', 'REJECTED'] as const).map((status) => (\n                    <button\n                        key={status}\n                        onClick={() => setFilter(status)}\n                        className={`px-4 py-2 rounded-lg font-medium transition-colors ${filter === status\n                            ? 'bg-[#6E8C82] text-white'\n                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                            }`}\n                    >\n                        {status}\n                        {status !== 'ALL' && (\n                            <span className=\"ml-2\">\n                                ({testimonials.filter(t => t.status === status).length})\n                            </span>\n                        )}\n                    </button>\n                ))}\n            </div>\n\n            {/* Testimonials Grid */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {filteredTestimonials.map((testimonial) => (\n                    <div\n                        key={testimonial.id}\n                        className={`bg-white rounded-xl shadow-sm border-2 p-6 ${testimonial.status === 'PENDING'\n                            ? 'border-orange-200'\n                            : testimonial.status === 'APPROVED'\n                                ? 'border-green-200'\n                                : 'border-red-200'\n                            }`}\n                    >\n                        <div className=\"flex items-start justify-between mb-4\">\n                            <div>\n                                <h3 className=\"font-bold text-gray-900\">{testimonial.name}</h3>\n                                {testimonial.role && (\n                                    <p className=\"text-sm text-gray-600\">{testimonial.role}</p>\n                                )}\n                            </div>\n                            {testimonial.rating && (\n                                <div className=\"flex items-center gap-1\">\n                                    {Array.from({ length: testimonial.rating }).map((_, i) => (\n                                        <Star key={i} size={14} className=\"fill-yellow-400 text-yellow-400\" />\n                                    ))}\n                                </div>\n                            )}\n                        </div>\n\n                        <p className=\"text-gray-700 text-sm line-clamp-4 mb-4\">{testimonial.message}</p>\n\n                        <div className=\"flex items-center justify-between text-xs text-gray-500 mb-4\">\n                            <span>{new Date(testimonial.createdAt).toLocaleDateString()}</span>\n                            <span\n                                className={`px-2 py-1 rounded ${testimonial.status === 'PENDING'\n                                    ? 'bg-orange-100 text-orange-700'\n                                    : testimonial.status === 'APPROVED'\n                                        ? 'bg-green-100 text-green-700'\n                                        : 'bg-red-100 text-red-700'\n                                    }`}\n                            >\n                                {testimonial.status}\n                            </span>\n                        </div>\n\n                        <div className=\"flex gap-2\">\n                            {testimonial.status !== 'APPROVED' && (\n                                <button\n                                    onClick={() => updateStatus(testimonial.id, 'APPROVED')}\n                                    className=\"flex-1 bg-green-50 hover:bg-green-100 text-green-700 px-3 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm\"\n                                >\n                                    <Check size={16} />\n                                    Approve\n                                </button>\n                            )}\n                            {testimonial.status !== 'REJECTED' && (\n                                <button\n                                    onClick={() => updateStatus(testimonial.id, 'REJECTED')}\n                                    className=\"flex-1 bg-red-50 hover:bg-red-100 text-red-700 px-3 py-2 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm\"\n                                >\n                                    <XIcon size={16} />\n                                    Reject\n                                </button>\n                            )}\n                            <button\n                                onClick={() => handleDelete(testimonial.id)}\n                                className=\"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-lg transition-colors\"\n                            >\n                                <Trash2 size={16} />\n                            </button>\n                        </div>\n                    </div>\n                ))}\n            </div>\n\n            {filteredTestimonials.length === 0 && (\n                <div className=\"text-center py-12 text-gray-500\">\n                    No {filter.toLowerCase()} testimonials found.\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/translations/page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchTranslations'. Either include it or remove the dependency array.","line":34,"column":8,"nodeType":"ArrayExpression","endLine":34,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [fetchTranslations, selectedLocale, selectedNamespace]","fix":{"range":[969,1004],"text":"[fetchTranslations, selectedLocale, selectedNamespace]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Plus, Search, Save, Trash2, X } from 'lucide-react'\n\ninterface Translation {\n    id: string\n    namespace: string\n    key: string\n    locale: string\n    value: string\n}\n\nexport default function TranslationsPage() {\n    const [translations, setTranslations] = useState<Translation[]>([])\n    const [loading, setLoading] = useState(true)\n    const [searchTerm, setSearchTerm] = useState('')\n    const [selectedLocale, setSelectedLocale] = useState('en')\n    const [selectedNamespace, setSelectedNamespace] = useState('')\n\n    const [isEditing, setIsEditing] = useState<string | null>(null)\n    const [editValue, setEditValue] = useState('')\n\n    const [isAdding, setIsAdding] = useState(false)\n    const [newTranslation, setNewTranslation] = useState({\n        namespace: 'common',\n        key: '',\n        locale: 'en',\n        value: ''\n    })\n\n    useEffect(() => {\n        fetchTranslations()\n    }, [selectedLocale, selectedNamespace])\n\n    async function fetchTranslations() {\n        setLoading(true)\n        try {\n            let url = `/api/translations?locale=${selectedLocale}`\n            if (selectedNamespace) url += `&namespace=${selectedNamespace}`\n\n            const res = await fetch(url)\n            const data = await res.json()\n            setTranslations(Array.isArray(data) ? data : [])\n        } catch (error) {\n            console.error('Error fetching translations:', error)\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    async function handleSave(id: string, key: string, namespace: string, locale: string, value: string) {\n        try {\n            const res = await fetch('/api/translations', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ key, namespace, locale, value })\n            })\n\n            if (res.ok) {\n                setTranslations(translations.map(t => t.id === id ? { ...t, value } : t))\n                setIsEditing(null)\n            }\n        } catch (error) {\n            console.error('Error saving translation:', error)\n        }\n    }\n\n    async function handleAdd() {\n        try {\n            const res = await fetch('/api/translations', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(newTranslation)\n            })\n\n            if (res.ok) {\n                const added = await res.json()\n                setTranslations([...translations, added])\n                setIsAdding(false)\n                setNewTranslation({ namespace: 'common', key: '', locale: 'en', value: '' })\n            }\n        } catch (error) {\n            console.error('Error adding translation:', error)\n        }\n    }\n\n    async function handleDelete(id: string) {\n        if (!confirm('Are you sure you want to delete this translation?')) return\n\n        try {\n            const res = await fetch(`/api/translations?id=${id}`, {\n                method: 'DELETE'\n            })\n\n            if (res.ok) {\n                setTranslations(translations.filter(t => t.id !== id))\n            }\n        } catch (error) {\n            console.error('Error deleting translation:', error)\n        }\n    }\n\n    const filteredTranslations = translations.filter(t =>\n        t.key.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        t.value.toLowerCase().includes(searchTerm.toLowerCase())\n    )\n\n    return (\n        <div className=\"p-6\">\n            <div className=\"flex justify-between items-center mb-6\">\n                <h1 className=\"text-2xl font-bold text-gray-900\">Translations Management</h1>\n                <button\n                    onClick={() => setIsAdding(true)}\n                    className=\"bg-[#6E8C82] text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-[#587068] transition-colors\"\n                >\n                    <Plus size={20} />\n                    Add Translation\n                </button>\n            </div>\n\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-4 mb-6\">\n                <div className=\"flex flex-col md:flex-row gap-4\">\n                    <div className=\"flex-1 relative\">\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" size={20} />\n                        <input\n                            type=\"text\"\n                            placeholder=\"Search keys or values...\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                            className=\"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6E8C82]\"\n                        />\n                    </div>\n                    <select\n                        value={selectedLocale}\n                        onChange={(e) => setSelectedLocale(e.target.value)}\n                        className=\"px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6E8C82]\"\n                    >\n                        <option value=\"en\">English (en)</option>\n                        <option value=\"fr\">French (fr)</option>\n                    </select>\n                    <input\n                        type=\"text\"\n                        placeholder=\"Filter by namespace...\"\n                        value={selectedNamespace}\n                        onChange={(e) => setSelectedNamespace(e.target.value)}\n                        className=\"px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6E8C82]\"\n                    />\n                </div>\n            </div>\n\n            {isAdding && (\n                <div className=\"bg-[#6E8C82]/10 p-4 rounded-xl border border-blue-100 mb-6\">\n                    <h3 className=\"font-semibold mb-4\">New Translation</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4\">\n                        <input\n                            type=\"text\"\n                            placeholder=\"Namespace (e.g. common)\"\n                            value={newTranslation.namespace}\n                            onChange={(e) => setNewTranslation({ ...newTranslation, namespace: e.target.value })}\n                            className=\"px-3 py-2 border rounded-lg\"\n                        />\n                        <input\n                            type=\"text\"\n                            placeholder=\"Key (e.g. hero.title)\"\n                            value={newTranslation.key}\n                            onChange={(e) => setNewTranslation({ ...newTranslation, key: e.target.value })}\n                            className=\"px-3 py-2 border rounded-lg\"\n                        />\n                        <select\n                            value={newTranslation.locale}\n                            onChange={(e) => setNewTranslation({ ...newTranslation, locale: e.target.value })}\n                            className=\"px-3 py-2 border rounded-lg\"\n                        >\n                            <option value=\"en\">English</option>\n                            <option value=\"fr\">French</option>\n                        </select>\n                        <input\n                            type=\"text\"\n                            placeholder=\"Value\"\n                            value={newTranslation.value}\n                            onChange={(e) => setNewTranslation({ ...newTranslation, value: e.target.value })}\n                            className=\"px-3 py-2 border rounded-lg\"\n                        />\n                    </div>\n                    <div className=\"flex justify-end gap-2\">\n                        <button\n                            onClick={() => setIsAdding(false)}\n                            className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg\"\n                        >\n                            Cancel\n                        </button>\n                        <button\n                            onClick={handleAdd}\n                            className=\"px-4 py-2 bg-[#6E8C82] text-white rounded-lg hover:bg-[#587068]\"\n                        >\n                            Save\n                        </button>\n                    </div>\n                </div>\n            )}\n\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\n                <table className=\"w-full text-left\">\n                    <thead className=\"bg-gray-50 border-b border-gray-100\">\n                        <tr>\n                            <th className=\"px-6 py-3 text-xs font-semibold text-gray-500 uppercase\">Namespace</th>\n                            <th className=\"px-6 py-3 text-xs font-semibold text-gray-500 uppercase\">Key</th>\n                            <th className=\"px-6 py-3 text-xs font-semibold text-gray-500 uppercase\">Value</th>\n                            <th className=\"px-6 py-3 text-xs font-semibold text-gray-500 uppercase text-right\">Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-gray-100\">\n                        {loading ? (\n                            <tr>\n                                <td colSpan={4} className=\"px-6 py-8 text-center text-gray-500\">Loading translations...</td>\n                            </tr>\n                        ) : filteredTranslations.length === 0 ? (\n                            <tr>\n                                <td colSpan={4} className=\"px-6 py-8 text-center text-gray-500\">No translations found.</td>\n                            </tr>\n                        ) : (\n                            filteredTranslations.map((t) => (\n                                <tr key={t.id} className=\"hover:bg-gray-50\">\n                                    <td className=\"px-6 py-4 text-sm text-gray-600\">{t.namespace}</td>\n                                    <td className=\"px-6 py-4 text-sm font-medium text-gray-900\">{t.key}</td>\n                                    <td className=\"px-6 py-4 text-sm text-gray-600\">\n                                        {isEditing === t.id ? (\n                                            <input\n                                                type=\"text\"\n                                                value={editValue}\n                                                onChange={(e) => setEditValue(e.target.value)}\n                                                className=\"w-full px-2 py-1 border rounded focus:outline-none focus:ring-2 focus:ring-[#6E8C82]\"\n                                                autoFocus\n                                            />\n                                        ) : (\n                                            t.value\n                                        )}\n                                    </td>\n                                    <td className=\"px-6 py-4 text-right\">\n                                        {isEditing === t.id ? (\n                                            <div className=\"flex justify-end gap-2\">\n                                                <button\n                                                    onClick={() => handleSave(t.id, t.key, t.namespace, t.locale, editValue)}\n                                                    className=\"text-green-600 hover:bg-green-50 p-1 rounded\"\n                                                >\n                                                    <Save size={18} />\n                                                </button>\n                                                <button\n                                                    onClick={() => setIsEditing(null)}\n                                                    className=\"text-gray-400 hover:bg-gray-100 p-1 rounded\"\n                                                >\n                                                    <X size={18} />\n                                                </button>\n                                            </div>\n                                        ) : (\n                                            <div className=\"flex justify-end gap-2\">\n                                                <button\n                                                    onClick={() => {\n                                                        setIsEditing(t.id)\n                                                        setEditValue(t.value)\n                                                    }}\n                                                    className=\"text-[#6E8C82] hover:bg-[#6E8C82]/10 p-1 rounded\"\n                                                >\n                                                    Edit\n                                                </button>\n                                                <button\n                                                    onClick={() => handleDelete(t.id)}\n                                                    className=\"text-red-500 hover:bg-red-50 p-1 rounded\"\n                                                >\n                                                    <Trash2 size={18} />\n                                                </button>\n                                            </div>\n                                        )}\n                                    </td>\n                                </tr>\n                            ))\n                        )}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/admin/users/page.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchUsers` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/home/evans/Projects/NRDC/app/admin/users/page.tsx:35:9\n  33 |\n  34 |     useEffect(() => {\n> 35 |         fetchUsers()\n     |         ^^^^^^^^^^ `fetchUsers` accessed before it is declared\n  36 |     }, [])\n  37 |\n  38 |     async function fetchUsers() {\n\n/home/evans/Projects/NRDC/app/admin/users/page.tsx:38:5\n  36 |     }, [])\n  37 |\n> 38 |     async function fetchUsers() {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 39 |         const res = await fetch('/api/users')\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |         if (res.ok) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |             const data = await res.json()\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 42 |             setUsers(data)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 43 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 44 |         setLoading(false)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 45 |     }\n     | ^^^^^^ `fetchUsers` is declared here\n  46 |\n  47 |     async function handleSubmit(e: React.FormEvent) {\n  48 |         e.preventDefault()","line":35,"column":9,"nodeType":null,"endLine":35,"endColumn":19},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":280,"column":43,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12858,12943],"text":"\n                    No users found. Click &quot;Add User\" to create one.\n                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12858,12943],"text":"\n                    No users found. Click &ldquo;Add User\" to create one.\n                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12858,12943],"text":"\n                    No users found. Click &#34;Add User\" to create one.\n                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12858,12943],"text":"\n                    No users found. Click &rdquo;Add User\" to create one.\n                "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":280,"column":52,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12858,12943],"text":"\n                    No users found. Click \"Add User&quot; to create one.\n                "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12858,12943],"text":"\n                    No users found. Click \"Add User&ldquo; to create one.\n                "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12858,12943],"text":"\n                    No users found. Click \"Add User&#34; to create one.\n                "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12858,12943],"text":"\n                    No users found. Click \"Add User&rdquo; to create one.\n                "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Plus, Trash2, User, Shield, Edit, X, Check } from 'lucide-react'\nimport { useToast } from '@/components/Toast'\nimport { useConfirm } from '@/components/ConfirmDialog'\n\ninterface UserData {\n    id: string\n    name: string\n    email: string\n    role: string\n    createdAt: string\n}\n\nconst ROLES = ['ADMIN', 'EDITOR', 'VIEWER']\n\nexport default function AdminUsersPage() {\n    const { showToast } = useToast()\n    const { confirm } = useConfirm()\n    const [users, setUsers] = useState<UserData[]>([])\n    const [loading, setLoading] = useState(true)\n    const [showForm, setShowForm] = useState(false)\n    const [editingId, setEditingId] = useState<string | null>(null)\n    const [editRole, setEditRole] = useState('')\n    const [formData, setFormData] = useState({\n        name: '',\n        email: '',\n        password: '',\n        role: 'EDITOR'\n    })\n    const [error, setError] = useState('')\n\n    useEffect(() => {\n        fetchUsers()\n    }, [])\n\n    async function fetchUsers() {\n        const res = await fetch('/api/users')\n        if (res.ok) {\n            const data = await res.json()\n            setUsers(data)\n        }\n        setLoading(false)\n    }\n\n    async function handleSubmit(e: React.FormEvent) {\n        e.preventDefault()\n        setError('')\n\n        const res = await fetch('/api/users', {\n            method: 'POST',\n            body: JSON.stringify(formData),\n            headers: { 'Content-Type': 'application/json' }\n        })\n\n        if (res.ok) {\n            setShowForm(false)\n            setFormData({ name: '', email: '', password: '', role: 'EDITOR' })\n            fetchUsers()\n            showToast('User created successfully!', 'success')\n        } else {\n            const data = await res.json()\n            setError(data.error || 'Failed to create user')\n        }\n    }\n\n    async function handleDelete(id: string, name: string) {\n        const confirmed = await confirm(\n            `Are you sure you want to delete ${name || 'this user'}? This action cannot be undone.`,\n            'Delete User'\n        )\n\n        if (!confirmed) return\n\n        const res = await fetch(`/api/users?id=${id}`, {\n            method: 'DELETE'\n        })\n\n        if (res.ok) {\n            fetchUsers()\n            showToast('User deleted successfully!', 'success')\n        } else {\n            const data = await res.json()\n            showToast(data.error || 'Failed to delete user', 'error')\n        }\n    }\n\n    async function handleUpdateRole(id: string) {\n        const res = await fetch('/api/users', {\n            method: 'PATCH',\n            body: JSON.stringify({ id, role: editRole }),\n            headers: { 'Content-Type': 'application/json' }\n        })\n\n        if (res.ok) {\n            setEditingId(null)\n            fetchUsers()\n            showToast('User role updated successfully!', 'success')\n        } else {\n            const data = await res.json()\n            showToast(data.error || 'Failed to update role', 'error')\n        }\n    }\n\n    function startEditRole(user: UserData) {\n        setEditingId(user.id)\n        setEditRole(user.role)\n    }\n\n    function cancelEdit() {\n        setEditingId(null)\n        setEditRole('')\n    }\n\n    if (loading) return <div className=\"p-8 text-center\">Loading...</div>\n\n    return (\n        <div>\n            <div className=\"flex justify-between items-center mb-8\">\n                <div>\n                    <h1 className=\"text-3xl font-bold text-gray-900\">User Management</h1>\n                    <p className=\"text-gray-600 mt-1\">Manage admin users and their permissions</p>\n                </div>\n                <button\n                    onClick={() => setShowForm(!showForm)}\n                    className=\"bg-[#6E8C82] hover:bg-[#587068] text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors\"\n                >\n                    <Plus size={20} />\n                    {showForm ? 'Cancel' : 'Add User'}\n                </button>\n            </div>\n\n            {/* Role Legend */}\n            <div className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-100 mb-6\">\n                <h3 className=\"font-semibold text-gray-700 mb-3\">Role Permissions</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n                    <div className=\"flex items-start gap-2\">\n                        <span className=\"bg-red-100 text-red-700 px-2 py-1 rounded font-medium\">ADMIN</span>\n                        <span className=\"text-gray-600\">Full access to all features, user management, and settings</span>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                        <span className=\"bg-[#6E8C82]/20 text-[#587068] px-2 py-1 rounded font-medium\">EDITOR</span>\n                        <span className=\"text-gray-600\">Can create and edit content (blogs, programs, gallery)</span>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                        <span className=\"bg-gray-100 text-gray-700 px-2 py-1 rounded font-medium\">VIEWER</span>\n                        <span className=\"text-gray-600\">Read-only access to dashboard and analytics</span>\n                    </div>\n                </div>\n            </div>\n\n            {showForm && (\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-8 max-w-2xl\">\n                    <h2 className=\"text-xl font-bold mb-4\">Create New User</h2>\n                    {error && <div className=\"bg-red-50 text-red-600 p-3 rounded-lg mb-4 text-sm\">{error}</div>}\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Name</label>\n                            <input\n                                type=\"text\"\n                                required\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                value={formData.name}\n                                onChange={e => setFormData({ ...formData, name: e.target.value })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Email</label>\n                            <input\n                                type=\"email\"\n                                required\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                value={formData.email}\n                                onChange={e => setFormData({ ...formData, email: e.target.value })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Password</label>\n                            <input\n                                type=\"password\"\n                                required\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                value={formData.password}\n                                onChange={e => setFormData({ ...formData, password: e.target.value })}\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Role</label>\n                            <select\n                                className=\"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                value={formData.role}\n                                onChange={e => setFormData({ ...formData, role: e.target.value })}\n                            >\n                                {ROLES.map(role => (\n                                    <option key={role} value={role}>{role}</option>\n                                ))}\n                            </select>\n                        </div>\n                        <button type=\"submit\" className=\"bg-[#2E8B57] text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors\">\n                            Create User\n                        </button>\n                    </form>\n                </div>\n            )}\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {users.map(user => (\n                    <div key={user.id} className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                            <div className=\"bg-[#6E8C82]/10 p-3 rounded-full text-[#6E8C82]\">\n                                <User size={24} />\n                            </div>\n\n                            {editingId === user.id ? (\n                                <div className=\"flex items-center gap-2\">\n                                    <select\n                                        className=\"px-2 py-1 rounded border border-gray-300 text-sm focus:ring-2 focus:ring-[#6E8C82] outline-none\"\n                                        value={editRole}\n                                        onChange={e => setEditRole(e.target.value)}\n                                    >\n                                        {ROLES.map(role => (\n                                            <option key={role} value={role}>{role}</option>\n                                        ))}\n                                    </select>\n                                    <button\n                                        onClick={() => handleUpdateRole(user.id)}\n                                        className=\"p-1 text-green-600 hover:bg-green-50 rounded\"\n                                        title=\"Save\"\n                                    >\n                                        <Check size={18} />\n                                    </button>\n                                    <button\n                                        onClick={cancelEdit}\n                                        className=\"p-1 text-gray-600 hover:bg-gray-50 rounded\"\n                                        title=\"Cancel\"\n                                    >\n                                        <X size={18} />\n                                    </button>\n                                </div>\n                            ) : (\n                                <button\n                                    onClick={() => startEditRole(user)}\n                                    className={`px-3 py-1 rounded-full text-xs font-semibold flex items-center gap-1 cursor-pointer hover:opacity-80 transition-opacity ${user.role === 'ADMIN'\n                                        ? 'bg-red-100 text-red-700'\n                                        : user.role === 'EDITOR'\n                                            ? 'bg-[#6E8C82]/20 text-[#587068]'\n                                            : 'bg-gray-100 text-gray-700'\n                                        }`}\n                                    title=\"Click to edit role\"\n                                >\n                                    <Shield size={12} />\n                                    {user.role}\n                                    <Edit size={10} className=\"ml-1\" />\n                                </button>\n                            )}\n                        </div>\n\n                        <h3 className=\"text-lg font-bold text-gray-900\">{user.name || 'Unnamed User'}</h3>\n                        <p className=\"text-gray-600 text-sm mb-4\">{user.email}</p>\n\n                        <div className=\"mt-auto pt-4 border-t border-gray-100 flex justify-between items-center text-sm\">\n                            <span className=\"text-gray-500\">\n                                Joined {new Date(user.createdAt).toLocaleDateString()}\n                            </span>\n                            <button\n                                onClick={() => handleDelete(user.id, user.name)}\n                                className=\"text-red-600 hover:text-red-800 p-2 hover:bg-red-50 rounded-lg transition-colors\"\n                                title=\"Delete User\"\n                            >\n                                <Trash2 size={18} />\n                            </button>\n                        </div>\n                    </div>\n                ))}\n            </div>\n\n            {users.length === 0 && (\n                <div className=\"text-center py-12 text-gray-500\">\n                    No users found. Click \"Add User\" to create one.\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/ads/manage/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/ads/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/ads/track/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/analytics/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/audit/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":17,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\nimport { getSession } from '@/lib/auth';\n\nexport async function GET() {\n    const session = await getSession();\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 });\n    }\n\n    try {\n        const logs = await prisma.auditLog.findMany({\n            orderBy: { createdAt: 'desc' },\n            take: 100, // Limit to last 100 logs\n        });\n        return NextResponse.json(logs);\n    } catch (error) {\n        return NextResponse.json({ error: 'Failed to fetch audit logs' }, { status: 500 });\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/auth/forgot-password/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/auth/login/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":41,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":41,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { signToken } from '@/lib/auth'\nimport bcrypt from 'bcrypt'\nimport { cookies } from 'next/headers'\nimport { logAudit } from '@/lib/audit'\n\nexport async function POST(request: Request) {\n    try {\n        const { email, password } = await request.json()\n\n        const user = await prisma.user.findUnique({\n            where: { email },\n        })\n\n        if (!user) {\n            return NextResponse.json({ error: 'Invalid credentials' }, { status: 401 })\n        }\n\n        const validPassword = await bcrypt.compare(password, user.password)\n\n        if (!validPassword) {\n            return NextResponse.json({ error: 'Invalid credentials' }, { status: 401 })\n        }\n\n        const token = signToken({ id: user.id, userId: user.id, email: user.email, role: user.role })\n\n        const cookieStore = await cookies()\n        cookieStore.set('token', token, {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === 'production',\n            sameSite: 'strict',\n            maxAge: 86400, // 1 day\n            path: '/',\n        })\n\n\n        await logAudit('LOGIN', 'User', user.id, { userId: user.id, details: { email: user.email } })\n\n        return NextResponse.json({ success: true, user: { email: user.email, name: user.name, role: user.role } })\n    } catch (error) {\n        return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/auth/me/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/auth/reset-password/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/blogs/[id]/history/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":21,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\n\nexport async function GET(\n    request: Request,\n    { params }: { params: Promise<{ id: string }> }\n) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { id } = await params\n        const history = await prisma.postHistory.findMany({\n            where: { postId: id },\n            orderBy: { createdAt: 'desc' },\n        })\n        return NextResponse.json(history)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error fetching history' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/blogs/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":70,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":109,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3696,3699],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3696,3699],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":126,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":126,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":148,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":148,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\nimport { logAudit } from '@/lib/audit'\n\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url)\n    const category = searchParams.get('category')\n    const locale = searchParams.get('locale')\n\n    const session = await getSession()\n    const isAdmin = session && session.role === 'ADMIN'\n\n    const where = category ? { category, ...(isAdmin ? {} : { published: true }) } : (isAdmin ? {} : { published: true })\n\n    try {\n        const blogs = await prisma.blogPost.findMany({\n            where,\n            include: {\n                translations: locale ? {\n                    where: { locale }\n                } : false\n            },\n            orderBy: { createdAt: 'desc' },\n        })\n\n        const translatedBlogs = blogs.map(post => {\n            if (!locale) return post;\n            const translation = post.translations?.[0];\n            return {\n                ...post,\n                title: translation?.title || post.title,\n                content: translation?.content || post.content,\n                excerpt: translation?.excerpt || post.excerpt,\n                translations: undefined // Remove translations from response\n            }\n        })\n\n        return NextResponse.json(translatedBlogs)\n    } catch (error) {\n        console.error('Error fetching blog posts:', error)\n        return NextResponse.json({ error: 'Failed to fetch blog posts' }, { status: 500 })\n    }\n}\n\nexport async function POST(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const body = await request.json()\n        const blog = await prisma.blogPost.create({\n            data: {\n                title: body.title,\n                slug: body.slug,\n                content: body.content,\n                excerpt: body.excerpt,\n                category: body.category,\n                image: body.image,\n                tags: body.tags,\n                published: body.published || false,\n            },\n        })\n\n        await logAudit('CREATE', 'BlogPost', blog.id, { userId: session.userId, details: { title: blog.title } })\n\n        return NextResponse.json(blog)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error creating blog post' }, { status: 500 })\n    }\n}\n\nexport async function PUT(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { searchParams } = new URL(request.url)\n        const id = searchParams.get('id')\n        if (!id) {\n            return NextResponse.json({ error: 'ID required' }, { status: 400 })\n        }\n\n        const body = await request.json()\n\n        // Fetch current post to save history\n        const currentPost = await prisma.blogPost.findUnique({ where: { id } })\n\n        if (currentPost) {\n            await prisma.postHistory.create({\n                data: {\n                    postId: currentPost.id,\n                    title: currentPost.title,\n                    content: currentPost.content,\n                    excerpt: currentPost.excerpt,\n                    image: currentPost.image,\n                    category: currentPost.category,\n                    tags: currentPost.tags,\n                    editorId: session.userId,\n                }\n            })\n        }\n\n        // Allow partial updates\n        const updateData: any = {}\n        if (body.title !== undefined) updateData.title = body.title\n        if (body.slug !== undefined) updateData.slug = body.slug\n        if (body.content !== undefined) updateData.content = body.content\n        if (body.excerpt !== undefined) updateData.excerpt = body.excerpt\n        if (body.category !== undefined) updateData.category = body.category\n        if (body.tags !== undefined) updateData.tags = body.tags\n        if (body.published !== undefined) updateData.published = body.published\n\n        const blog = await prisma.blogPost.update({\n            where: { id },\n            data: updateData,\n        })\n\n        await logAudit('UPDATE', 'BlogPost', blog.id, { userId: session.userId, details: { title: blog.title, changes: Object.keys(updateData) } })\n\n        return NextResponse.json(blog)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error updating blog post' }, { status: 500 })\n    }\n}\n\nexport async function DELETE(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { searchParams } = new URL(request.url)\n        const id = searchParams.get('id')\n        if (!id) {\n            return NextResponse.json({ error: 'ID required' }, { status: 400 })\n        }\n\n        await prisma.blogPost.delete({ where: { id } })\n        await logAudit('DELETE', 'BlogPost', id, { userId: session.userId })\n\n        return NextResponse.json({ success: true })\n    } catch (error) {\n        return NextResponse.json({ error: 'Error deleting blog post' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/contact/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":39,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\nimport { sendContactConfirmation, sendContactAlertToAdmin } from '@/lib/email'\n\nexport async function POST(request: Request) {\n    try {\n        const body = await request.json()\n        const submission = await prisma.contactSubmission.create({\n            data: {\n                name: body.name,\n                email: body.email,\n                message: body.message,\n            },\n        })\n\n        // Send email notifications\n        try {\n            // Send confirmation to submitter\n            await sendContactConfirmation({\n                name: body.name,\n                email: body.email,\n            })\n\n            // Send alert to admin\n            await sendContactAlertToAdmin({\n                name: body.name,\n                email: body.email,\n                message: body.message,\n            })\n\n            console.log(`âœ… Contact form submitted and emails sent: ${submission.id}`)\n        } catch (emailError) {\n            console.error('Email sending failed:', emailError)\n            // Don't fail the contact submission if email fails\n        }\n\n        return NextResponse.json({ success: true, id: submission.id })\n    } catch (error) {\n        return NextResponse.json({ error: 'Error submitting form' }, { status: 500 })\n    }\n}\n\nexport async function GET() {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    const submissions = await prisma.contactSubmission.findMany({\n        orderBy: { createdAt: 'desc' },\n    })\n    return NextResponse.json(submissions)\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/content/[key]/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/content/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getSession' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\n\n// GET /api/content - Get all site content or filter by keys\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url)\n    const keys = searchParams.get('keys')?.split(',')\n    const locale = searchParams.get('locale')\n\n    try {\n        const where = keys ? { key: { in: keys } } : {}\n        const content = await prisma.siteContent.findMany({\n            where,\n            include: {\n                translations: locale ? {\n                    where: { locale }\n                } : false\n            }\n        })\n\n        // Convert array to object for easier access\n        const contentMap = content.reduce((acc, item) => {\n            const translation = item.translations?.[0];\n            acc[item.key] = translation?.value || item.value\n            return acc\n        }, {} as Record<string, string>)\n\n        return NextResponse.json(contentMap)\n    } catch (error) {\n        console.error('Error fetching site content:', error)\n        return NextResponse.json({ error: 'Failed to fetch site content' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/donations/records/route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[720,723],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[720,723],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\n\nexport async function GET(request: Request) {\n    try {\n        // Verify admin authentication\n        const session = await getSession()\n        if (!session) {\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n        }\n\n        const { searchParams } = new URL(request.url)\n        const status = searchParams.get('status')\n        const method = searchParams.get('method')\n        const limit = parseInt(searchParams.get('limit') || '50')\n        const offset = parseInt(searchParams.get('offset') || '0')\n\n        // Build filter conditions\n        const where: any = {}\n        if (status) where.paymentStatus = status\n        if (method) where.paymentMethod = method\n\n        // Fetch donations with filters\n        const [donations, total] = await Promise.all([\n            prisma.donation.findMany({\n                where,\n                orderBy: { createdAt: 'desc' },\n                take: limit,\n                skip: offset,\n            }),\n            prisma.donation.count({ where }),\n        ])\n\n        return NextResponse.json({\n            donations,\n            total,\n            limit,\n            offset,\n        })\n    } catch (error) {\n        console.error('Error fetching donations:', error)\n        return NextResponse.json(\n            { error: 'Failed to fetch donations' },\n            { status: 500 }\n        )\n    }\n}\n\n// Update donation status (for manual intervention)\nexport async function PATCH(request: Request) {\n    try {\n        const session = await getSession()\n        if (!session) {\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n        }\n\n        const { id, status } = await request.json()\n\n        if (!id || !status) {\n            return NextResponse.json(\n                { error: 'Missing id or status' },\n                { status: 400 }\n            )\n        }\n\n        const validStatuses = ['pending', 'completed', 'failed', 'refunded']\n        if (!validStatuses.includes(status)) {\n            return NextResponse.json(\n                { error: 'Invalid status' },\n                { status: 400 }\n            )\n        }\n\n        const donation = await prisma.donation.update({\n            where: { id },\n            data: { paymentStatus: status },\n        })\n\n        return NextResponse.json(donation)\n    } catch (error) {\n        console.error('Error updating donation:', error)\n        return NextResponse.json(\n            { error: 'Failed to update donation' },\n            { status: 500 }\n        )\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/donations/stats/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":30,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":53,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":77,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":101,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":101,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\n\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url)\n    const locale = searchParams.get('locale')\n\n    try {\n        const stats = await prisma.donationStat.findMany({\n            include: {\n                translations: locale ? {\n                    where: { locale }\n                } : false\n            },\n            orderBy: { order: 'asc' }\n        })\n\n        const translatedStats = stats.map(stat => {\n            if (!locale) return stat;\n            const translation = stat.translations?.[0];\n            return {\n                ...stat,\n                label: translation?.label || stat.label,\n                translations: undefined\n            }\n        })\n\n        return NextResponse.json(translatedStats)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error fetching donation stats' }, { status: 500 })\n    }\n}\n\nexport async function POST(request: Request) {\n    const session = await getSession()\n    if (!session || !['ADMIN', 'EDITOR'].includes(session.role)) {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { value, label, order } = await request.json()\n\n        const stat = await prisma.donationStat.create({\n            data: {\n                value,\n                label,\n                order: parseInt(order) || 0\n            }\n        })\n\n        return NextResponse.json(stat)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error creating donation stat' }, { status: 500 })\n    }\n}\n\nexport async function PUT(request: Request) {\n    const session = await getSession()\n    if (!session || !['ADMIN', 'EDITOR'].includes(session.role)) {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { id, value, label, order } = await request.json()\n\n        const stat = await prisma.donationStat.update({\n            where: { id },\n            data: {\n                value,\n                label,\n                order: parseInt(order)\n            }\n        })\n\n        return NextResponse.json(stat)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error updating donation stat' }, { status: 500 })\n    }\n}\n\nexport async function DELETE(request: Request) {\n    const session = await getSession()\n    if (!session || !['ADMIN', 'EDITOR'].includes(session.role)) {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { searchParams } = new URL(request.url)\n        const id = searchParams.get('id')\n\n        if (!id) {\n            return NextResponse.json({ error: 'ID is required' }, { status: 400 })\n        }\n\n        await prisma.donationStat.delete({\n            where: { id }\n        })\n\n        return NextResponse.json({ success: true })\n    } catch (error) {\n        return NextResponse.json({ error: 'Error deleting donation stat' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/donations/tiers/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":30,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":54,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":79,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":103,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":103,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\n\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url)\n    const locale = searchParams.get('locale')\n\n    try {\n        const tiers = await prisma.donationTier.findMany({\n            include: {\n                translations: locale ? {\n                    where: { locale }\n                } : false\n            },\n            orderBy: { order: 'asc' }\n        })\n\n        const translatedTiers = tiers.map(tier => {\n            if (!locale) return tier;\n            const translation = tier.translations?.[0];\n            return {\n                ...tier,\n                description: translation?.description || tier.description,\n                translations: undefined // Remove translations from response\n            }\n        })\n\n        return NextResponse.json(translatedTiers)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error fetching donation tiers' }, { status: 500 })\n    }\n}\n\nexport async function POST(request: Request) {\n    const session = await getSession()\n    if (!session || !['ADMIN', 'EDITOR'].includes(session.role)) {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { amount, description, isPopular, order } = await request.json()\n\n        const tier = await prisma.donationTier.create({\n            data: {\n                amount: parseFloat(amount),\n                description,\n                isPopular: isPopular || false,\n                order: parseInt(order) || 0\n            }\n        })\n\n        return NextResponse.json(tier)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error creating donation tier' }, { status: 500 })\n    }\n}\n\nexport async function PUT(request: Request) {\n    const session = await getSession()\n    if (!session || !['ADMIN', 'EDITOR'].includes(session.role)) {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { id, amount, description, isPopular, order } = await request.json()\n\n        const tier = await prisma.donationTier.update({\n            where: { id },\n            data: {\n                amount: parseFloat(amount),\n                description,\n                isPopular,\n                order: parseInt(order)\n            }\n        })\n\n        return NextResponse.json(tier)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error updating donation tier' }, { status: 500 })\n    }\n}\n\nexport async function DELETE(request: Request) {\n    const session = await getSession()\n    if (!session || !['ADMIN', 'EDITOR'].includes(session.role)) {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { searchParams } = new URL(request.url)\n        const id = searchParams.get('id')\n\n        if (!id) {\n            return NextResponse.json({ error: 'ID is required' }, { status: 400 })\n        }\n\n        await prisma.donationTier.delete({\n            where: { id }\n        })\n\n        return NextResponse.json({ success: true })\n    } catch (error) {\n        return NextResponse.json({ error: 'Error deleting donation tier' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/gallery/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":52,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":72,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\n\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url)\n    const locale = searchParams.get('locale')\n\n    try {\n        const images = await prisma.galleryImage.findMany({\n            include: {\n                translations: locale ? {\n                    where: { locale }\n                } : false\n            },\n            orderBy: { createdAt: 'desc' },\n        })\n\n        const translatedImages = images.map(image => {\n            if (!locale) return image;\n            const translation = image.translations?.[0];\n            return {\n                ...image,\n                caption: translation?.caption || image.caption,\n                translations: undefined\n            }\n        })\n\n        return NextResponse.json(translatedImages)\n    } catch (error) {\n        console.error('Error fetching gallery images:', error)\n        return NextResponse.json({ error: 'Failed to fetch gallery images' }, { status: 500 })\n    }\n}\n\nexport async function POST(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const body = await request.json()\n        const image = await prisma.galleryImage.create({\n            data: {\n                url: body.url,\n                caption: body.caption,\n                category: body.category,\n            },\n        })\n        return NextResponse.json(image)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error adding image' }, { status: 500 })\n    }\n}\n\nexport async function DELETE(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { searchParams } = new URL(request.url)\n        const id = searchParams.get('id')\n        if (!id) {\n            return NextResponse.json({ error: 'ID required' }, { status: 400 })\n        }\n\n        await prisma.galleryImage.delete({ where: { id } })\n        return NextResponse.json({ success: true })\n    } catch (error) {\n        return NextResponse.json({ error: 'Error deleting image' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/logs/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":11,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\n\nexport async function GET() {\n    try {\n        const logs = await prisma.errorLog.findMany({\n            orderBy: { createdAt: 'desc' },\n            take: 100, // Limit to last 100 logs\n        });\n        return NextResponse.json(logs);\n    } catch (error) {\n        return NextResponse.json({ error: 'Failed to fetch logs' }, { status: 500 });\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/pages/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":34,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\n\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url)\n    const key = searchParams.get('key')\n\n    if (key) {\n        const content = await prisma.pageContent.findUnique({\n            where: { key },\n        })\n        return NextResponse.json(content)\n    }\n\n    const allContent = await prisma.pageContent.findMany()\n    return NextResponse.json(allContent)\n}\n\nexport async function POST(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const body = await request.json()\n        const content = await prisma.pageContent.upsert({\n            where: { key: body.key },\n            update: { value: body.value, type: body.type },\n            create: { key: body.key, value: body.value, type: body.type },\n        })\n        return NextResponse.json(content)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error updating content' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/payments/bank-transfer/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/payments/mchanga/checkout/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/payments/mchanga/verify/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/programs/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":56,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":87,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":87,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":107,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":107,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\n\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url)\n    const locale = searchParams.get('locale')\n\n    try {\n        const programs = await prisma.program.findMany({\n            include: {\n                translations: locale ? {\n                    where: { locale }\n                } : false\n            },\n            orderBy: { createdAt: 'desc' },\n        })\n\n        const translatedPrograms = programs.map(program => {\n            if (!locale) return program;\n            const translation = program.translations?.[0];\n            return {\n                ...program,\n                title: translation?.title || program.title,\n                description: translation?.description || program.description,\n                translations: undefined // Remove translations from response\n            }\n        })\n\n        return NextResponse.json(translatedPrograms)\n    } catch (error) {\n        console.error('Error fetching programs:', error)\n        return NextResponse.json({ error: 'Failed to fetch programs' }, { status: 500 })\n    }\n}\n\nexport async function POST(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const body = await request.json()\n        const program = await prisma.program.create({\n            data: {\n                title: body.title,\n                slug: body.slug,\n                description: body.description,\n                objectives: body.objectives?.split('\\n').filter((o: string) => o.trim()) || [],\n                photos: body.photos?.split('\\n').filter((p: string) => p.trim()) || [],\n                metrics: typeof body.metrics === 'string' ? JSON.parse(body.metrics || '{}') : body.metrics,\n            },\n        })\n        return NextResponse.json(program)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error creating program' }, { status: 500 })\n    }\n}\n\nexport async function PUT(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { searchParams } = new URL(request.url)\n        const id = searchParams.get('id')\n        if (!id) {\n            return NextResponse.json({ error: 'ID required' }, { status: 400 })\n        }\n\n        const body = await request.json()\n        const program = await prisma.program.update({\n            where: { id },\n            data: {\n                title: body.title,\n                slug: body.slug,\n                description: body.description,\n                objectives: JSON.stringify(body.objectives?.split('\\n').filter((o: string) => o.trim()) || []),\n                photos: JSON.stringify(body.photos?.split('\\n').filter((p: string) => p.trim()) || []),\n                metrics: JSON.stringify(typeof body.metrics === 'string' ? JSON.parse(body.metrics || '{}') : body.metrics),\n            },\n        })\n        return NextResponse.json(program)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error updating program' }, { status: 500 })\n    }\n}\n\nexport async function DELETE(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { searchParams } = new URL(request.url)\n        const id = searchParams.get('id')\n        if (!id) {\n            return NextResponse.json({ error: 'ID required' }, { status: 400 })\n        }\n\n        await prisma.program.delete({ where: { id } })\n        return NextResponse.json({ success: true })\n    } catch (error) {\n        return NextResponse.json({ error: 'Error deleting program' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/resources/[id]/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/resources/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/search/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/settings/bank/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/settings/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":6,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession, canManageSettings } from '@/lib/auth'\n\n// GET - Fetch all settings\nexport async function GET(request: Request) {\n    try {\n        const session = await getSession()\n        if (!session) {\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n        }\n\n        const settings = await prisma.siteContent.findMany()\n\n        // Convert array to object for easier frontend consumption\n        const settingsMap = settings.reduce((acc, setting) => {\n            acc[setting.key] = setting.value\n            return acc\n        }, {} as Record<string, string>)\n\n        return NextResponse.json(settingsMap)\n    } catch (error) {\n        console.error('Error fetching settings:', error)\n        return NextResponse.json(\n            { error: 'Failed to fetch settings' },\n            { status: 500 }\n        )\n    }\n}\n\n// POST - Update settings\nexport async function POST(request: Request) {\n    try {\n        const session = await getSession()\n        if (!session || !canManageSettings(session)) {\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n        }\n\n        const body = await request.json()\n        const updates = Object.entries(body)\n\n        // Process updates in transaction\n        await prisma.$transaction(\n            updates.map(([key, value]) =>\n                prisma.siteContent.upsert({\n                    where: { key },\n                    update: { value: String(value) },\n                    create: {\n                        key,\n                        value: String(value),\n                        type: 'TEXT'\n                    }\n                })\n            )\n        )\n\n        return NextResponse.json({ success: true })\n    } catch (error) {\n        console.error('Error updating settings:', error)\n        return NextResponse.json(\n            { error: 'Failed to update settings' },\n            { status: 500 }\n        )\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/statistics/[id]/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/statistics/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/team/[id]/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/team/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/testimonials/[id]/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/testimonials/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getSession' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\n\n// GET /api/testimonials - List testimonials\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url)\n    const status = searchParams.get('status')\n    const locale = searchParams.get('locale')\n\n    try {\n        const where = status && status !== 'ALL' ? { status } : status === 'ALL' ? {} : { status: 'APPROVED' }\n        const testimonials = await prisma.testimonial.findMany({\n            where,\n            include: {\n                translations: locale ? {\n                    where: { locale }\n                } : false\n            },\n            orderBy: { order: 'asc' }\n        })\n\n        const translatedTestimonials = testimonials.map(testimonial => {\n            if (!locale) return testimonial;\n            const translation = testimonial.translations?.[0];\n            return {\n                ...testimonial,\n                message: translation?.message || testimonial.message,\n                role: translation?.role || testimonial.role,\n                translations: undefined // Remove translations from response\n            }\n        })\n\n        return NextResponse.json(translatedTestimonials)\n    } catch (error) {\n        console.error('Error fetching testimonials:', error)\n        return NextResponse.json({ error: 'Failed to fetch testimonials' }, { status: 500 })\n    }\n}\n\n// POST /api/testimonials - Submit new testimonial (Public)\nexport async function POST(request: Request) {\n    try {\n        const body = await request.json()\n        const { name, role, message, imageUrl, rating } = body\n\n        const testimonial = await prisma.testimonial.create({\n            data: {\n                name,\n                role,\n                message,\n                imageUrl,\n                rating,\n                status: 'PENDING', // All new testimonials start as pending\n                order: 0,\n            },\n        })\n\n        return NextResponse.json(testimonial, { status: 201 })\n    } catch (error) {\n        console.error('Error creating testimonial:', error)\n        return NextResponse.json({ error: 'Failed to create testimonial' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/translations/route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[313,316],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[313,316],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\n\nexport async function GET(request: Request) {\n    const { searchParams } = new URL(request.url);\n    const locale = searchParams.get('locale');\n    const namespace = searchParams.get('namespace');\n\n    try {\n        const where: any = {};\n        if (locale) where.locale = locale;\n        if (namespace) where.namespace = namespace;\n\n        const translations = await prisma.translation.findMany({\n            where,\n            orderBy: { key: 'asc' }\n        });\n\n        return NextResponse.json(translations);\n    } catch (error) {\n        console.error('Error fetching translations:', error);\n        return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\n    }\n}\n\nexport async function POST(request: Request) {\n    try {\n        const body = await request.json();\n        const { key, locale, value, namespace } = body;\n\n        if (!key || !locale || !value) {\n            return NextResponse.json({ error: 'Missing required fields' }, { status: 400 });\n        }\n\n        const translation = await prisma.translation.upsert({\n            where: {\n                key_locale_namespace: {\n                    key,\n                    locale,\n                    namespace: namespace || 'common'\n                }\n            },\n            update: { value },\n            create: {\n                key,\n                locale,\n                value,\n                namespace: namespace || 'common'\n            }\n        });\n\n        return NextResponse.json(translation);\n    } catch (error) {\n        console.error('Error saving translation:', error);\n        return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\n    }\n}\n\nexport async function DELETE(request: Request) {\n    const { searchParams } = new URL(request.url);\n    const id = searchParams.get('id');\n\n    if (!id) {\n        return NextResponse.json({ error: 'ID is required' }, { status: 400 });\n    }\n\n    try {\n        await prisma.translation.delete({\n            where: { id }\n        });\n\n        return NextResponse.json({ success: true });\n    } catch (error) {\n        console.error('Error deleting translation:', error);\n        return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/upload/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/api/users/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":66,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":66,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":95,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":95,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":141,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":141,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport { getSession } from '@/lib/auth'\nimport bcrypt from 'bcrypt'\n\nexport async function GET() {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    const users = await prisma.user.findMany({\n        select: {\n            id: true,\n            name: true,\n            email: true,\n            role: true,\n            createdAt: true,\n        },\n        orderBy: { createdAt: 'desc' },\n    })\n\n    return NextResponse.json(users)\n}\n\nexport async function POST(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { name, email, password, role } = await request.json()\n\n        if (!email || !password) {\n            return NextResponse.json({ error: 'Email and password are required' }, { status: 400 })\n        }\n\n        const existingUser = await prisma.user.findUnique({\n            where: { email },\n        })\n\n        if (existingUser) {\n            return NextResponse.json({ error: 'User already exists' }, { status: 400 })\n        }\n\n        const hashedPassword = await bcrypt.hash(password, 10)\n\n        const user = await prisma.user.create({\n            data: {\n                name,\n                email,\n                password: hashedPassword,\n                role: role || 'ADMIN',\n            },\n            select: {\n                id: true,\n                name: true,\n                email: true,\n                role: true,\n                createdAt: true,\n            },\n        })\n\n        return NextResponse.json(user)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error creating user' }, { status: 500 })\n    }\n}\n\nexport async function DELETE(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { searchParams } = new URL(request.url)\n        const id = searchParams.get('id')\n\n        if (!id) {\n            return NextResponse.json({ error: 'User ID is required' }, { status: 400 })\n        }\n\n        // Prevent deleting yourself\n        if (id === session.id) {\n            return NextResponse.json({ error: 'Cannot delete your own account' }, { status: 400 })\n        }\n\n        await prisma.user.delete({\n            where: { id },\n        })\n\n        return NextResponse.json({ success: true })\n    } catch (error) {\n        return NextResponse.json({ error: 'Error deleting user' }, { status: 500 })\n    }\n}\n\nexport async function PATCH(request: Request) {\n    const session = await getSession()\n    if (!session || session.role !== 'ADMIN') {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })\n    }\n\n    try {\n        const { id, role, name } = await request.json()\n\n        if (!id) {\n            return NextResponse.json({ error: 'User ID is required' }, { status: 400 })\n        }\n\n        // Prevent changing your own role\n        if (id === session.id && role) {\n            return NextResponse.json({ error: 'Cannot change your own role' }, { status: 400 })\n        }\n\n        // Validate role\n        const validRoles = ['ADMIN', 'EDITOR', 'VIEWER']\n        if (role && !validRoles.includes(role)) {\n            return NextResponse.json({ error: 'Invalid role' }, { status: 400 })\n        }\n\n        const updateData: { role?: string; name?: string } = {}\n        if (role) updateData.role = role\n        if (name !== undefined) updateData.name = name\n\n        const user = await prisma.user.update({\n            where: { id },\n            data: updateData,\n            select: {\n                id: true,\n                name: true,\n                email: true,\n                role: true,\n                createdAt: true,\n            },\n        })\n\n        return NextResponse.json(user)\n    } catch (error) {\n        return NextResponse.json({ error: 'Error updating user' }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/robots.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/app/sitemap.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/AdSlot.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/ConfirmDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/ContactForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/CookieConsent.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/Editor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/Footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/GlobalSearch.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`navigateTo` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/home/evans/Projects/NRDC/components/GlobalSearch.tsx:54:17\n  52 |             } else if (e.key === 'Enter' && results[selectedIndex]) {\n  53 |                 e.preventDefault()\n> 54 |                 navigateTo(results[selectedIndex])\n     |                 ^^^^^^^^^^ `navigateTo` accessed before it is declared\n  55 |             }\n  56 |         }\n  57 |         window.addEventListener('keydown', handleKeyDown)\n\n/home/evans/Projects/NRDC/components/GlobalSearch.tsx:82:5\n  80 |     }, [query])\n  81 |\n> 82 |     const navigateTo = useCallback((result: SearchResult) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |         router.push(result.url)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 84 |         setIsOpen(false)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 85 |         setQuery('')\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 86 |         setResults([])\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 87 |     }, [router])\n     | ^^^^^^^^^^^^^^^^^ `navigateTo` is declared here\n  88 |\n  89 |     const getIcon = (type: string) => {\n  90 |         switch (type) {","line":54,"column":17,"nodeType":null,"endLine":54,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'navigateTo'. Either include it or remove the dependency array.","line":59,"column":8,"nodeType":"ArrayExpression","endLine":59,"endColumn":40,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, navigateTo, results, selectedIndex]","fix":{"range":[1979,2011],"text":"[isOpen, navigateTo, results, selectedIndex]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState, useCallback } from 'react'\nimport { Search, X, FileText, BookOpen, Edit3 } from 'lucide-react'\nimport { useRouter } from 'next/navigation'\n\ninterface SearchResult {\n    id: string\n    type: 'Blog Post' | 'Program' | 'Site Content'\n    title: string\n    subtitle?: string\n    url: string\n    badge?: string\n}\n\nexport default function GlobalSearch() {\n    const [isOpen, setIsOpen] = useState(false)\n    const [query, setQuery] = useState('')\n    const [results, setResults] = useState<SearchResult[]>([])\n    const [loading, setLoading] = useState(false)\n    const [selectedIndex, setSelectedIndex] = useState(0)\n    const router = useRouter()\n\n    // Handle Cmd+K / Ctrl+K\n    useEffect(() => {\n        const handleKeyDown = (e: KeyboardEvent) => {\n            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n                e.preventDefault()\n                setIsOpen(true)\n            }\n            if (e.key === 'Escape') {\n                setIsOpen(false)\n                setQuery('')\n                setResults([])\n            }\n        }\n        window.addEventListener('keydown', handleKeyDown)\n        return () => window.removeEventListener('keydown', handleKeyDown)\n    }, [])\n\n    // Handle arrow navigation\n    useEffect(() => {\n        if (!isOpen) return\n\n        const handleKeyDown = (e: KeyboardEvent) => {\n            if (e.key === 'ArrowDown') {\n                e.preventDefault()\n                setSelectedIndex(i => Math.min(i + 1, results.length - 1))\n            } else if (e.key === 'ArrowUp') {\n                e.preventDefault()\n                setSelectedIndex(i => Math.max(i - 1, 0))\n            } else if (e.key === 'Enter' && results[selectedIndex]) {\n                e.preventDefault()\n                navigateTo(results[selectedIndex])\n            }\n        }\n        window.addEventListener('keydown', handleKeyDown)\n        return () => window.removeEventListener('keydown', handleKeyDown)\n    }, [isOpen, results, selectedIndex])\n\n    // Search function\n    useEffect(() => {\n        if (query.length < 2) {\n            setResults([])\n            return\n        }\n\n        setLoading(true)\n        const timer = setTimeout(async () => {\n            const res = await fetch(`/api/search?q=${encodeURIComponent(query)}`)\n            if (res.ok) {\n                const data = await res.json()\n                setResults(data.results)\n                setSelectedIndex(0)\n            }\n            setLoading(false)\n        }, 300)\n\n        return () => clearTimeout(timer)\n    }, [query])\n\n    const navigateTo = useCallback((result: SearchResult) => {\n        router.push(result.url)\n        setIsOpen(false)\n        setQuery('')\n        setResults([])\n    }, [router])\n\n    const getIcon = (type: string) => {\n        switch (type) {\n            case 'Blog Post': return BookOpen\n            case 'Program': return FileText\n            case 'Site Content': return Edit3\n            default: return Search\n        }\n    }\n\n    if (!isOpen) return null\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-24 px-4\" onClick={() => setIsOpen(false)}>\n            <div className=\"bg-white rounded-xl shadow-2xl max-w-2xl w-full overflow-hidden\" onClick={(e) => e.stopPropagation()}>\n                {/* Search Input */}\n                <div className=\"flex items-center gap-3 p-4 border-b border-gray-200\">\n                    <Search size={20} className=\"text-gray-400\" />\n                    <input\n                        type=\"text\"\n                        autoFocus\n                        placeholder=\"Search blogs, programs, content... (Cmd+K)\"\n                        className=\"flex-1 outline-none text-gray-900 placeholder-gray-400\"\n                        value={query}\n                        onChange={(e) => setQuery(e.target.value)}\n                    />\n                    <button onClick={() => setIsOpen(false)} className=\"text-gray-400 hover:text-gray-600\">\n                        <X size={20} />\n                    </button>\n                </div>\n\n                {/* Results */}\n                <div className=\"max-h-96 overflow-y-auto\">\n                    {loading && (\n                        <div className=\"p-8 text-center text-gray-500\">Searching...</div>\n                    )}\n\n                    {!loading && query.length >= 2 && results.length === 0 && (\n                        <div className=\"p-8 text-center text-gray-500\">No results found</div>\n                    )}\n\n                    {!loading && query.length < 2 && (\n                        <div className=\"p-8 text-center text-gray-400 text-sm\">\n                            Type at least 2 characters to search\n                        </div>\n                    )}\n\n                    {!loading && results.length > 0 && (\n                        <div className=\"divide-y divide-gray-100\">\n                            {results.map((result, index) => {\n                                const Icon = getIcon(result.type)\n                                return (\n                                    <button\n                                        key={result.id}\n                                        onClick={() => navigateTo(result)}\n                                        className={`w-full text-left p-4 flex items-center gap-4 transition-colors ${index === selectedIndex ? 'bg-[#6E8C82]/10' : 'hover:bg-gray-50'\n                                            }`}\n                                    >\n                                        <div className=\"p-2 bg-gray-100 rounded-lg\">\n                                            <Icon size={20} className=\"text-gray-600\" />\n                                        </div>\n                                        <div className=\"flex-1 min-w-0\">\n                                            <div className=\"flex items-center gap-2\">\n                                                <p className=\"font-medium text-gray-900 truncate\">{result.title}</p>\n                                                {result.badge && (\n                                                    <span className={`text-xs px-2 py-0.5 rounded-full ${result.badge === 'Published'\n                                                            ? 'bg-green-100 text-green-700'\n                                                            : 'bg-gray-200 text-gray-600'\n                                                        }`}>\n                                                        {result.badge}\n                                                    </span>\n                                                )}\n                                            </div>\n                                            {result.subtitle && (\n                                                <p className=\"text-sm text-gray-500 truncate\">{result.subtitle}</p>\n                                            )}\n                                            <p className=\"text-xs text-gray-400 mt-1\">{result.type}</p>\n                                        </div>\n                                    </button>\n                                )\n                            })}\n                        </div>\n                    )}\n                </div>\n\n                {/* Footer */}\n                <div className=\"p-3 border-t border-gray-200 bg-gray-50 flex items-center justify-between text-xs text-gray-500\">\n                    <div className=\"flex items-center gap-4\">\n                        <span>â†‘â†“ Navigate</span>\n                        <span>â†µ Select</span>\n                        <span>ESC Close</span>\n                    </div>\n                    <span>{results.length} results</span>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/LanguageSwitcher.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render.","line":23,"column":5,"nodeType":"Identifier","endLine":23,"endColumn":14}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useLocale } from 'next-intl';\nimport { useRouter, usePathname } from 'next/navigation';\nimport { useTransition, useState, useEffect, useRef } from 'react';\nimport { Globe, ChevronDown } from 'lucide-react';\n\nexport default function LanguageSwitcher() {\n    const locale = useLocale();\n    const router = useRouter();\n    const pathname = usePathname();\n    const [isPending, startTransition] = useTransition();\n    const [isOpen, setIsOpen] = useState(false);\n    const dropdownRef = useRef<HTMLDivElement>(null);\n\n    // Initial check for admin path - usually this causes hydration mismatch if done naively\n    // but returning null should be safe if we want to hide it completely.\n    if (pathname.startsWith('/admin')) {\n        return null;\n    }\n\n    // Close dropdown when clicking outside\n    useEffect(() => {\n        function handleClickOutside(event: MouseEvent) {\n            if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n                setIsOpen(false);\n            }\n        }\n\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => document.removeEventListener('mousedown', handleClickOutside);\n    }, []);\n\n    const onSelectChange = (nextLocale: string) => {\n        setIsOpen(false); // Close dropdown immediately\n\n        startTransition(() => {\n            // Replace the locale in the pathname\n            // e.g. /en/about -> /fr/about\n            // or /about -> /fr/about (if default locale is hidden)\n\n            let newPath = pathname;\n            const segments = pathname.split('/');\n\n            // Check if the first segment is a locale\n            if (['en', 'fr', 'es', 'ar'].includes(segments[1])) {\n                segments[1] = nextLocale;\n                newPath = segments.join('/');\n            } else {\n                newPath = `/${nextLocale}${pathname}`;\n            }\n\n            router.replace(newPath);\n        });\n    };\n\n    return (\n        <div className=\"relative\" ref={dropdownRef}>\n            <button\n                onClick={() => setIsOpen(!isOpen)}\n                className=\"flex items-center gap-2 text-gray-600 hover:text-[#6E8C82] transition-colors p-2 rounded-lg hover:bg-gray-50\"\n                aria-label=\"Select language\"\n                aria-expanded={isOpen}\n            >\n                <Globe size={20} />\n                <span className=\"uppercase font-medium\">{locale}</span>\n                <ChevronDown\n                    size={16}\n                    className={`transform transition-transform ${isOpen ? 'rotate-180' : ''}`}\n                />\n            </button>\n\n            {isOpen && (\n                <div className=\"absolute right-0 mt-2 w-32 bg-white rounded-lg shadow-xl border border-gray-100 overflow-hidden z-50 animate-fadeIn\">\n                    <button\n                        onClick={() => onSelectChange('en')}\n                        disabled={isPending}\n                        className={`w-full text-left px-4 py-2 text-sm hover:bg-gray-50 transition-colors flex items-center justify-between ${locale === 'en' ? 'text-[#6E8C82] font-bold bg-[#6E8C82]/10' : 'text-gray-700'\n                            }`}\n                    >\n                        <span>English</span>\n                        {locale === 'en' && <span className=\"text-xs\">âœ“</span>}\n                    </button>\n                    <button\n                        onClick={() => onSelectChange('fr')}\n                        disabled={isPending}\n                        className={`w-full text-left px-4 py-2 text-sm hover:bg-gray-50 transition-colors flex items-center justify-between ${locale === 'fr' ? 'text-[#6E8C82] font-bold bg-[#6E8C82]/10' : 'text-gray-700'\n                            }`}\n                    >\n                        <span>FranÃ§ais</span>\n                        {locale === 'fr' && <span className=\"text-xs\">âœ“</span>}\n                    </button>\n                    <button\n                        onClick={() => onSelectChange('es')}\n                        disabled={isPending}\n                        className={`w-full text-left px-4 py-2 text-sm hover:bg-gray-50 transition-colors flex items-center justify-between ${locale === 'es' ? 'text-[#6E8C82] font-bold bg-[#6E8C82]/10' : 'text-gray-700'\n                            }`}\n                    >\n                        <span>EspaÃ±ol</span>\n                        {locale === 'es' && <span className=\"text-xs\">âœ“</span>}\n                    </button>\n                    <button\n                        onClick={() => onSelectChange('ar')}\n                        disabled={isPending}\n                        className={`w-full text-left px-4 py-2 text-sm hover:bg-gray-50 transition-colors flex items-center justify-between ${locale === 'ar' ? 'text-[#6E8C82] font-bold bg-[#6E8C82]/10' : 'text-gray-700'\n                            }`}\n                    >\n                        <span>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>\n                        {locale === 'ar' && <span className=\"text-xs\">âœ“</span>}\n                    </button>\n                </div>\n            )}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/Navbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/TestimonialForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/Toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/components/VolunteerForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/convert-to-pdf.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":20,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":37}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const fs = require('fs');\nconst { marked } = require('marked');\n\n// Function to convert markdown file to HTML\nfunction convertToHtml(filename, title) {\n    const markdown = fs.readFileSync(`${filename}.md`, 'utf-8');\n    const htmlContent = marked.parse(markdown);\n\n    const fullHtml = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>${title}</title>\n    <style>\n        @page {\n            margin: 2cm;\n            size: A4;\n        }\n        \n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 210mm;\n            margin: 0 auto;\n            padding: 20px;\n            background: white;\n        }\n        \n        h1 {\n            color: #2c3e50;\n            border-bottom: 3px solid #3498db;\n            padding-bottom: 10px;\n            margin-top: 30px;\n            page-break-after: avoid;\n        }\n        \n        h2 {\n            color: #34495e;\n            border-bottom: 2px solid #95a5a6;\n            padding-bottom: 8px;\n            margin-top: 25px;\n            page-break-after: avoid;\n        }\n        \n        h3 {\n            color: #2c3e50;\n            margin-top: 20px;\n            page-break-after: avoid;\n        }\n        \n        h4 {\n            color: #555;\n            margin-top: 15px;\n        }\n        \n        a {\n            color: #3498db;\n            text-decoration: none;\n        }\n        \n        code {\n            background: #f4f4f4;\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-family: 'Courier New', Courier, monospace;\n            font-size: 0.9em;\n        }\n        \n        pre {\n            background: #2c3e50;\n            color: #ecf0f1;\n            padding: 15px;\n            border-radius: 5px;\n            overflow-x: auto;\n            page-break-inside: avoid;\n        }\n        \n        pre code {\n            background: none;\n            color: #ecf0f1;\n            padding: 0;\n        }\n        \n        blockquote {\n            border-left: 4px solid #3498db;\n            padding: 10px 20px;\n            margin: 20px 0;\n            background: #ecf8ff;\n            border-radius: 0 5px 5px 0;\n            page-break-inside: avoid;\n        }\n        \n        /* GitHub-style alerts */\n        blockquote p:first-child {\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        \n        blockquote:has(p:first-child:contains(\"TIP\")) {\n            border-left-color: #27ae60;\n            background: #e8f8f5;\n        }\n        \n        blockquote:has(p:first-child:contains(\"IMPORTANT\")) {\n            border-left-color: #8e44ad;\n            background: #f4ecf7;\n        }\n        \n        table {\n            border-collapse: collapse;\n            width: 100%;\n            margin: 20px 0;\n            page-break-inside: avoid;\n        }\n        \n        th, td {\n            border: 1px solid #ddd;\n            padding: 12px;\n            text-align: left;\n        }\n        \n        th {\n            background: #3498db;\n            color: white;\n            font-weight: bold;\n        }\n        \n        tr:nth-child(even) {\n            background: #f9f9f9;\n        }\n        \n        ul, ol {\n            margin: 15px 0;\n            padding-left: 30px;\n        }\n        \n        hr {\n            border: none;\n            border-top: 2px solid #ecf0f1;\n            margin: 30px 0;\n        }\n    </style>\n</head>\n<body>\n    ${htmlContent}\n</body>\n</html>`;\n\n    fs.writeFileSync(`${filename}.html`, fullHtml, 'utf-8');\n    console.log(`âœ… HTML file created: ${filename}.html`);\n}\n\n// Convert all guides\nconvertToHtml('MCHANGA_SETUP_GUIDE', 'M-Changa Setup Guide');\nconvertToHtml('BANK_TRANSFER_SETUP_GUIDE', 'Bank Transfer Setup Guide');\nconvertToHtml('MARKETPLACE_BUSINESS_MODEL', 'NRDC Marketplace Business Model');\nconvertToHtml('BANK_API_INTEGRATION_REQUIREMENTS', 'Technical Requirements: Automated Bank API');\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/i18n.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[785,788],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[785,788],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1380,1383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1380,1383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getRequestConfig } from 'next-intl/server';\nimport { prisma } from '@/lib/prisma';\n\nexport default getRequestConfig(async ({ requestLocale }) => {\n    let locale = await requestLocale;\n\n    if (!locale || !['en', 'fr', 'es', 'ar'].includes(locale)) {\n        locale = 'en';\n    }\n\n    const fileMessages = (await import(`./messages/${locale}.json`)).default;\n\n    let dbMessages = {};\n    try {\n        const translations = await prisma.translation.findMany({\n            where: { locale }\n        });\n\n        // Convert flat structure to nested object based on namespace\n        // Assuming structure: namespace.key\n        // But my model has 'namespace' field.\n        // My file structure is: { namespace: { key: value } }\n\n        dbMessages = translations.reduce((acc: any, t) => {\n            if (!acc[t.namespace]) acc[t.namespace] = {};\n            acc[t.namespace][t.key] = t.value;\n            return acc;\n        }, {});\n\n    } catch (e) {\n        console.error(\"Failed to load translations from DB\", e);\n    }\n\n    // Deep merge or just top level?\n    // For simplicity, let's do a basic merge where DB overrides file\n    // But we need deep merge for namespaces.\n\n    const messages = { ...fileMessages };\n\n    Object.keys(dbMessages).forEach(namespace => {\n        messages[namespace] = {\n            ...messages[namespace],\n            ...(dbMessages as any)[namespace]\n        };\n    });\n\n    return {\n        locale,\n        messages\n    };\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/lib/audit.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[186,189],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[186,189],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { prisma } from './prisma'\n\nexport async function logAudit(\n    action: string,\n    entity: string,\n    entityId: string | null = null,\n    metadata: { userId?: string; details?: any } = {}\n) {\n    try {\n        await prisma.auditLog.create({\n            data: {\n                action,\n                entity,\n                entityId,\n                userId: metadata.userId || null,\n                details: metadata.details ? JSON.stringify(metadata.details) : null,\n            },\n        })\n    } catch (error) {\n        // Fallback to console if database logging fails to prevent breaking the main flow\n        console.error('Failed to log audit:', error)\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/lib/auth.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[266,269],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[266,269],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":20,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import jwt from 'jsonwebtoken'\nimport { cookies } from 'next/headers'\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'super-secret-key'\n\ninterface JwtPayload {\n    id: string\n    userId: string\n    email: string\n    role: string\n}\n\nexport function signToken(payload: any) {\n    return jwt.sign(payload, JWT_SECRET, { expiresIn: '1d' })\n}\n\nexport function verifyToken(token: string): JwtPayload | null {\n    try {\n        return jwt.verify(token, JWT_SECRET) as JwtPayload\n    } catch (e) {\n        return null\n    }\n}\n\nexport async function getSession(): Promise<JwtPayload | null> {\n    const cookieStore = await cookies()\n    const token = cookieStore.get('token')?.value\n    if (!token) return null\n    return verifyToken(token)\n}\n\n// Permission helpers\nexport function isAdmin(user: JwtPayload | null): boolean {\n    return user?.role === 'ADMIN'\n}\n\nexport function canManageContent(user: JwtPayload | null): boolean {\n    return user?.role === 'ADMIN' || user?.role === 'EDITOR'\n}\n\nexport function canManageUsers(user: JwtPayload | null): boolean {\n    return user?.role === 'ADMIN'\n}\n\nexport function canManageSettings(user: JwtPayload | null): boolean {\n    return user?.role === 'ADMIN'\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/lib/email.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/lib/mchanga.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[181,184],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[181,184],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MCHANGA_API_URL' is assigned a value but never used.","line":12,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'reference' is defined but never used.","line":100,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":100,"endColumn":50}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface PaymentData {\n    amount: number\n    email: string\n    name?: string\n    phone?: string\n    reference: string\n    callbackUrl: string\n    metadata?: Record<string, any>\n    currency?: string\n}\n\nconst MCHANGA_API_URL = 'https://api.mchanga.africa/v1';\n\n/**\n * Initialize a M-Changa transaction\n * Note: Since M-Changa documentation varies, this implements a standard\n * hosted checkout generation or direct payment request.\n * For now, we assume a hosted link generation pattern or STK push.\n * However, to match the UI redirect flow, we will assume an endpoint that returns a payment URL.\n */\nexport async function initializePayment(data: PaymentData) {\n    const apiKey = process.env.MCHANGA_API_KEY;\n    const paybill = process.env.MCHANGA_PAYBILL;\n\n    if (!apiKey || !paybill) {\n        throw new Error('M-Changa API Not Configured');\n    }\n\n    try {\n        // This is a hypothetical implementation of M-Changa's Checkout API\n        // In reality, you might just redirect to:\n        // https://mchanga.africa/fundraiser/{paybill}/donate?amount={amount}...\n        // But let's try a programmatic approach first if we want tracking strings.\n\n        // Strategy: Return a direct link if API keys are missing (fallback)\n        // or mock the response for now until we have the real endpoint docs from user.\n        // But since I need to provide a working solution:\n\n        // I will implement a Fallback Redirect URL construction which is universally supported\n        // regardless of their specific API version.\n        // URL Format: https://www.mchanga.africa/fundraiser/{paybill}?amount={amount}&name={name}\n\n        const params = new URLSearchParams({\n            id: paybill, // Fundraiser ID\n            amount: data.amount.toString(),\n            name: data.name || 'Anonymous',\n            email: data.email,\n            phone: data.phone || '',\n            reference: data.reference\n        });\n\n        // Construct the hosted page URL\n        // If the client has a specific \"Checkout API\", verify would change.\n        // For now, this is the safest \"Gateway\" replacement that guarantees a page loads.\n        const authorizationUrl = `https://www.mchanga.africa/fundraiser/${paybill}?${params.toString()}`;\n\n        return {\n            status: true,\n            message: 'Payment initialized',\n            data: {\n                authorization_url: authorizationUrl,\n                access_code: data.reference, // Use reference as code in this fallback\n                reference: data.reference\n            }\n        };\n\n        /* \n        // Real API Implementation would look like this:\n        const response = await fetch(`${MCHANGA_API_URL}/payment`, {\n             method: 'POST',\n             headers: {\n                 'Authorization': `Bearer ${apiKey}`,\n                 'Content-Type': 'application/json'\n             },\n             body: JSON.stringify({\n                 fundraiser_id: paybill,\n                 amount: data.amount,\n                 currency: data.currency || 'KES',\n                 reference: data.reference,\n                 callback_url: data.callbackUrl,\n                 customer: {\n                     name: data.name,\n                     email: data.email,\n                     phone: data.phone\n                 }\n             })\n        });\n        return await response.json();\n        */\n\n    } catch (error) {\n        console.error('M-Changa initialization error:', error);\n        throw error;\n    }\n}\n\n/**\n * Verify a M-Changa transaction\n */\nexport async function verifyTransaction(reference: string) {\n    // Implement verification logic\n    // Usually calls GET /payment/{reference}\n    return { status: true, message: 'Verified' };\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/lib/prisma.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/lib/seo.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/playwright.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/prisma/seed-content.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":51}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const { PrismaClient } = require('@prisma/client')\n\nconst prisma = new PrismaClient()\n\nasync function main() {\n    console.log('ðŸŒ± Seeding database with sample content...')\n\n    // Create additional sample programs\n    const programs = [\n        {\n            title: 'Emergency Food Distribution',\n            slug: 'emergency-food-distribution',\n            description: 'Our Emergency Food Distribution program provides immediate nutritional support to displaced communities facing food insecurity. We work with local partners to deliver culturally appropriate food packages containing essential nutrients, grains, proteins, and fresh produce. Each package is designed to sustain a family of five for up to two weeks.',\n            objectives: JSON.stringify([\n                'Provide nutritious meals to 5,000 displaced families monthly',\n                'Distribute emergency food packages within 48 hours of displacement',\n                'Establish community feeding centers in 12 refugee camps',\n                'Partner with local farmers for fresh produce supply',\n                'Monitor nutritional outcomes and adjust distributions accordingly'\n            ]),\n            metrics: JSON.stringify({\n                'families_served': '5,000+',\n                'locations': '12 camps',\n                'response_time': '48 hours',\n                'success_rate': '95%'\n            }),\n            photos: JSON.stringify([\n                'https://images.unsplash.com/photo-1593113598332-cd288d649433?w=800'\n            ])\n        },\n        {\n            title: 'Nutrition Education & Training',\n            slug: 'nutrition-education-training',\n            description: 'Empowering communities through knowledge is at the heart of sustainable change. Our Nutrition Education program trains community health workers and mothers on proper nutrition, food preparation, and hygiene practices. We provide hands-on cooking demonstrations, nutritional counseling, and educational materials in local languages.',\n            objectives: JSON.stringify([\n                'Train 500 community health workers annually',\n                'Conduct monthly nutrition workshops for mothers',\n                'Distribute educational materials in 5 local languages',\n                'Establish mother-to-mother support groups',\n                'Monitor child growth and development indicators'\n            ]),\n            metrics: JSON.stringify({\n                'workers_trained': '500+',\n                'workshops_monthly': '24',\n                'languages': '5',\n                'malnutrition_reduction': '40%'\n            }),\n            photos: JSON.stringify([\n                'https://images.unsplash.com/photo-1509062522246-3755977927d7?w=800'\n            ])\n        },\n        {\n            title: 'Mobile Healthcare Services',\n            slug: 'mobile-healthcare-services',\n            description: 'Access to quality healthcare is a basic human right. Our Mobile Healthcare program brings medical services directly to refugee camps and displacement sites. Our team of doctors, nurses, and nutritionists provide health screenings, treat malnutrition, and offer maternal and child health services. We also manage vaccination campaigns and health education.',\n            objectives: JSON.stringify([\n                'Provide mobile clinics to 15 displacement sites',\n                'Screen 10,000 children for malnutrition quarterly',\n                'Deliver maternal and child health services',\n                'Conduct vaccination campaigns for preventable diseases',\n                'Offer mental health and psychosocial support'\n            ]),\n            metrics: JSON.stringify({\n                'clinics': '15',\n                'children_screened': '10,000',\n                'vaccinations': '15,000+',\n                'consultations_monthly': '3,000'\n            }),\n            photos: JSON.stringify([\n                'https://images.unsplash.com/photo-1584820927498-cfe5bae427d2?w=800'\n            ])\n        },\n        {\n            title: 'Water & Sanitation',\n            slug: 'water-sanitation',\n            description: 'Clean water and proper sanitation are fundamental to preventing disease and malnutrition. We install water points, build latrines, and promote hygiene practices in displacement camps. Our WASH (Water, Sanitation, and Hygiene) program ensures that communities have access to safe drinking water and maintain healthy living environments.',\n            objectives: JSON.stringify([\n                'Install 50 water points in refugee camps',\n                'Construct 200 family latrines',\n                'Train hygiene promoters in each camp',\n                'Distribute hygiene kits to 2,000 families',\n                'Monitor water quality weekly'\n            ]),\n            metrics: JSON.stringify({\n                'water_points': '50',\n                'latrines_built': '200',\n                'hygiene_kits': '2,000',\n                'water_access': '85%'\n            }),\n            photos: JSON.stringify([\n                'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=800'\n            ])\n        }\n    ]\n\n    console.log('Creating programs...')\n    for (const program of programs) {\n        await prisma.program.create({ data: program })\n    }\n\n    // Create sample blog posts\n    const blogPosts = [\n        {\n            title: 'NRDC Celebrates 5 Years of Service to Displaced Communities',\n            slug: 'nrdc-5-years-anniversary',\n            content: `Five years ago, NRDC was founded with a simple but powerful mission: to provide nutrition and hope to refugee and displaced communities. Today, we celebrate this milestone by looking back at our journey and forward to the impact we will continue to make.\n\n**Our Journey**\n\nSince 2020, we have grown from a small team of passionate volunteers to a full-fledged organization operating in 12 refugee camps across the region. We have served over 50,000 families, distributed millions of meals, and trained hundreds of community health workers.\n\n**Impact by the Numbers**\n- 50,000+ families served\n- 5 million+ meals distributed\n- 500+ health workers trained\n- 12 active program locations\n- 95% beneficiary satisfaction rate\n\n**Looking Forward**\n\nAs we enter our sixth year, we are more committed than ever to our mission. With your continued support, we plan to expand to 5 new locations, launch a youth nutrition program, and increase our emergency response capacity.\n\nThank you to all our donors, partners, volunteers, and most importantly, the communities we serve. Together, we are making a difference.`,\n            excerpt: 'Join us in celebrating five years of providing nutrition and hope to displaced communities. A look back at our journey and the impact we have made together.',\n            category: 'News',\n            tags: 'anniversary, impact, milestone, celebration',\n            published: true,\n            image: 'https://images.unsplash.com/photo-1511632765486-a01980e01a18?w=800'\n        },\n        {\n            title: 'New Mobile Clinic Brings Healthcare to Remote Camps',\n            slug: 'new-mobile-clinic-launch',\n            content: `We are excited to announce the launch of our latest mobile health clinic, bringing essential medical services to three remote displacement camps that previously had limited access to healthcare.\n\n**The Need**\n\nMany displacement camps are located in areas with minimal healthcare infrastructure. Families often have to travel long distances to access basic medical services, which can be especially challenging for mothers with young children or those dealing with malnutrition.\n\n**Our Solution**\n\nOur new mobile clinic is equipped with:\n- Medical examination facilities\n- Vaccination capabilities\n- Nutritional screening tools\n- Maternal and child health services\n- Basic laboratory equipment\n\nThe clinic operates on a rotating schedule, visiting each camp twice weekly and providing consultations, screenings, and treatments.\n\n**Impact So Far**\n\nIn just the first month of operation:\n- 1,200+ consultations provided\n- 450 children screened for malnutrition\n- 300 vaccinations administered\n- 50 pregnant mothers received prenatal care\n\n**What's Next**\n\nBased on the overwhelming demand and positive outcomes, we are already planning to add a second mobile clinic to reach even more communities in need.`,\n            excerpt: 'Our newest mobile health clinic is bringing essential medical services to remote displacement camps, making healthcare accessible to families who need it most.',\n            category: 'Programs',\n            tags: 'healthcare, mobile clinic, access, innovation',\n            published: true,\n            image: 'https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?w=800'\n        },\n        {\n            title: 'Success Story: Amina\\'s Journey to Health',\n            slug: 'success-story-amina',\n            content: `When Amina arrived at the displacement camp six months ago with her three children, she was exhausted, worried, and her youngest child showed signs of severe malnutrition. Today, her family's story is one of resilience, hope, and the power of nutrition support.\n\n**The Beginning**\n\n\"When we first arrived, I didn't know where to turn,\" Amina recalls. \"My youngest, Hassan, was so weak and underweight. I was scared.\"\n\nThrough our emergency food distribution program, Amina's family received immediate nutritional support. Hassan was enrolled in our therapeutic feeding program, which provides specialized nutrition for severely malnourished children.\n\n**The Transformation**\n\nOver the following months:\n- Hassan received daily therapeutic meals\n- Amina attended our nutrition education workshops\n- The family received regular food distributions\n- Community health workers monitored Hassan's progress\n\n\"I learned so much about nutrition and how to prepare healthy meals with what we have,\" Amina says. \"The health workers visited us every week and taught me how to care for my children better.\"\n\n**Today**\n\nHassan has made a full recovery. He has gained healthy weight, his energy has returned, and he plays with other children in the camp. Amina has become a peer educator, sharing what she learned with other mothers in the camp.\n\n\"NRDC didn't just feed my child - they gave me knowledge and hope,\" Amina reflects. \"Now I can help other mothers going through what I experienced.\"\n\n**The Bigger Picture**\n\nAmina's story represents thousands of families we serve. It illustrates that sustainable impact comes not just from providing food, but from empowering communities with knowledge and support systems.`,\n            excerpt: 'Meet Amina and her youngest son Hassan, whose journey from severe malnutrition to full health demonstrates the life-changing impact of nutrition support and education.',\n            category: 'Success Stories',\n            tags: 'success story, testimonial, impact, transformation',\n            published: true,\n            image: 'https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?w=800'\n        },\n        {\n            title: 'Partnerships for Greater Impact: Working Together',\n            slug: 'partnerships-collaboration',\n            content: `At NRDC, we believe that lasting change requires collaboration. We are proud to work alongside local communities, international organizations, and government agencies to maximize our impact.\n\n**Our Partnership Approach**\n\nWe don't work in silos. Every program we implement involves collaboration with:\n- Local community leaders\n- Other humanitarian organizations\n- Government health departments\n- Local farmers and suppliers\n- International donors\n\n**Current Partnerships**\n\nThis year alone, we have:\n- Partnered with 15 local organizations\n- Collaborated with 3 international NGOs\n- Worked with government health departments in 4 regions\n- Engaged 50+ local suppliers and farmers\n\n**Case Study: Farmer Partnership Program**\n\nOne of our most successful initiatives has been partnering with local farmers to supply fresh produce for our food distributions. This approach:\n- Supports local economies\n- Provides fresher, more nutritious food\n- Reduces transportation costs\n- Creates sustainable supply chains\n\n**Looking Ahead**\n\nWe are actively seeking new partnerships with organizations that share our values and commitment to serving displaced communities. Together, we can do more.`,\n            excerpt: 'Collaboration amplifies impact. Learn about NRDC\\'s partnership approach and how working together creates sustainable solutions for displaced communities.',\n            category: 'Updates',\n            tags: 'partnerships, collaboration, community, sustainability',\n            published: true,\n            image: 'https://images.unsplash.com/photo-1531206715517-5c0ba140b2b8?w=800'\n        }\n    ]\n\n    console.log('Creating blog posts...')\n    for (const post of blogPosts) {\n        await prisma.blogPost.create({ data: post })\n    }\n\n    // Create sample gallery images\n    const galleryImages = [\n        {\n            url: 'https://images.unsplash.com/photo-1593113598332-cd288d649433?w=800',\n            caption: 'Community members receiving food distribution packages',\n            category: 'Programs'\n        },\n        {\n            url: 'https://images.unsplash.com/photo-1509062522246-3755977927d7?w=800',\n            caption: 'Nutrition education workshop for mothers',\n            category: 'Programs'\n        },\n        {\n            url: 'https://images.unsplash.com/photo-1584820927498-cfe5bae427d2?w=800',\n            caption: 'Mobile health clinic providing medical care',\n            category: 'Programs'\n        },\n        {\n            url: 'https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?w=800',\n            caption: 'Mothers and children at community center',\n            category: 'Community'\n        },\n        {\n            url: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=800',\n            caption: 'New water point installation in refugee camp',\n            category: 'Programs'\n        },\n        {\n            url: 'https://images.unsplash.com/photo-1511632765486-a01980e01a18?w=800',\n            caption: 'Community celebration event',\n            category: 'Events'\n        },\n        {\n            url: 'https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?w=800',\n            caption: 'Healthcare workers in mobile clinic',\n            category: 'Programs'\n        },\n        {\n            url: 'https://images.unsplash.com/photo-1531206715517-5c0ba140b2b8?w=800',\n            caption: 'Team meeting with community leaders',\n            category: 'Community'\n        }\n    ]\n\n    console.log('Creating gallery images...')\n    for (const image of galleryImages) {\n        await prisma.galleryImage.create({ data: image })\n    }\n\n    console.log('âœ… Database seeded successfully!')\n    console.log(`\nCreated:\n- ${programs.length} programs\n- ${blogPosts.length} blog posts\n- ${galleryImages.length} gallery images\n  `)\n}\n\nmain()\n    .catch((e) => {\n        console.error('âŒ Error seeding database:', e)\n        process.exit(1)\n    })\n    .finally(async () => {\n        await prisma.$disconnect()\n    })\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/prisma/seed.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/proxy.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/tailwind.config.ts","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":20,"column":9,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":20,"endColumn":43}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { Config } from \"tailwindcss\";\n\nconst config: Config = {\n    content: [\n        \"./pages/**/*.{js,ts,jsx,tsx,mdx}\",\n        \"./components/**/*.{js,ts,jsx,tsx,mdx}\",\n        \"./app/**/*.{js,ts,jsx,tsx,mdx}\",\n    ],\n    theme: {\n        extend: {\n            colors: {\n                primary: '#6E8C82', // Extracts from logo (Greenish)\n                secondary: '#82643C', // Extracts from logo (Brownish)\n                'nrdc-green': '#6E8C82',\n                'nrdc-brown': '#82643C',\n            }\n        },\n    },\n    plugins: [\n        require('@tailwindcss/typography'),\n    ],\n};\nexport default config;\n","usedDeprecatedRules":[]},{"filePath":"/home/evans/Projects/NRDC/tests/auth.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]